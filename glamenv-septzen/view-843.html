<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>C言語系/memos/gcc/舞台裏を知りたいときのヒント集メモ - Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</title>
<!-- favicon 2017's reference:
https://developers.google.com/web/fundamentals/design-and-ui/browser-customization/
https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx
https://developer.chrome.com/multidevice/android/installtohomescreen
https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html
-->
<link rel="shortcut icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="57x57" href="../favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="../favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="../favicons/favicon-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-160x160.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-196x196.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">

<!-- browserconfig.xml : https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx -->
<meta name="msapplication-TileColor" content="#990000">
<meta name="msapplication-TileImage" content="../favicons/mstile-144x144.png">

<!-- these favicon files were generated by https://ao-system.net/favicongenerator/ , thanks!!(2017-02-18) -->

<style type="text/css"></style>

<link href="./css/pcbrowser.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_plugins.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_wiki.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/print.css" rel="stylesheet" type="text/css" media="print"/>
</head>
<body>
<!-- body start -->
<div class="body">
<div style="display: inline"><a name="pagetop"></a></div>
<div id="header-wrap">
<img src="./images/logo1.jpg" style="float: left; margin-right: 1em;"/>
<a href="./index.html" title="Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)"><img src="./icons/home.png" alt="home"/>&nbsp;Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</a>


<h1 style="margin-bottom: 10px;">C言語系/memos/gcc/舞台裏を知りたいときのヒント集メモ</h1>

<div style="clear: both;"></div>
</div><!-- //header-wrap -->

<!-- content-wrap start -->
<div id="content-wrap"><div class="contents_s">

<!-- data_main -->
<div class="data_main">

<div class="data_attrs_pre">
作成日: 2010-11-21 17:13:08 &nbsp; / &nbsp; last updated at: 2011-05-01 18:40:22<br>
カテゴリ: <a href="category-10.html">C言語</a>&nbsp;</div>

<div class="data_body">
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-479.html" title="C言語系/memos/gcc">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-577.html" title="C言語系/memos/gcc/関数の属性機能(&quot;__attribute__&quot;)">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-478.html" title="C言語系">C言語系</a>&nbsp;]</li>
</ul>
<hr class="full_hr" />

<p class="paragraph">
gccコマンドの裏側を知りたいときのヒント集メモ。
<br />
</p>

<p class="paragraph">
使用環境：
<br />
</p>
<pre>CentOS 5.x
gcc-4.1.2-48.el5
libgcc-4.1.2-48.el5
cpp-4.1.2-48.el5
binutils-2.17.50.0.6-6.el5
binutils-devel-2.17.50.0.6-14.el5
</pre>



<p class="paragraph">
本サイト内の関連URL：
<br />
</p>
<ul><li> <a href="./view-479.html" >C言語系/memos/gcc</a></li>
<li> <a href="./view-577.html" >C言語系/memos/gcc/関数の属性機能(&quot;__attribute__&quot;)</a></li></ul>

<p class="paragraph">
参考書籍：
<br />
</p>
<a href="https://www.amazon.co.jp/dp/4873112885" target="_blank">Amazon.co.jp: Binary Hacks ―ハッカー秘伝のテクニック100選 : 高林 哲, 鵜飼 文敏, 佐藤 祐介, 浜地 慎一郎, 首藤 一幸: 本</a><br>
<hr />
<ul><li><a href="#idcdf92b">gccの舞台裏を見たい</a><ul><li><a href="#id44ccf1">&quot;gcc -v&quot;オプション</a></li>
<li><a href="#id6696ee">ヘッダーファイルのインクルード状況を確認したい(&quot;-H&quot;オプション)</a></li>
<li><a href="#ida31c58">システムヘッダーのインクルードPATHを確認・調整したい(&quot;-print-search-dirs&quot;, &quot;-I&quot;, &quot;-I-&quot; オプション)</a></li>
<li><a href="#id4874bc">&quot;-print-prog-name&quot;, &quot;-print-file-name&quot;, &quot;-print-libgcc-file-name&quot;オプション</a></li>
<li><a href="#id091826">リンク時にリンクされるファイルのPATHを確認したい(&quot;ld -t&quot;)</a></li>
<li><a href="#id6a22ec">リンカのデフォルト検索PATHを確認したい(&quot;ld --verbose&quot;)</a></li>
<li><a href="#idad07b0">静的リンクの舞台裏を確認してみる(gcc &quot;-static&quot;オプション)</a></li>
<li><a href="#id28f004">動的リンクの舞台裏を確認してみる</a></li>
<li><a href="#id57d38b">gcc全体の振る舞い・デフォルト設定を調査・カスタマイズしたい</a></li></ul></li></ul>
<hr />
<h3 id="idcdf92b">gccの舞台裏を見たい</h3>

<p class="paragraph">
gccコマンドが隠蔽しているビルド過程を確認し、手動でGNUツールチェインを実行する際のヒント集。
<br />
</p>

<h4 id="id44ccf1">&quot;gcc -v&quot;オプション</h4>

<p class="paragraph">
gccコマンドを&quot;-v&quot;オプション付きで実行すると、普段は隠されているビルド過程を出力させることが出来る。
<br />
</p>

<pre class="plugin_pre">
$ gcc -v -o foo foo.c
Using built-in specs.
Target: i386-redhat-linux
コンフィグオプション: ../configure --prefix=/usr 

(...省略...)

 /usr/libexec/gcc/i386-redhat-linux/4.1.2/cc1 \
    -quiet -v foo.c -quiet -dumpbase foo.c \
    -mtune=generic -auxbase foo -version \
    -o /tmp/ccHJGC4y.s
存在しないディレクトリ &quot;/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../../i386-redhat-linux/include&quot; を無視します
#include &quot;...&quot; の探索はここから始まります:
#include &lt;...&gt; の探索はここから始まります:
 /usr/local/include
 /usr/lib/gcc/i386-redhat-linux/4.1.2/include
 /usr/include
探索リストの終わり
GNU C version 4.1.2 20080704 (Red Hat 4.1.2-48) (i386-redhat-linux)
        compiled by GNU C version 4.1.2 20080704 (Red Hat 4.1.2-48).
GGC heuristics: --param ggc-min-expand=64 --param ggc-min-heapsize=64436
Compiler executable checksum: 625231d1211c3689652276225f4f5c88
 as -V -Qy -o /tmp/ccup2RC0.o /tmp/ccHJGC4y.s
GNU assembler version 2.17.50.0.6-6.el5 (i386-redhat-linux) using BFD version 2.17.50.0.6-6.el5 20061020

 /usr/libexec/gcc/i386-redhat-linux/4.1.2/collect2 \
    --eh-frame-hdr -m elf_i386 \
    --hash-style=gnu \
    -dynamic-linker /lib/ld-linux.so.2 \
    -o foo \
    /usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o \
    /usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o \
    /usr/lib/gcc/i386-redhat-linux/4.1.2/crtbegin.o \
    -L/usr/lib/gcc/i386-redhat-linux/4.1.2 \
    -L/usr/lib/gcc/i386-redhat-linux/4.1.2 \
    -L/usr/lib/gcc/i386-redhat-linux/4.1.2/../../.. \
    /tmp/ccup2RC0.o \
    -lgcc \
    --as-needed \
    -lgcc_s \
    --no-as-needed \
    -lc -lgcc \
    --as-needed \
    -lgcc_s \
    --no-as-needed \
    /usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o \
    /usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o
</pre>

<h4 id="id6696ee">ヘッダーファイルのインクルード状況を確認したい(&quot;-H&quot;オプション)</h4>

<p class="paragraph">
プリプロセスだけを行う&quot;-E&quot;オプションと併用すると効果的。
<br />
</p>
<pre class="plugin_pre">
$ gcc -H -E -o foo.i foo.c
. /usr/include/stdio.h
.. /usr/include/features.h
... /usr/include/sys/cdefs.h
.... /usr/include/bits/wordsize.h
... /usr/include/gnu/stubs.h
.... /usr/include/bits/wordsize.h
.... /usr/include/gnu/stubs-32.h
.. /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stddef.h
.. /usr/include/bits/types.h
... /usr/include/bits/wordsize.h
... /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stddef.h
... /usr/include/bits/typesizes.h
.. /usr/include/libio.h
... /usr/include/_G_config.h
.... /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stddef.h
.... /usr/include/wchar.h
..... /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stddef.h
..... /usr/include/bits/wchar.h
.... /usr/include/gconv.h
..... /usr/include/wchar.h
...... /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stddef.h
..... /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stddef.h
... /usr/lib/gcc/i386-redhat-linux/4.1.2/include/stdarg.h
.. /usr/include/bits/stdio_lim.h
.. /usr/include/bits/sys_errlist.h
</pre>

<p class="paragraph">
複数のインクルードPATHを調整する場面で役立つだろう。
<br />
</p>

<h4 id="ida31c58">システムヘッダーのインクルードPATHを確認・調整したい(&quot;-print-search-dirs&quot;, &quot;-I&quot;, &quot;-I-&quot; オプション)</h4>

<pre class="plugin_pre">
$ gcc -print-search-dirs
インストール: /usr/lib/gcc/i386-redhat-linux/4.1.2/
プログラム: =(省略)
ライブラリ: =(省略)
</pre>
<p class="paragraph">
cppコマンドがインストールされている場合は、
<br />
</p>
<pre>$ cpp -print-search-dirs
</pre>
<p class="paragraph">
でも同じ結果になる。
<br />
</p>

<p class="paragraph">
実行時に確認したい場合は、&quot;-v&quot;オプションを使うとよいだろう。
<br />
</p>
<pre class="plugin_pre">
$ gcc -v -E -o foo.i foo.c
(省略)
#include &quot;...&quot; の探索はここから始まります:
#include &lt;...&gt; の探索はここから始まります:
 /usr/local/include
 /usr/lib/gcc/i386-redhat-linux/4.1.2/include
 /usr/include
探索リストの終わり
</pre>

<p class="paragraph">
&quot;-I&quot;オプションを指定して、&quot;#include &lt;...&gt;&quot;の検索PATHを追加してみる：
<br />
</p>
<pre class="plugin_pre">
$ gcc -v -I/tmp -E -o foo.i foo.c
(省略)
#include &quot;...&quot; の探索はここから始まります:
#include &lt;...&gt; の探索はここから始まります:
 /tmp
 /usr/local/include
 /usr/lib/gcc/i386-redhat-linux/4.1.2/include
 /usr/include
探索リストの終わり
</pre>

<p class="paragraph">
&quot;-I-&quot;オプションを活用し、&quot;/tmp&quot;を&quot;#include &quot;&quot;&quot; にのみ追加し、&quot;/home&quot;を&quot;#include &lt;&gt;&quot;に追加してみる：
<br />
</p>
<pre class="plugin_pre">
$ gcc -v -I/tmp -I- -I/home -E -o foo.i foo.c
(省略)
#include &quot;...&quot; の探索はここから始まります:
 /tmp
#include &lt;...&gt; の探索はここから始まります:
 /home
 /usr/local/include
 /usr/lib/gcc/i386-redhat-linux/4.1.2/include
 /usr/include
探索リストの終わり
</pre>

<p class="paragraph">
上記オプションは&quot;cpp&quot;コマンドでも同様に利用可能。
<br />
</p>

<h4 id="id4874bc">&quot;-print-prog-name&quot;, &quot;-print-file-name&quot;, &quot;-print-libgcc-file-name&quot;オプション</h4>

<p class="paragraph">
&quot;cc1&quot;, &quot;collect2&quot;など、gccが舞台裏で起動しているgccツールのフルパスを取得する：
<br />
</p>
<pre>$ gcc -print-prog-name=cc1
/usr/libexec/gcc/i386-redhat-linux/4.1.2/cc1

$ gcc -print-prog-name=collect2
/usr/libexec/gcc/i386-redhat-linux/4.1.2/collect2
</pre>

<p class="paragraph">
gccのランタイムライブラリファイルのフルパスを取得する：
<br />
</p>
<table>
	<tr>
		<td> $ gcc -print-libgcc-file-name </td>
		<td> /usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc.a </td>
	</tr>
	<tr>
		<td> $ gcc -print-file-name=crti.o </td>
		<td> /usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o </td>
	</tr>
	<tr>
		<td> $ gcc -print-file-name=crt1.o </td>
		<td> /usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o </td>
	</tr>
	<tr>
		<td> $ gcc -print-file-name=crtbegin.o </td>
		<td> /usr/lib/gcc/i386-redhat-linux/4.1.2/crtbegin.o </td>
	</tr>
	<tr>
		<td> $ gcc -print-file-name=crtend.o </td>
		<td> /usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o </td>
	</tr>
	<tr>
		<td> $ gcc -print-file-name=crtn.o </td>
		<td> /usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o </td>
	</tr>
</table>

<h4 id="id091826">リンク時にリンクされるファイルのPATHを確認したい(&quot;ld -t&quot;)</h4>

<p class="paragraph">
binutilsのlinkerであるldコマンドの&quot;-t&quot;オプションを使う。
<br />
</p>
<pre>-t : trace link files
</pre>

<pre class="plugin_pre">
$ gcc -c -o foo.o foo.i
$ gcc -o foo -Wl,-t foo.o
/usr/bin/ld: mode elf_i386
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtbegin.o
foo.o
-lgcc_s (/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_s.so)
/lib/libc.so.6
(/usr/lib/libc_nonshared.a)elf-init.oS
/lib/ld-linux.so.2
-lgcc_s (/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_s.so)
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o
</pre>

<h4 id="id6a22ec">リンカのデフォルト検索PATHを確認したい(&quot;ld --verbose&quot;)</h4>

<pre>ld --verbose
</pre>
<p class="paragraph">
でリンカスクリプト表示、SEARCH_DIR()を確認する。
<br />
</p>
<pre class="plugin_pre">
$ ld --verbose
GNU ld version 2.17.50.0.6-6.el5 20061020
  Supported emulations:
   elf_i386
   i386linux
using internal linker script:
==================================================
/* Script for -z combreloc: combine and sort reloc sections */
OUTPUT_FORMAT(&quot;elf32-i386&quot;, &quot;elf32-i386&quot;,
              &quot;elf32-i386&quot;)
OUTPUT_ARCH(i386)
ENTRY(_start)
SEARCH_DIR(&quot;/usr/i386-redhat-linux/lib&quot;); \
SEARCH_DIR(&quot;/usr/local/lib&quot;); \
SEARCH_DIR(&quot;/lib&quot;); \
SEARCH_DIR(&quot;/usr/lib&quot;);
SECTIONS
{
...
</pre>

<h4 id="idad07b0">静的リンクの舞台裏を確認してみる(gcc &quot;-static&quot;オプション)</h4>

<p class="paragraph">
静的リンクを行うにはgccの &quot;-static&quot; オプションを使う。
<br />
舞台裏を見てみると、&quot;collect2&quot;に&quot;-static&quot;オプションがわたっている。
<br />
</p>

<pre class="plugin_pre">
$ gcc -c -o foo.o foo.c
$ gcc -v -static -o foo foo.o
(...)
/usr/libexec/gcc/i386-redhat-linux/4.1.2/collect2 \
-m elf_i386 \
--hash-style=gnu \
-static \
-o foo \
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o \
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o \
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtbeginT.o \
-L/usr/lib/gcc/i386-redhat-linux/4.1.2 \
-L/usr/lib/gcc/i386-redhat-linux/4.1.2 \
-L/usr/lib/gcc/i386-redhat-linux/4.1.2/../../.. \
foo.o \
--start-group \
-lgcc \
-lgcc_eh \
-lc \
--end-group \
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o \
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o
</pre>

<p class="paragraph">
&quot;--start-group&quot;, &quot;--end-group&quot;については&quot;info ld&quot;参照。
<br />
</p>

<p class="paragraph">
&quot;-t&quot;でトレースしてみる。表示量が大きいので、ファイルに落とす。
<br />
</p>
<pre>$ gcc -Wl,-t -static -o foo foo.o  &gt; list.txt
</pre>

<p class="paragraph">
list.txt:
<br />
</p>
<pre class="plugin_pre">
/usr/bin/ld: mode elf_i386
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtbeginT.o
foo.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../libc.a)libc-start.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../libc.a)check_fds.o
...
(/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../libc.a)dl-sym.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_eh.a)unwind-dw2.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_eh.a)unwind-dw2-fde-glibc.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_eh.a)unwind-c.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../libc.a)stack_chk_fail_local.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../libc.a)dl-iteratephdr.o
(/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../libc.a)stack_chk_fail.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o
</pre>

<p class="paragraph">
libgcc_eh.aなど、gcc側のビルトインライブラリからもリンクされていることが分かる。
<br />
</p>

<h4 id="id28f004">動的リンクの舞台裏を確認してみる</h4>

<p class="paragraph">
&quot;-static&quot;オプションを指定しなければ、デフォルトの動的リンクとなる。
<br />
&quot;-dynamic-linker&quot;オプションで実行時リンカを指定している。
<br />
</p>
<pre class="plugin_pre">
$ gcc -v -o foo foo.o
(...)
/usr/libexec/gcc/i386-redhat-linux/4.1.2/collect2 \
--eh-frame-hdr \
-m elf_i386 \
--hash-style=gnu \
-dynamic-linker /lib/ld-linux.so.2 \
-o foo \
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o \
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o \
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtbegin.o \
-L/usr/lib/gcc/i386-redhat-linux/4.1.2 \
-L/usr/lib/gcc/i386-redhat-linux/4.1.2 \
-L/usr/lib/gcc/i386-redhat-linux/4.1.2/../../.. \
foo.o \
-lgcc \
--as-needed \
-lgcc_s \
--no-as-needed \
-lc \
-lgcc \
--as-needed \
-lgcc_s \
--no-as-needed \
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o \
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o
</pre>

<p class="paragraph">
&quot;--as-needed&quot;, &quot;--no-as-needed&quot;については&quot;info ld&quot;参照。
<br />
</p>

<p class="paragraph">
&quot;-t&quot;でトレースしてみる。
<br />
</p>
<pre class="plugin_pre">
$ gcc -Wl,-t -o foo foo.o
/usr/bin/ld: mode elf_i386
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crt1.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crti.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtbegin.o
foo.o
-lgcc_s (/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_s.so)
/lib/libc.so.6
(/usr/lib/libc_nonshared.a)elf-init.oS
/lib/ld-linux.so.2
-lgcc_s (/usr/lib/gcc/i386-redhat-linux/4.1.2/libgcc_s.so)
/usr/lib/gcc/i386-redhat-linux/4.1.2/crtend.o
/usr/lib/gcc/i386-redhat-linux/4.1.2/../../../crtn.o
</pre>

<h4 id="id57d38b">gcc全体の振る舞い・デフォルト設定を調査・カスタマイズしたい</h4>

<p class="paragraph">
gcc全体の振る舞いや、各ツールチェインに渡すデフォルトパラメータを調査・カスタマイズするには<strong>specs</strong>ファイルを調べます。
<br />
</p>

<p class="paragraph">
specsファイルとは、ドライバプログラムであるgccの振る舞いを決定するファイルです。Makefileに似た構造のテキストファイルで、アセンブルやリンクなど各タスクにおけるコマンドラインを定義していくことが出来ます。
<br />
gcc3以前はデフォルトのspecsがファイルとしてインストールされていたようですが、gcc4以降はプログラム内部に組み込まれたようで、デフォルトのspecsを取得するには &quot;-dumpspecs&quot; オプションを指定します。
<br />
</p>
<pre>$ gcc -dumpspecs &gt; specs.default
</pre>

<p class="paragraph">
考資料：
<br />
</p>
<ul><li> GCC 4.1.2 関連オンラインマニュアル<ul><li> <a class="externallink" href="http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Spec-Files.html" target="_blank">http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Spec-Files.html</a></li></ul></li>
<li> gcc 4: no specs file<ul><li> <a class="externallink" href="http://www.linuxquestions.org/questions/linux-from-scratch-13/gcc-4-no-specs-file-341034/" target="_blank">http://www.linuxquestions.org/questions/linux-from-scratch-13/gcc-4-no-specs-file-341034/</a></li></ul></li>
<li> 5.8. ツールチェーンの調整<ul><li> <a class="externallink" href="http://lfsbookja.sourceforge.jp/6.7.ja/chapter05/adjusting.html" target="_blank">http://lfsbookja.sourceforge.jp/6.7.ja/chapter05/adjusting.html</a></li></ul></li>
<li> 猫科研究所(felid labo) - GCCのspecsとは<ul><li> <a class="externallink" href="http://up-cat.net/GCC%25A4%25CEspecs%25A4%25C8%25A4%25CF.html" target="_blank">http://up-cat.net/GCC%25A4%25CEspecs%25A4%25C8%25A4%25CF.html</a></li></ul></li></ul>

<p class="paragraph">
&quot;-dumpspecs&quot;でダンプしたspecsファイルをカスタマイズし、 &quot;-specs&quot; オプションで指定することにより、アセンブラ(as)やリンカ(ld)に渡すコマンドラインオプションをカスタマイズすることが出来ます。
<br />
実際にダンプしてみると分かりますが、デフォルトのspecsはそれなりの分量があります。
<br />
それら全てを手直しする必要はありません。変更したい箇所だけを修正し、それ以外は削除してしまって構いません。削除されたものについては、デフォルトのspecsが適用されます。
<br />
</p>

<p class="paragraph">
specsファイルの調整が必要になる例：
<br />
</p>
<ul><li> <a href="./view-949.html" >技術/Linux/uClibc/03, x86(32bit) PC環境でuClibcを試す</a><ul><li> &quot;gccに渡す &quot;crtX.o&quot; オプションを省略するには&quot; の項を参照。</li></ul></li></ul>

<hr class="full_hr" />
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-479.html" title="C言語系/memos/gcc">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-577.html" title="C言語系/memos/gcc/関数の属性機能(&quot;__attribute__&quot;)">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-479.html" title="C言語系/memos/gcc">Up</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-478.html" title="C言語系">C言語系</a>&nbsp;]</li>
</ul>
</div>

<div class="data_attrs_post">
original url: https://www.glamenv-septzen.net/view/843<br>
</div>

</div>
<!-- //data_main -->

</div>


</div>
<!-- /content-wrap end -->

<!-- footer start -->
<div id="footer">
Copyright &copy; 2007 - 2025 Masahiko Sakamoto(msakamoto-sf)<br>
License&nbsp;:&nbsp;<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a><br>
Contact&nbsp;:&nbsp;<a target="_blank" href="https://x.com/msakamoto_sf">x(twitter)</a> / <a target="_blank" href="https://github.com/msakamoto-sf/">github</a> / <a class="maillink" href="mailto:&#x73;&#x61;&#x6B;&#x61;&#x6D;&#x6F;&#x74;&#x6F;&#x2E;&#x67;&#x73;&#x79;&#x63;&#x2E;&#x33;&#x73;&#x40;&#x67;&#x6D;&#x61;&#x69;&#x6C;&#x2E;&#x63;&#x6F;&#x6D;">email</a><br>
--&nbsp;Beautiful Icons&nbsp;--<br />
<a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank" title="Mark James Silk icon set 1.3">Mark James Silk icon set 1.3</a> by famfamfam<br />
<a href="http://www.pinvoke.com/" target="_blank" title="Fugue Icons">Fugue Icons</a> by Yusuke Kamiyamane<br />
</div>
<!-- /footer end -->

</div>
<!-- /body end -->

</body>
</html>