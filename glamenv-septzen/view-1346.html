<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Java/Socket, InetAddressにおけるDNS名前解決の仕組みと networkaddress.cache.ttl - Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</title>
<!-- favicon 2017's reference:
https://developers.google.com/web/fundamentals/design-and-ui/browser-customization/
https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx
https://developer.chrome.com/multidevice/android/installtohomescreen
https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html
-->
<link rel="shortcut icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="57x57" href="../favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="../favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="../favicons/favicon-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-160x160.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-196x196.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">

<!-- browserconfig.xml : https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx -->
<meta name="msapplication-TileColor" content="#990000">
<meta name="msapplication-TileImage" content="../favicons/mstile-144x144.png">

<!-- these favicon files were generated by https://ao-system.net/favicongenerator/ , thanks!!(2017-02-18) -->

<style type="text/css"></style>

<link href="./css/pcbrowser.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_plugins.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_wiki.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/print.css" rel="stylesheet" type="text/css" media="print"/>
</head>
<body>
<!-- body start -->
<div class="body">
<div style="display: inline"><a name="pagetop"></a></div>
<div id="header-wrap">
<img src="./images/logo1.jpg" style="float: left; margin-right: 1em;"/>
<a href="./index.html" title="Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)"><img src="./icons/home.png" alt="home"/>&nbsp;Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</a>


<h1 style="margin-bottom: 10px;">Java/Socket, InetAddressにおけるDNS名前解決の仕組みと networkaddress.cache.ttl</h1>

<div style="clear: both;"></div>
</div><!-- //header-wrap -->

<!-- content-wrap start -->
<div id="content-wrap"><div class="contents_s">

<!-- data_main -->
<div class="data_main">

<div class="data_attrs_pre">
作成日: 2015-02-08 00:12:49 &nbsp; / &nbsp; last updated at: 2015-02-08 00:16:40<br>
カテゴリ: <a href="category-34.html">DNS</a>&nbsp;<a href="category-11.html">Java</a>&nbsp;<a href="category-30.html">ネットワーク</a>&nbsp;</div>

<div class="data_body">
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-1093.html" title="Java/ServletとJSESSIONIDのURL管理">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1441.html" title="Java/Springでの Server-Sent Events, WebSocket 参考メモ(2018-12月頃)">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-457.html" title="Java">Java</a>&nbsp;]</li>
</ul>
<hr class="full_hr" />

<p class="paragraph">
JavaでのSocketおよびInetAddressを使ったプログラミングで、DNSの名前解決はどのように行われているのか、ソースなどを追いかけてみた。
<br />
</p>

<ul><li><a href="#id08689d">Socket(String host, int port)での名前解決の仕組み</a><ul><li><a href="#id20d467">InetAddressでの名前解決処理をカスタマイズするには</a></li></ul></li>
<li><a href="#idd6bf98">&quot;networkaddress.cache.ttl&quot; はどこで使われているのか？</a><ul><li><a href="#idf16c83">&quot;networkaddress.cache.ttl&quot; のデフォルト値は？</a></li>
<li><a href="#id96196c">&quot;networkaddress.cache.ttl&quot; はDNSサーバが返すTTLとどう連携するか？</a></li></ul></li>
<li><a href="#idb2c0b2">参考資料</a></li></ul>
<hr />

<ul><li> サンプルコードの実行環境 : Win7 64bit + Oracle JDK 1.8.0.31</li>
<li> 確認に使ったソースコード<ul><li> Oracle JDK 1.8.0.31 および 1.7.0.25 の src.zip</li>
<li> <a class="externallink" href="http://jdk7src.sourceforge.net/" target="_blank">http://jdk7src.sourceforge.net/</a></li>
<li> <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk</a></li></ul></li></ul>

<hr />
<h3 id="id08689d">Socket(String host, int port)での名前解決の仕組み</h3>

<p class="paragraph">
三行で結論：
<br />
</p>
<ol><li> java.net.Socketのコンストラクタ &quot;Socket(String host, int port)&quot;</li>
<li> →内部的には &quot;java.net.InetAddress#getByName(String host)&quot; を呼んでる。</li>
<li> →最終的にはnative(=JNI)に辿り着き、今回はそこでギブアップ。</li></ol>

<p class="paragraph">
まず &quot;Socket(String host, int port)&quot; コンストラクタでの名前解決の使い方を見てみる。
<br />
</p>

<p class="paragraph">
DnsTest1.java:
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">net</span><span class="hl-code">.</span><span class="hl-identifier">InetAddress</span><span class="hl-code">;
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">net</span><span class="hl-code">.</span><span class="hl-identifier">Socket</span><span class="hl-code">;
 
</span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">DnsTest1</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >void</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">args</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-reserved">try</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">Socket</span><span class="hl-code"> </span><span class="hl-identifier">socket</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">Socket</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">www.google.com</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-number">80</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">InetAddress</span><span class="hl-code"> </span><span class="hl-identifier">ia</span><span class="hl-code"> = </span><span class="hl-identifier">socket</span><span class="hl-code">.</span><span class="hl-identifier">getInetAddress</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">System</span><span class="hl-code">.</span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-identifier">ia</span><span class="hl-code">.</span><span class="hl-identifier">getHostAddress</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">catch</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">Exception</span><span class="hl-code"> </span><span class="hl-identifier">e</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">e</span><span class="hl-code">.</span><span class="hl-identifier">printStackTrace</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
実行結果:
<br />
</p>
<pre>216.58.220.228
</pre>

<p class="paragraph">
名前解決がどうなっているのか？JDKのソースから、このコンストラクタのソースを確認してみる。
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-identifier">Socket</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">host</span><span class="hl-code">, </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">port</span><span class="hl-brackets">)</span><span class="hl-code">
        </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code">, </span><span class="hl-identifier">IOException</span><span class="hl-code">
    </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-reserved">this</span><span class="hl-brackets">(</span><span class="hl-identifier">host</span><span class="hl-code"> != </span><span class="hl-reserved">null</span><span class="hl-code"> ? </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">InetSocketAddress</span><span class="hl-brackets">(</span><span class="hl-identifier">host</span><span class="hl-code">, </span><span class="hl-identifier">port</span><span class="hl-brackets">)</span><span class="hl-code"> :
             </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">InetSocketAddress</span><span class="hl-brackets">(</span><span class="hl-identifier">InetAddress</span><span class="hl-code">.</span><span class="hl-identifier">getByName</span><span class="hl-brackets">(</span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code">, </span><span class="hl-identifier">port</span><span class="hl-brackets">)</span><span class="hl-code">,
             </span><span class="hl-brackets">(</span><span class="hl-identifier">SocketAddress</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">null</span><span class="hl-code">, </span><span class="hl-reserved">true</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
&quot;host&quot;がnullでなければ、&quot;new InetSocketAddress(host, port)&quot; を呼び出している。
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-identifier">InetSocketAddress</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">hostname</span><span class="hl-code">, </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">port</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">checkHost</span><span class="hl-brackets">(</span><span class="hl-identifier">hostname</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">InetAddress</span><span class="hl-code"> </span><span class="hl-identifier">addr</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">host</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-reserved">try</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">addr</span><span class="hl-code"> = </span><span class="hl-identifier">InetAddress</span><span class="hl-code">.</span><span class="hl-identifier">getByName</span><span class="hl-brackets">(</span><span class="hl-identifier">hostname</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">catch</span><span class="hl-brackets">(</span><span class="hl-identifier">UnknownHostException</span><span class="hl-code"> </span><span class="hl-identifier">e</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">host</span><span class="hl-code"> = </span><span class="hl-identifier">hostname</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code">
        </span><span class="hl-identifier">holder</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">InetSocketAddressHolder</span><span class="hl-brackets">(</span><span class="hl-identifier">host</span><span class="hl-code">, </span><span class="hl-identifier">addr</span><span class="hl-code">, </span><span class="hl-identifier">checkPort</span><span class="hl-brackets">(</span><span class="hl-identifier">port</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
アドレスを&quot;InetAddress.getByName(hostname)&quot;でInetAddressを取得している。
<br />
</p>

<p class="paragraph">
InetAddress.getByName(String host):
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span class="hl-identifier">InetAddress</span><span class="hl-code"> </span><span class="hl-identifier">getByName</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">host</span><span class="hl-brackets">)</span><span class="hl-code">
        </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">InetAddress</span><span class="hl-code">.</span><span class="hl-identifier">getAllByName</span><span class="hl-brackets">(</span><span class="hl-identifier">host</span><span class="hl-brackets">)</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
試しに、InetAddress.getAllByName() を使ってみる。
<br />
DnsTest2.java:
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">net</span><span class="hl-code">.</span><span class="hl-identifier">InetAddress</span><span class="hl-code">;
 
</span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">DnsTest2</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >void</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">args</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">Exception</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">InetAddress</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">ias</span><span class="hl-code"> = </span><span class="hl-identifier">InetAddress</span><span class="hl-code">.</span><span class="hl-identifier">getAllByName</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">www.google.com</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">for</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">InetAddress</span><span class="hl-code"> </span><span class="hl-identifier">ia</span><span class="hl-code"> : </span><span class="hl-identifier">ias</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">System</span><span class="hl-code">.</span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-identifier">ia</span><span class="hl-code">.</span><span class="hl-identifier">getHostAddress</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
実行結果：
<br />
</p>
<pre class="plugin_pre">
173.194.38.211
173.194.38.212
173.194.38.209
173.194.38.210
173.194.38.208
</pre>


<p class="paragraph">
&quot;InetAddress.getAllByName(host)&quot;からの流れだが、途中はスキップし、&quot;getAddressesFromNameService(String host, InetAddress reqAddr)&quot;の呼び出しまで進めてみる。
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span class="hl-identifier">InetAddress</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">getAddressesFromNameService</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">host</span><span class="hl-code">, </span><span class="hl-identifier">InetAddress</span><span class="hl-code"> </span><span class="hl-identifier">reqAddr</span><span class="hl-brackets">)</span><span class="hl-code">
        </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code">
    </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span><span class="hl-code">
            </span><span class="hl-reserved">try</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                </span><span class="hl-reserved">for</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">NameService</span><span class="hl-code"> </span><span class="hl-identifier">nameService</span><span class="hl-code"> : </span><span class="hl-identifier">nameServices</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                    </span><span class="hl-reserved">try</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                        </span><span class="hl-identifier">addresses</span><span class="hl-code"> = </span><span class="hl-identifier">nameService</span><span class="hl-code">.</span><span class="hl-identifier">lookupAllHostAddr</span><span class="hl-brackets">(</span><span class="hl-identifier">host</span><span class="hl-brackets">)</span><span class="hl-code">;
                        </span><span class="hl-identifier">success</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                        </span><span class="hl-reserved">break</span><span class="hl-code">;
                    </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">catch</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">UnknownHostException</span><span class="hl-code"> </span><span class="hl-identifier">uhe</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                    </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span></pre></div>

<p class="paragraph">
&quot;nameService&quot; は &quot;sun.net.spi.nameservice.NameService&quot; のListになっており、NameServiceはinterfaceとなっている。
<br />
</p>

<p class="paragraph">
InetAddress.java中の、&quot;nameService&quot;の初期化処理周りのコードを見てみる：
<br />
</p>
<div class="hl-main"><pre><span class="hl-comment">/*</span><span class="hl-comment"> Used to store the name service provider </span><span class="hl-comment">*/</span><span class="hl-code">
    </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span class="hl-identifier">List</span><span class="hl-code">&lt;</span><span class="hl-identifier">NameService</span><span class="hl-code">&gt; </span><span class="hl-identifier">nameServices</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
 
    </span><span >static</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> create the impl</span><span class="hl-comment"></span><span class="hl-code">
        </span><span class="hl-identifier">impl</span><span class="hl-code"> = </span><span class="hl-identifier">InetAddressImplFactory</span><span class="hl-code">.</span><span class="hl-identifier">create</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
 
        </span><span class="hl-comment">//</span><span class="hl-comment"> get name service if provided and requested</span><span class="hl-comment"></span><span class="hl-code">
        </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">provider</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;;
        </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">propPrefix</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">sun.net.spi.nameservice.provider.</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">n</span><span class="hl-code"> = </span><span class="hl-number">1</span><span class="hl-code">;
        </span><span class="hl-identifier">nameServices</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">ArrayList</span><span class="hl-code">&lt;</span><span class="hl-identifier">NameService</span><span class="hl-code">&gt;</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">provider</span><span class="hl-code"> = </span><span class="hl-identifier">AccessController</span><span class="hl-code">.</span><span class="hl-identifier">doPrivileged</span><span class="hl-brackets">(</span><span class="hl-code">
                </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">GetPropertyAction</span><span class="hl-brackets">(</span><span class="hl-identifier">propPrefix</span><span class="hl-code"> + </span><span class="hl-identifier">n</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">while</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">provider</span><span class="hl-code"> != </span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">NameService</span><span class="hl-code"> </span><span class="hl-identifier">ns</span><span class="hl-code"> = </span><span class="hl-identifier">createNSProvider</span><span class="hl-brackets">(</span><span class="hl-identifier">provider</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">ns</span><span class="hl-code"> != </span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code">
                </span><span class="hl-identifier">nameServices</span><span class="hl-code">.</span><span class="hl-identifier">add</span><span class="hl-brackets">(</span><span class="hl-identifier">ns</span><span class="hl-brackets">)</span><span class="hl-code">;
 
            </span><span class="hl-identifier">n</span><span class="hl-code">++;
            </span><span class="hl-identifier">provider</span><span class="hl-code"> = </span><span class="hl-identifier">AccessController</span><span class="hl-code">.</span><span class="hl-identifier">doPrivileged</span><span class="hl-brackets">(</span><span class="hl-code">
                    </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">GetPropertyAction</span><span class="hl-brackets">(</span><span class="hl-identifier">propPrefix</span><span class="hl-code"> + </span><span class="hl-identifier">n</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code">
 
        </span><span class="hl-comment">//</span><span class="hl-comment"> if not designate any name services provider,</span><span class="hl-comment"></span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> create a default one</span><span class="hl-comment"></span><span class="hl-code">
        </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">nameServices</span><span class="hl-code">.</span><span class="hl-identifier">size</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">NameService</span><span class="hl-code"> </span><span class="hl-identifier">ns</span><span class="hl-code"> = </span><span class="hl-identifier">createNSProvider</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">default</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">nameServices</span><span class="hl-code">.</span><span class="hl-identifier">add</span><span class="hl-brackets">(</span><span class="hl-identifier">ns</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
簡単にまとめると、以下のような処理になっている。
<br />
</p>
<ol><li> &quot;impl&quot; staticメンバに、InetAddressImplのインスタンスを &quot;InetAddressImplFactory.create()&quot; メソッドで生成してセット。</li>
<li> Javaのプロパティで &quot;sun.net.spi.nameservice.provider.1&quot;, &quot;sun.net.spi.nameservice.provider.2&quot;, ... の順で探していき、指定されているプロバイダ名があれば、InetAddress.createNSProvider()でインスタンスを生成して、nameServicesに追加する。</li>
<li> &quot;createNSProvider(&quot;default&quot;)&quot; で取得したデフォルトのNameServiceインスタンス(provider)をnameServicesに追加する。</li></ol>

<p class="paragraph">
JDK付属のJRE内を &quot;sun.net.spi.nameservice.provider&quot; でgrepしてみたが、特に設定は見つからなかった。
<br />
よって、デフォルトの環境では &quot;createNSProvider(&quot;default&quot;)&quot; で取得したデフォルトのNameServiceインスタンスを使っていると考えられる。
<br />
</p>

<p class="paragraph">
そこで、InetAddress.createNSProvider()の実装を見てみて、&quot;default&quot;を引数に渡した時の挙動を確認する：
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span class="hl-identifier">NameService</span><span class="hl-code"> </span><span class="hl-identifier">createNSProvider</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">provider</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">provider</span><span class="hl-code"> == </span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code">
            </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-reserved">null</span><span class="hl-code">;
 
        </span><span class="hl-identifier">NameService</span><span class="hl-code"> </span><span class="hl-identifier">nameService</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">provider</span><span class="hl-code">.</span><span class="hl-identifier">equals</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">default</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-comment">//</span><span class="hl-comment"> initialize the default name service</span><span class="hl-comment"></span><span class="hl-code">
            </span><span class="hl-identifier">nameService</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">NameService</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-identifier">InetAddress</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">lookupAllHostAddr</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">host</span><span class="hl-brackets">)</span><span class="hl-code">
                    </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">impl</span><span class="hl-code">.</span><span class="hl-identifier">lookupAllHostAddr</span><span class="hl-brackets">(</span><span class="hl-identifier">host</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}</span><span class="hl-code">
                </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">getHostByAddr</span><span class="hl-brackets">(</span><span >byte</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">addr</span><span class="hl-brackets">)</span><span class="hl-code">
                    </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">impl</span><span class="hl-code">.</span><span class="hl-identifier">getHostByAddr</span><span class="hl-brackets">(</span><span class="hl-identifier">addr</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}</span><span class="hl-code">
            </span><span class="hl-brackets">}</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">else</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-comment">/*</span><span class="hl-comment"> ... &quot;default&quot; 以外のNameServiceプロバイダの生成 ... </span><span class="hl-comment">*/</span><span class="hl-code">
        </span><span class="hl-brackets">}</span><span class="hl-code">
 
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">nameService</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
&quot;default&quot; providerの場合、InetAddressの &quot;impl&quot; staticメンバに呼び出しを委譲した NameService インスタンスを生成している。
<br />
&quot;impl&quot; は InetAddressImpl の実装であり、 &quot;lookupAllHostAddr()&quot; と &quot;getHostByAddr()&quot; に委譲している。これらの実装を追うため、まず、&quot;InetAddressImplFactory#create()&quot; のソースを確認する。
<br />
InetAddressImplFactoryはInetAddress.java内で定義されていた：
<br />
</p>
<div class="hl-main"><pre><span class="hl-comment">/*</span><span class="hl-comment">
 * Simple factory to create the impl
 </span><span class="hl-comment">*/</span><span class="hl-code">
</span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">InetAddressImplFactory</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
 
    </span><span >static</span><span class="hl-code"> </span><span class="hl-identifier">InetAddressImpl</span><span class="hl-code"> </span><span class="hl-identifier">create</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">InetAddress</span><span class="hl-code">.</span><span class="hl-identifier">loadImpl</span><span class="hl-brackets">(</span><span class="hl-identifier">isIPv6Supported</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> ?
                                    </span><span class="hl-quotes">&quot;</span><span class="hl-string">Inet6AddressImpl</span><span class="hl-quotes">&quot;</span><span class="hl-code"> : </span><span class="hl-quotes">&quot;</span><span class="hl-string">Inet4AddressImpl</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
 
    </span><span >static</span><span class="hl-code"> </span><span class="hl-reserved">native</span><span class="hl-code"> </span><span >boolean</span><span class="hl-code"> </span><span class="hl-identifier">isIPv6Supported</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span></pre></div>
<p class="paragraph">
native(=JNI)の isIPv6Supported() に応じて、Inet4AddressImplかInet6AddressImplかに、クラスの実体を切り替えている。
<br />
今回はInet4AddressImplのソースを確認してみる。
<br />
</p>

<p class="paragraph">
java/net/Inet4AddressImpl.java:
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">Inet4AddressImpl</span><span class="hl-code"> </span><span class="hl-reserved">implements</span><span class="hl-code"> </span><span class="hl-identifier">InetAddressImpl</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">native</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">getLocalHostName</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code">;
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">native</span><span class="hl-code"> </span><span class="hl-identifier">InetAddress</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code">
        </span><span class="hl-identifier">lookupAllHostAddr</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">hostname</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code">;
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">native</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">getHostByAddr</span><span class="hl-brackets">(</span><span >byte</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">addr</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">UnknownHostException</span><span class="hl-code">;
    </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span class="hl-reserved">native</span><span class="hl-code"> </span><span >boolean</span><span class="hl-code"> </span><span class="hl-identifier">isReachable0</span><span class="hl-brackets">(</span><span >byte</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">addr</span><span class="hl-code">, </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">timeout</span><span class="hl-code">, </span><span >byte</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">ifaddr</span><span class="hl-code">, </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">ttl</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">IOException</span><span class="hl-code">;
    </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span></pre></div>

<p class="paragraph">
肝心の &quot;lookupAllHostAddr()&quot; などが軒並み native(=JNI) になっている。今回はJNIのソースまでは追い切れないため、Socket -&gt; InetAddress 経由での名前解決処理についてはここで打ち切る。
<br />
</p>

<h4 id="id20d467">InetAddressでの名前解決処理をカスタマイズするには</h4>

<p class="paragraph">
InetAddressでの名前解決処理をカスタマイズするには、これまで見てきた内容を整理すると以下のようになる。
<br />
</p>
<ol><li> sun.net.spi.nameservice.NameService を実装する。<ol><li> <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/NameService.java" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/NameService.java</a></li>
<li> また、以下のクラスも実装しないと駄目っぽい。</li>
<li> <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/NameServiceDescriptor.java" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/NameServiceDescriptor.java</a></li></ol></li>
<li> &quot;sun.net.spi.nameservice.provider.N&quot; のJavaプロパティに、実装したprovider名を指定する。<ol><li> これについても、正確にどういう名前を指定すればよいのかについてはInetAddressのソースなど要確認。SPIに沿ってるぽいので、そのへんも要確認。</li></ol></li></ol>

<p class="paragraph">
また実装サンプルと思わしきコードがあるので、これも参考になる。
<br />
</p>
<ul><li> <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/dns/DNSNameService.java" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/dns/DNSNameService.java</a></li>
<li> <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/dns/DNSNameServiceDescriptor.java" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/spi/nameservice/dns/DNSNameServiceDescriptor.java</a></li></ul>

<h3 id="idd6bf98">&quot;networkaddress.cache.ttl&quot; はどこで使われているのか？</h3>

<p class="paragraph">
JavaのDNSキャッシュとして &quot;%JAVA_HOME%\lib\security\java.security&quot; に設定する&quot;networkaddress.cache.ttl&quot;という値がある。InetAddressのJavaDocに説明がある。
<br />
</p>
<ul><li> <a class="externallink" href="https://docs.oracle.com/javase/jp/8/api/java/net/InetAddress.html" target="_blank">https://docs.oracle.com/javase/jp/8/api/java/net/InetAddress.html</a><ul><li> デフォルトは「実装に固有の期間キャッシュ」する。</li>
<li> -1 だと「ずっとキャッシュする」（キャッシュポイゾニング対策になる）</li>
<li> 1以上ならキャッシュ秒数</li>
<li> 0ならキャッシュ期間0秒なので毎回問い合わせになりそう。</li></ul></li></ul>

<p class="paragraph">
これまで見てきたように、Javaにおける名前解決は以下の2種類の実装が提供されている。
<br />
</p>
<ol><li> (Socketコンストラクタ -&gt;) &quot;InetAddress#getByName()&quot; -&gt; native(JNI)</li>
<li> JNDI DNS プロバイダ</li></ol>

<p class="paragraph">
では、&quot;networkaddress.cache.ttl&quot; はどちらで使われているか？
<br />
</p>

<p class="paragraph">
結論から言うと、そもそもこのプロパティ値、InetAddressのJavaDocに記載されているのだから、InetAddressでの名前解決で使われる。
<br />
JNDI DNS プロバイダについては、sunパッケージ/com.sunパッケージのjavaソースも含めてgrepした範囲では使われている様子は確認できなかった。
<br />
</p>


<p class="paragraph">
&quot;networkaddress.cache.ttl&quot; についてsunパッケージ/com.sunパッケージも含めてJavaソースをgrepしてみると、以下のJavaファイルで参照していた。
<br />
sun/net/InetAddressCachePolicy.java: (openjdk7 : <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/InetAddressCachePolicy.java" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/InetAddressCachePolicy.java</a> )
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">package</span><span class="hl-code"> </span><span class="hl-identifier">sun</span><span class="hl-code">.</span><span class="hl-identifier">net</span><span class="hl-code">;
 
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">security</span><span class="hl-code">.</span><span class="hl-identifier">PrivilegedAction</span><span class="hl-code">;
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">security</span><span class="hl-code">.</span><span class="hl-identifier">Security</span><span class="hl-code">;
 
</span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">InetAddressCachePolicy</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
 
    </span><span class="hl-comment">//</span><span class="hl-comment"> Controls the cache policy for successful lookups only</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">cachePolicyProp</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">networkaddress.cache.ttl</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">cachePolicyPropFallback</span><span class="hl-code"> =
        </span><span class="hl-quotes">&quot;</span><span class="hl-string">sun.net.inetaddr.ttl</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
 
    </span><span class="hl-comment">//</span><span class="hl-comment"> Controls the cache policy for negative lookups only</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">negativeCachePolicyProp</span><span class="hl-code"> =
        </span><span class="hl-quotes">&quot;</span><span class="hl-string">networkaddress.cache.negative.ttl</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">negativeCachePolicyPropFallback</span><span class="hl-code"> =
        </span><span class="hl-quotes">&quot;</span><span class="hl-string">sun.net.inetaddr.negative.ttl</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
 
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">FOREVER</span><span class="hl-code"> = -</span><span class="hl-number">1</span><span class="hl-code">;
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">NEVER</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
 
    </span><span class="hl-comment">/*</span><span class="hl-comment"> default value for positive lookups </span><span class="hl-comment">*/</span><span class="hl-code">
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">DEFAULT_POSITIVE</span><span class="hl-code"> = </span><span class="hl-number">30</span><span class="hl-code">;
 
    </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span><span class="hl-code">
    </span><span >static</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">Integer</span><span class="hl-code"> </span><span class="hl-identifier">tmp</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
 
        </span><span class="hl-reserved">try</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">tmp</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">Integer</span><span class="hl-brackets">(</span><span class="hl-code">
              </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">security</span><span class="hl-code">.</span><span class="hl-identifier">AccessController</span><span class="hl-code">.</span><span class="hl-identifier">doPrivileged</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-code">
                </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">PrivilegedAction</span><span class="hl-code">&lt;</span><span class="hl-identifier">String</span><span class="hl-code">&gt;</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                  </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code"> </span><span class="hl-identifier">run</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                      </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">Security</span><span class="hl-code">.</span><span class="hl-identifier">getProperty</span><span class="hl-brackets">(</span><span class="hl-identifier">cachePolicyProp</span><span class="hl-brackets">)</span><span class="hl-code">;
                  </span><span class="hl-brackets">}</span><span class="hl-code">
              </span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">catch</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">NumberFormatException</span><span class="hl-code"> </span><span class="hl-identifier">e</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-comment">//</span><span class="hl-comment"> ignore</span><span class="hl-comment"></span><span class="hl-code">
        </span><span class="hl-brackets">}</span><span class="hl-code">
        </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">tmp</span><span class="hl-code"> != </span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">cachePolicy</span><span class="hl-code"> = </span><span class="hl-identifier">tmp</span><span class="hl-code">.</span><span class="hl-identifier">intValue</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">cachePolicy</span><span class="hl-code"> &lt; </span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                </span><span class="hl-identifier">cachePolicy</span><span class="hl-code"> = </span><span class="hl-identifier">FOREVER</span><span class="hl-code">;
            </span><span class="hl-brackets">}</span><span class="hl-code">
            </span><span class="hl-identifier">propertySet</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">else</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span><span class="hl-code">
            </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">else</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                </span><span class="hl-comment">/*</span><span class="hl-comment"> No properties defined for positive caching. If there is no
                 * security manager then use the default positive cache value.
                 </span><span class="hl-comment">*/</span><span class="hl-code">
                </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">System</span><span class="hl-code">.</span><span class="hl-identifier">getSecurityManager</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                    </span><span class="hl-identifier">cachePolicy</span><span class="hl-code"> = </span><span class="hl-identifier">DEFAULT_POSITIVE</span><span class="hl-code">;
                </span><span class="hl-brackets">}</span><span class="hl-code">
            </span><span class="hl-brackets">}</span><span class="hl-code">
        </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span></pre></div>

<p class="paragraph">
ポイントとしては、このソースコードだと &quot;networkaddress.cache.ttl&quot; or &quot;sun.net.inetaddr.ttl&quot; が指定されていればその値を使うが、どこにも指定が無ければ、DEFAULT_POSITIVE, つまり30秒が名前解決のキャッシュTTLとなる。
<br />
</p>

<p class="paragraph">
現在の実行環境では実際にどの値なのか確認するため、以下のようなGroovyスクリプトを作成し、OracleJDK8のJRE環境で実行してみた。
<br />
<a class="externallink" href="https://gist.github.com/msakamoto-sf/733aa7a2d0b461766b77" target="_blank">https://gist.github.com/msakamoto-sf/733aa7a2d0b461766b77</a>
<br />
</p>

<p class="paragraph">
実行結果：
<br />
</p>
<pre class="plugin_pre">
groovy t_networkaddress_cache_ttl.groovy
30       # positive cache は30秒
10       # negative cache は10秒
false    # positive cache 設定は未設定だった。
true     # negative cache は設定されてた。
</pre>

<p class="paragraph">
Javaでは以下のようになる。設定の未設定・設定有りについては省略。
<br />
DnsTest3.java:
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">sun</span><span class="hl-code">.</span><span class="hl-identifier">net</span><span class="hl-code">.</span><span class="hl-identifier">InetAddressCachePolicy</span><span class="hl-code">;
 
</span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">DnsTest3</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span >static</span><span class="hl-code"> </span><span >void</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-brackets">(</span><span class="hl-identifier">String</span><span class="hl-brackets">[</span><span class="hl-brackets">]</span><span class="hl-code"> </span><span class="hl-identifier">args</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">Exception</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">System</span><span class="hl-code">.</span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-identifier">InetAddressCachePolicy</span><span class="hl-code">.</span><span class="hl-identifier">get</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">System</span><span class="hl-code">.</span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-identifier">InetAddressCachePolicy</span><span class="hl-code">.</span><span class="hl-identifier">getNegative</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span></pre></div>
<p class="paragraph">
※Eclipse上で &quot;Access restriction on class due to restriction on required library rt.jar&quot; というエラーが発生した場合は、 Windows -&gt; Preferences -&gt; Java -&gt; Compiler -&gt; Errors/Warnings で &quot;Forbidden reference (access rules)&quot; を Warning または Ignore に設定する。
<br />
</p>

<p class="paragraph">
実際に実行環境の jre/lib/security/java.security を見てみると、以下のように &quot;networkaddress.cache.ttl&quot; はコメントアウトされていて未設定、 &quot;networkaddress.cache.negative.ttl&quot; は10秒に設定されていた。
<br />
</p>
<pre class="plugin_pre">
...

#
# The Java-level namelookup cache policy for successful lookups:
#
# any negative value: caching forever
# any positive value: the number of seconds to cache an address for
# zero: do not cache
#
# default value is forever (FOREVER). For security reasons, this
# caching is made forever when a security manager is set. When a security
# manager is not set, the default behavior in this implementation
# is to cache for 30 seconds.
#
# NOTE: setting this to anything other than the default value can have
#       serious security implications. Do not set it unless
#       you are sure you are not exposed to DNS spoofing attack.
#
#networkaddress.cache.ttl=-1

# The Java-level namelookup cache policy for failed lookups:
#
# any negative value: cache forever
# any positive value: the number of seconds to cache negative lookup results
# zero: do not cache
#
# In some Microsoft Windows networking environments that employ
# the WINS name service in addition to DNS, name service lookups
# that fail may take a noticeably long time to return (approx. 5 seconds).
# For this reason the default caching policy is to maintain these
# results for 10 seconds.
#
#
networkaddress.cache.negative.ttl=10

...
</pre>

<p class="paragraph">
InetAddressCachePolicy クラス名で sun/com.sun パッケージ含めたJDKのJavaソースをgrepしたところ、 &quot;java/net/InetAddress.java&quot; でのみ使われていた。
<br />
InetAddressの中に Cache クラスというのがネストされて定義されており、その中で参照されている。
<br />
</p>
<div class="hl-main"><pre><span class="hl-comment">/*</span><span class="hl-comment">*
     * A cache that manages entries based on a policy specified
     * at creation time.
     </span><span class="hl-comment">*/</span><span class="hl-code">
    </span><span >static</span><span class="hl-code"> </span><span >final</span><span class="hl-code"> </span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">Cache</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span class="hl-identifier">LinkedHashMap</span><span class="hl-code">&lt;</span><span class="hl-identifier">String</span><span class="hl-code">, </span><span class="hl-identifier">CacheEntry</span><span class="hl-code">&gt; </span><span class="hl-identifier">cache</span><span class="hl-code">;
        </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span class="hl-identifier">Type</span><span class="hl-code"> </span><span class="hl-identifier">type</span><span class="hl-code">;
 
        </span><span class="hl-identifier">enum</span><span class="hl-code"> </span><span class="hl-identifier">Type</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-identifier">Positive</span><span class="hl-code">, </span><span class="hl-identifier">Negative</span><span class="hl-brackets">}</span><span class="hl-code">;
 
        </span><span class="hl-comment">/*</span><span class="hl-comment">*
         * Create cache
         </span><span class="hl-comment">*/</span><span class="hl-code">
        </span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-identifier">Cache</span><span class="hl-brackets">(</span><span class="hl-identifier">Type</span><span class="hl-code"> </span><span class="hl-identifier">type</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">type</span><span class="hl-code"> = </span><span class="hl-identifier">type</span><span class="hl-code">;
            </span><span class="hl-identifier">cache</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-identifier">LinkedHashMap</span><span class="hl-code">&lt;</span><span class="hl-identifier">String</span><span class="hl-code">, </span><span class="hl-identifier">CacheEntry</span><span class="hl-code">&gt;</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}</span><span class="hl-code">
 
        </span><span class="hl-reserved">private</span><span class="hl-code"> </span><span >int</span><span class="hl-code"> </span><span class="hl-identifier">getPolicy</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">type</span><span class="hl-code"> == </span><span class="hl-identifier">Type</span><span class="hl-code">.</span><span class="hl-identifier">Positive</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">InetAddressCachePolicy</span><span class="hl-code">.</span><span class="hl-identifier">get</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}</span><span class="hl-code"> </span><span class="hl-reserved">else</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
                </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">InetAddressCachePolicy</span><span class="hl-code">.</span><span class="hl-identifier">getNegative</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}</span><span class="hl-code">
        </span><span class="hl-brackets">}</span><span class="hl-code">
        </span><span class="hl-comment">/*</span><span class="hl-comment"> ... </span><span class="hl-comment">*/</span></pre></div>


<h4 id="idf16c83">&quot;networkaddress.cache.ttl&quot; のデフォルト値は？</h4>

<ul><li> OpenJDK7 : 30秒（ソースコード上で確認 <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/InetAddressCachePolicy.java" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/net/InetAddressCachePolicy.java</a> ）</li>
<li> Windows 64bit版 Oracle JDK 8 (1.8.0.31) : 30秒（実測値）</li>
<li> 他のバージョン/他のJVM製品 : 不明。ドキュメントやソースを確認、可能ならばサポートに問い合わせ。</li></ul>

<h4 id="id96196c">&quot;networkaddress.cache.ttl&quot; はDNSサーバが返すTTLとどう連携するか？</h4>

<p class="paragraph">
これはあくまでも「Javaライブラリのレイヤーで名前解決したのをキャッシュする期間」である。そして、InetAddress経由の名前解決は、デフォルトではnative(=JNI)の実装になってしまい、その内部までは調べきれなかった。
<br />
そのため、以下のようなケースではどうなるか、確認していない。
<br />
</p>

<ul><li> DNSのNSレコードのTTLは数秒になっているのに、SecurityManager付き + &quot;networkaddress.cache.ttl=-1&quot; でJavaを起動した場合。<ul><li> → 最初に名前解決したのがずっとキャッシュされてしまい、DNS側のTTLの設定値とは無関係な動きになってしまうのか？</li></ul></li></ul>

<p class="paragraph">
この点を確認するのであれば、自前で sun.net.spi.nameservice.NameService 及び NameServiceDescriptor を実装して名前解決の要求があったらlogするようにして、それを &quot;sun.net.spi.nameservice.provider.N&quot; あたりに設定すれば良いだろう。
<br />
個人的な想像だが、 NameService の lookupAllHostAddr() や getHostByAddr() はDNSサーバからのTTL情報をやりとりできるメソッドシグネチャになってないため、DNSのTTLは InetAddress のキャッシュ処理とは連携出来ないのではないか、と予想される。つまりまず &quot;networkaddress.cache.ttl&quot; によるキャッシュ期間がチェックされ、それがexpireされて始めてDNS問い合わせが発生する。この時DNSサーバからのTTL情報をどう扱うかは、NameServiceの実装に依存することが予想される。
<br />
</p>


<h3 id="idb2c0b2">参考資料</h3>

<p class="paragraph">
networkaddress.cache.ttl 関連：
<br />
</p>
<ul><li> JavaのDNSキャッシュ - 人類みんなごくつぶし<ul><li> <a class="externallink" href="http://d.hatena.ne.jp/muimy/20110105/1294225912" target="_blank">http://d.hatena.ne.jp/muimy/20110105/1294225912</a></li></ul></li>
<li> java.net.URLの闇 - blog.scheakur.com<ul><li> <a class="externallink" href="http://blog.scheakur.com/post/74938746551/java-net-url" target="_blank">http://blog.scheakur.com/post/74938746551/java-net-url</a></li></ul></li></ul>

<p class="paragraph">
ネットワーク関連のJavaプロパティ
<br />
</p>
<ul><li> JDK6 : <a class="externallink" href="https://docs.oracle.com/javase/jp/6/technotes/guides/net/properties.html" target="_blank">https://docs.oracle.com/javase/jp/6/technotes/guides/net/properties.html</a></li>
<li> JDK7 : <a class="externallink" href="https://docs.oracle.com/javase/jp/7/technotes/guides/net/properties.html" target="_blank">https://docs.oracle.com/javase/jp/7/technotes/guides/net/properties.html</a></li>
<li> JDK8 : <a class="externallink" href="https://docs.oracle.com/javase/jp/8/technotes/guides/net/properties.html" target="_blank">https://docs.oracle.com/javase/jp/8/technotes/guides/net/properties.html</a></li></ul>

<p class="paragraph">
Eclipse上でプログラミングしている時に、sun.net や com.sun 以下のパッケージやクラスを参照しようとして &quot;Access restriction on class due to restriction on required library rt.jar&quot; みたいなエラーが発生した時
<br />
</p>
<ul><li> java - Access restriction on class due to restriction on required library rt.jar? - Stack Overflow<ul><li> <a class="externallink" href="http://stackoverflow.com/questions/860187/access-restriction-on-class-due-to-restriction-on-required-library-rt-jar" target="_blank">http://stackoverflow.com/questions/860187/access-restriction-on-class-due-to-restriction-on-required-library-rt-jar</a></li></ul></li>
<li> java ee - Access restriction on jdk1.7/jre/lib/rt.jar - Stack Overflow<ul><li> <a class="externallink" href="http://stackoverflow.com/questions/10428984/access-restriction-on-jdk1-7-jre-lib-rt-jar" target="_blank">http://stackoverflow.com/questions/10428984/access-restriction-on-jdk1-7-jre-lib-rt-jar</a></li></ul></li>
<li> [Eclipse] Access restriction: Class is not accessible due to restriction on required library @Digizol<ul><li> <a class="externallink" href="http://www.digizol.com/2008/09/eclipse-access-restriction-on-library.html" target="_blank">http://www.digizol.com/2008/09/eclipse-access-restriction-on-library.html</a></li></ul></li>
<li> Javaで「Access restriction」と出たときの対処 - Fight the Future<ul><li> <a class="externallink" href="http://jyukutyo.hatenablog.com/entry/20101211/1292161476" target="_blank">http://jyukutyo.hatenablog.com/entry/20101211/1292161476</a></li></ul></li></ul>

<p class="paragraph">
sun/com.sunなどのパッケージを含んだJavaソース
<br />
</p>
<ul><li> JDK付属の「src.zip」の代わりに「jdk7src」を使ってEclipseの「Source not found」を回避する方法<ul><li> <a class="externallink" href="http://did2memo.net/2012/12/17/eclipse-jdk-src-zip-jdk7src-source-not-found/" target="_blank">http://did2memo.net/2012/12/17/eclipse-jdk-src-zip-jdk7src-source-not-found/</a></li></ul></li>
<li> <a class="externallink" href="http://jdk7src.sourceforge.net/" target="_blank">http://jdk7src.sourceforge.net/</a></li></ul>

<p class="paragraph">
OpenJDK7ミラーソース
<br />
</p>
<ul><li> <a class="externallink" href="https://github.com/openjdk-mirror/jdk7u-jdk" target="_blank">https://github.com/openjdk-mirror/jdk7u-jdk</a></li></ul>


<hr class="full_hr" />
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-1093.html" title="Java/ServletとJSESSIONIDのURL管理">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1441.html" title="Java/Springでの Server-Sent Events, WebSocket 参考メモ(2018-12月頃)">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-457.html" title="Java">Up</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-457.html" title="Java">Java</a>&nbsp;]</li>
</ul>
</div>

<div class="data_attrs_post">
original url: https://www.glamenv-septzen.net/view/1346<br>
</div>

</div>
<!-- //data_main -->

</div>


</div>
<!-- /content-wrap end -->

<!-- footer start -->
<div id="footer">
Copyright &copy; 2007 - 2025 Masahiko Sakamoto(msakamoto-sf)<br>
License&nbsp;:&nbsp;<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a><br>
Contact&nbsp;:&nbsp;<a target="_blank" href="https://x.com/msakamoto_sf">x(twitter)</a> / <a target="_blank" href="https://github.com/msakamoto-sf/">github</a> / <a class="maillink" href="mailto:&#x73;&#x61;&#x6B;&#x61;&#x6D;&#x6F;&#x74;&#x6F;&#x2E;&#x67;&#x73;&#x79;&#x63;&#x2E;&#x33;&#x73;&#x40;&#x67;&#x6D;&#x61;&#x69;&#x6C;&#x2E;&#x63;&#x6F;&#x6D;">email</a><br>
--&nbsp;Beautiful Icons&nbsp;--<br />
<a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank" title="Mark James Silk icon set 1.3">Mark James Silk icon set 1.3</a> by famfamfam<br />
<a href="http://www.pinvoke.com/" target="_blank" title="Fugue Icons">Fugue Icons</a> by Yusuke Kamiyamane<br />
</div>
<!-- /footer end -->

</div>
<!-- /body end -->

</body>
</html>