<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Java/Maven3/Eclipse上でサクサクWeb開発 (例:tomcat-maven-plugin) - Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</title>
<!-- favicon 2017's reference:
https://developers.google.com/web/fundamentals/design-and-ui/browser-customization/
https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx
https://developer.chrome.com/multidevice/android/installtohomescreen
https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html
-->
<link rel="shortcut icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="57x57" href="../favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="../favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="../favicons/favicon-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-160x160.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-196x196.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">

<!-- browserconfig.xml : https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx -->
<meta name="msapplication-TileColor" content="#990000">
<meta name="msapplication-TileImage" content="../favicons/mstile-144x144.png">

<!-- these favicon files were generated by https://ao-system.net/favicongenerator/ , thanks!!(2017-02-18) -->

<style type="text/css"></style>

<link href="./css/pcbrowser.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_plugins.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_wiki.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/print.css" rel="stylesheet" type="text/css" media="print"/>
</head>
<body>
<!-- body start -->
<div class="body">
<div style="display: inline"><a name="pagetop"></a></div>
<div id="header-wrap">
<img src="./images/logo1.jpg" style="float: left; margin-right: 1em;"/>
<a href="./index.html" title="Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)"><img src="./icons/home.png" alt="home"/>&nbsp;Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</a>


<h1 style="margin-bottom: 10px;">Java/Maven3/Eclipse上でサクサクWeb開発 (例:tomcat-maven-plugin)</h1>

<div style="clear: both;"></div>
</div><!-- //header-wrap -->

<!-- content-wrap start -->
<div id="content-wrap"><div class="contents_s">

<!-- data_main -->
<div class="data_main">

<div class="data_attrs_pre">
作成日: 2012-04-09 18:11:36 &nbsp; / &nbsp; last updated at: 2013-07-28 20:59:00<br>
カテゴリ: <a href="category-63.html">Eclipse</a>&nbsp;<a href="category-11.html">Java</a>&nbsp;<a href="category-62.html">Maven</a>&nbsp;</div>

<div class="data_body">
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-1153.html" title="Java/Maven3/Eclipse上でサクサクWeb開発 (tomcat-maven-pluginを使ったテンプレート + Groovy)">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1203.html" title="Java/Maven3/JUnit, Spock, TestNGを同時実行する">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-457.html" title="Java">Java</a>&nbsp;]</li>
</ul>
<hr class="full_hr" />

<p class="paragraph">
<strong>2013-07更新</strong>
<br />
</p>

<p class="paragraph">
2013-02に Apache Tomcat Maven Plugin の 2.1 がリリースされ、nexus.codehaus.org のリポジトリから 1.2 が削除されました。現在はMavenのCentralリポジトリから 2.1 を直接ロード出来ます。
<br />
</p>
<ul><li> Apache Tomcat - Tomcat Maven Plugin<ul><li> <a class="externallink" href="http://tomcat.apache.org/maven-plugin.html" target="_blank">http://tomcat.apache.org/maven-plugin.html</a></li></ul></li>
<li> Apache Tomcat Maven Plugin - About Apache Tomcat Maven Plugin<ul><li> <a class="externallink" href="http://tomcat.apache.org/maven-plugin-2.1/" target="_blank">http://tomcat.apache.org/maven-plugin-2.1/</a></li></ul></li></ul>

<p class="paragraph">
pom.xmlへの組み込み例：
<br />
</p>
<pre class="plugin_pre">
&lt;build&gt;
  &lt;plugins&gt;
    ...
&lt;plugin&gt;
  &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
  &lt;artifactId&gt;tomcat6-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.1&lt;/version&gt;
  &lt;configuration&gt;
    &lt;port&gt;8090&lt;/port&gt;
    &lt;path&gt;/tomcat6-demo&lt;/path&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
&lt;plugin&gt;
  &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;
  &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.1&lt;/version&gt;
  &lt;configuration&gt;
    &lt;port&gt;8090&lt;/port&gt;
    &lt;path&gt;/tomcat7-demo&lt;/path&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
    ...
  &lt;/plugins&gt;
&lt;/build&gt;
</pre>

<p class="paragraph">
Tomcat6とTomcat7用に分離されています。ゴールも&quot;tomcat6:xxxx&quot;と&quot;tomcat7:xxxx&quot;で分かれているため、両方同時に組み込んでもゴール指定で使い分けることができるため、衝突問題も発生しません。
<br />
</p>

<p class="paragraph">
実際のサンプルコードについては <a href="./view-1150.html" >Java/Maven3/Eclipse上でサクサクWeb開発 (tomcat-maven-pluginを使ったテンプレート)</a> を参照してください。
<br />
</p>

<hr />
<p class="paragraph">
MavenプロジェクトでのServletプログラミングで、Eclipse上で「サクサク」、つまりJavaソース修正→Eclipse上で保存→Eclipseによる自動コンパイル→即座にServletContainer上に反映という素早い開発サイクルを実現するためのメモです。
<br />
対象：フルスペックのJ2EEサーバ機能を用いない、TomcatやJettyなどの軽量ServletContainer上で動作するWebアプリケーション。
<br />
環境：Maven3, Eclipse 3.6 or 3.7 以上, m2e プラグイン, Tomcat 5 以上
<br />
</p>



<ul><li><a href="#idc2b027">Java Servlet プログラミングにおける「サクサク開発」の基本方針</a></li>
<li><a href="#id6afbbd">サンプルコード</a></li>
<li><a href="#idbac790">codehausのリポジトリURLとtomcat-maven-pluginの組み込み</a></li>
<li><a href="#id3d7751">Eclipseからのデバッグ実行</a></li></ul>
<hr />
<h3 id="idc2b027">Java Servlet プログラミングにおける「サクサク開発」の基本方針</h3>

<p class="paragraph">
Java Servlet プログラミングで何がプログラマを苛立たせるか。それは &quot;deploy&quot; 作業であると思います。Java Servlet プログラミングで根強い人気を誇る Sysdeo Eclipse Tomcat Launcher Plugin は、Plugin側でTomcatを起動して、Plugin側でEclipseプロジェクトにあわせてContextを自動設定してくれます。これによりプログラマは &quot;deploy&quot; について一切気にする必要が無くなり、Eclipse上でJavaソースを修正→即座にTomcatがContextをリロード→ブラウザ上から動作確認することが出来ます。また、Seasar2 による SAStruts フレームワークではhot deploy機能により、classファイルの更新を検知して自動的に最新のclassファイルをロードしてくれます。これによりプログラマは修正する度に &quot;deploy&quot; する必要は無くなります。
<br />
</p>

<p class="paragraph">
ここまでであれば特に難しい問題はありません。Eclipseプロジェクトの出力ディレクトリを&quot;WEB-INF/classes/&quot;に設定し、Servlet Container側で適切にContextのドキュメントベースを設定し、最後にServlet Container側でclassファイルが更新されれば自動的にContextをリロードする設定して準備完了です。
<br />
問題が出てくるのはMavenプロジェクトの場合で、WEB-INFを含めたWebコンテンツは &quot;src/main/webapp/&quot; 以下に、ビルドされたclassファイルは &quot;target/classes/&quot; 以下に、と分断されてしまいます。そのままですとどうしても一度warまでパッケージングした後、ServletContainerにdeployさせる必要が出てきます。
<br />
この問題を解決するためには jetty-maven-plugin や tomcat-maven-plugin を導入します。これらを使うことで、&quot;src/main/webapp/&quot; と &quot;target/classes/&quot; の分断をplugin側で適切にハンドリングしてそれぞれのServlet Containerをデバッグ起動することが可能となります。
<br />
</p>

<p class="paragraph">
ここまでで、&quot;deploy&quot; を省略するためのアプローチを以下に整理します。
<br />
</p>
<dl>
<dt> Sysdeo Eclipse Tomcat Launcher Plugin </dt>
<dd>
<ul><li> <a class="externallink" href="http://www.eclipsetotale.com/tomcatPlugin.html" target="_blank">http://www.eclipsetotale.com/tomcatPlugin.html</a></li>
<li> Eclipse上からTomcatをデバッグモードで起動し、Java Servletのデバッグを可能にする。</li>
<li> 老舗プラグインで使いやすさもあります。ただし、Mavenプロジェクト(m2eプラグイン)と組み合わせるには &quot;DevLoader&quot; をTomcat側にセットアップする必要があるようです。</li>
<li> 参考：DevLoaderとMaven/m2e連携時のトラブルなど<ul><li> <a class="externallink" href="http://www.eclipsetotale.com/tomcatPlugin/readmeDevLoader.html" target="_blank">http://www.eclipsetotale.com/tomcatPlugin/readmeDevLoader.html</a></li>
<li> <a class="externallink" href="http://bagineer.blog59.fc2.com/blog-entry-98.html" target="_blank">http://bagineer.blog59.fc2.com/blog-entry-98.html</a></li>
<li> <a class="externallink" href="http://d.hatena.ne.jp/Ewigkeit/20071122/1195658893" target="_blank">http://d.hatena.ne.jp/Ewigkeit/20071122/1195658893</a></li></ul></li></ul></dd>
<dt> SAStruts (Seasar 2.4 SMART deploy) </dt>
<dd>
<ul><li> <a class="externallink" href="http://sastruts.seasar.org/" target="_blank">http://sastruts.seasar.org/</a></li>
<li> StrutsのXML地獄から開発者を解放するSAStruts (1/3) - ＠IT<ul><li> <a class="externallink" href="http://www.atmarkit.co.jp/fjava/rensai4/saweb02/saweb02_1.html" target="_blank">http://www.atmarkit.co.jp/fjava/rensai4/saweb02/saweb02_1.html</a></li></ul></li>
<li> crossroad&#039;s Blog Eclipse + Maven2 + Tomcat + Seasar2 の開発環境ベスト！？プラクティス<ul><li> <a class="externallink" href="http://bagineer.blog59.fc2.com/blog-entry-98.html" target="_blank">http://bagineer.blog59.fc2.com/blog-entry-98.html</a></li></ul></li></ul></dd>
<dt> jetty-maven-plugin </dt>
<dd>
<p class="paragraph">
Jettyは軽量のJava Servlet Containerです。jetty-maven-pluginをMavenプロジェクトに組み込むことで、&quot;mvn jetty:run&quot; でMavenのディレクトリ構成に従ってServletContainerが起動します。これにより、Mavenでビルド or m2eプラグイン導入済みのEclipse側で自動コンパイルされたclassがJetty側でも間を置かずに自動リロードしてくれるようになります。
<br />
</p>
<ul><li> Jetty 7 or 8以降<ul><li> <a class="externallink" href="http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin" target="_blank">http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin</a></li></ul></li>
<li> Jetty 6以前 (&quot;maven-jetty-plugin&quot;という名前だった)<ul><li> <a class="externallink" href="http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin" target="_blank">http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin</a></li></ul></li></ul></dd>
<dt> tomcat-maven-plugin </dt>
<dd>
<p class="paragraph">
Mavenのplugin内部でTomcatをLaunch可能にします。当初は codehaus で開発されていましたが、バージョン 2.0 以降は Tomcat プロジェクト側に開発が移ったようです。
<br />
</p>
<ul><li> 2.0以降：2.0-SNAPSHOTは開発中、Maven Central Repositry に登録されているのは 2.0-beta-1 までです。<ul><li> <a class="externallink" href="http://tomcat.apache.org/maven-plugin.html" target="_blank">http://tomcat.apache.org/maven-plugin.html</a></li>
<li> <a class="externallink" href="http://tomcat.apache.org/maven-plugin-2/" target="_blank">http://tomcat.apache.org/maven-plugin-2/</a></li>
<li> <a class="externallink" href="http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/" target="_blank">http://tomcat.apache.org/maven-plugin-2.0-SNAPSHOT/</a></li></ul></li>
<li> 1.0, 1.1, 1.2：codehausのドキュメント参照。<ul><li> <a class="externallink" href="http://mojo.codehaus.org/tomcat-maven-plugin/index.html" target="_blank">http://mojo.codehaus.org/tomcat-maven-plugin/index.html</a></li></ul></li>
<li> 5. Maven による実アプリケーション開発 | TECHSCORE(テックスコア)<ul><li> <a class="externallink" href="http://www.techscore.com/tech/Java/ApacheJakarta/Maven/5/" target="_blank">http://www.techscore.com/tech/Java/ApacheJakarta/Maven/5/</a></li></ul></li></ul>

<p class="paragraph">
以下注意点です。
<br />
</p>
<ul><li> GroupId : 1.2 までは &quot;org.codehaus.mojo&quot;, 2.0 以降は &quot;org.apache.tomcat.maven&quot; に変更されています。</li>
<li> どのリポジトリを使えば良いのか？<ul><li> 1.1 と 2.0 については Central(repo1) に登録されているのを使えば良いと思います。</li>
<li> 1.2 については codehaus リポジトリにのみ登録されているため、1.2を使う場合は settings.xml か pom.xml にcodehausのリポジトリ設定を追加する必要があります。</li></ul></li>
<li> 利用するTomcatのバージョンを選択できるか？<ul><li> 2.0以降は Tomcat6 : tomcat6-maven-plugin, Tomcat7 : tomcat7-maven-plugin というようにTomcatのバージョンごとに分かれているようです。</li>
<li> Tomcat Maven Plugin - Adjust Tomcat Version<ul><li> <a class="externallink" href="http://mojo.codehaus.org/tomcat-maven-plugin/examples/adjust-embedded-tomcat-version.html" target="_blank">http://mojo.codehaus.org/tomcat-maven-plugin/examples/adjust-embedded-tomcat-version.html</a></li>
<li> <a class="externallink" href="http://tomcat.apache.org/maven-plugin-2/tomcat6-maven-plugin/examples/adjust-embedded-tomcat-version.html" target="_blank">http://tomcat.apache.org/maven-plugin-2/tomcat6-maven-plugin/examples/adjust-embedded-tomcat-version.html</a></li></ul></li></ul></li></ul></dd>
</dl>

<p class="paragraph">
本記事では、以下の理由から バージョン 1.2 のtomcat-maven-plugin を使ってみます。
<br />
</p>
<ul><li> Jetty版については公式サイトにかなり詳しく色々なバリエーションと応用技法が載っているのに対し、Tomcat版はあまり情報が豊富でない気がした。</li>
<li> たまたま本記事を書くきっかけとなったEclipseプロジェクトの本番deploy環境がTomcatだったため、環境を合せておきたかった。実働環境はTomcatなのに、開発をJettyとすることで不要な地雷を踏み抜きそうな悪寒がした。</li>
<li> pom.xmlにリポジトリ設定を記述する練習をしたかったので、あえてcodhausのsnapshotリポジトリの追記が必要な 1.2 を選択。</li></ul>

<h3 id="id6afbbd">サンプルコード</h3>

<pre>環境：
MacOS X 10.7.3
$ mvn -version
Apache Maven 3.0.3 (r1075438; 2011-03-01 02:31:09+0900)
Maven home: /usr/share/maven
Java version: 1.6.0_31, vendor: Apple Inc.
Java home: /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
Default locale: ja_JP, platform encoding: SJIS
OS name: &quot;mac os x&quot;, version: &quot;10.7.3&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;

Eclipse 3.7 Java EE
M2E - Maven Integration for Eclipse 1.0
</pre>

<p class="paragraph">
archetypeとしてcodehausのwebapp-jee5を使って &quot;Hello, World&quot; のServletサンプルコードを作成します。
<br />
</p>
<pre class="plugin_pre">
$ mvn archetype:generate
…
Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): : org.codehaus.mojo.archetypes:webapp-jee5
Choose archetype:
1: remote -&gt; org.codehaus.mojo.archetypes:webapp-jee5 (-)
Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): : 1
Choose version: 
1: 1.0
2: 1.0.1
3: 1.1
4: 1.2
5: 1.3
Choose a number: 5: 
Define value for property &#039;groupId&#039;: : test      
Define value for property &#039;artifactId&#039;: : servlet1
Define value for property &#039;version&#039;:  1.0-SNAPSHOT: : 
Define value for property &#039;package&#039;:  test: : test.servlet1
Confirm properties configuration:
groupId: test
artifactId: servlet1
version: 1.0-SNAPSHOT
package: test.servlet1
…

$ cd servlet1/
$ find .
.
./pom.xml
./src
./src/main
./src/main/java
./src/main/java/test
./src/main/java/test/servlet1
./src/main/webapp
./src/main/webapp/index.jsp
./src/main/webapp/WEB-INF
./src/main/webapp/WEB-INF/web.xml
</pre>
<p class="paragraph">
とりあえずEclipseにインポートし、以下のJavaクラスを追加します。
<br />
src/main/java/test/servlet1/Hello.java:
<br />
</p>
<div class="hl-main"><pre><span class="hl-reserved">package</span><span class="hl-code"> </span><span class="hl-identifier">test</span><span class="hl-code">.</span><span class="hl-identifier">servlet1</span><span class="hl-code">;
 
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">io</span><span class="hl-code">.</span><span class="hl-identifier">IOException</span><span class="hl-code">;
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">java</span><span class="hl-code">.</span><span class="hl-identifier">io</span><span class="hl-code">.</span><span class="hl-identifier">PrintWriter</span><span class="hl-code">;
 
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">javax</span><span class="hl-code">.</span><span class="hl-identifier">servlet</span><span class="hl-code">.</span><span class="hl-identifier">ServletException</span><span class="hl-code">;
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">javax</span><span class="hl-code">.</span><span class="hl-identifier">servlet</span><span class="hl-code">.</span><span class="hl-identifier">http</span><span class="hl-code">.</span><span class="hl-identifier">HttpServlet</span><span class="hl-code">;
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">javax</span><span class="hl-code">.</span><span class="hl-identifier">servlet</span><span class="hl-code">.</span><span class="hl-identifier">http</span><span class="hl-code">.</span><span class="hl-identifier">HttpServletRequest</span><span class="hl-code">;
</span><span class="hl-reserved">import</span><span class="hl-code"> </span><span class="hl-identifier">javax</span><span class="hl-code">.</span><span class="hl-identifier">servlet</span><span class="hl-code">.</span><span class="hl-identifier">http</span><span class="hl-code">.</span><span class="hl-identifier">HttpServletResponse</span><span class="hl-code">;
 
</span><span class="hl-reserved">public</span><span class="hl-code"> </span><span class="hl-reserved">class</span><span class="hl-code"> </span><span class="hl-identifier">Hello</span><span class="hl-code"> </span><span class="hl-reserved">extends</span><span class="hl-code"> </span><span class="hl-identifier">HttpServlet</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
 
    @</span><span class="hl-identifier">Override</span><span class="hl-code">
    </span><span class="hl-reserved">protected</span><span class="hl-code"> </span><span >void</span><span class="hl-code"> </span><span class="hl-identifier">doGet</span><span class="hl-brackets">(</span><span class="hl-identifier">HttpServletRequest</span><span class="hl-code"> </span><span class="hl-identifier">req</span><span class="hl-code">, </span><span class="hl-identifier">HttpServletResponse</span><span class="hl-code"> </span><span class="hl-identifier">resp</span><span class="hl-brackets">)</span><span class="hl-code">
            </span><span class="hl-reserved">throws</span><span class="hl-code"> </span><span class="hl-identifier">ServletException</span><span class="hl-code">, </span><span class="hl-identifier">IOException</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">resp</span><span class="hl-code">.</span><span class="hl-identifier">setContentType</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">text/html</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">PrintWriter</span><span class="hl-code"> </span><span class="hl-identifier">out</span><span class="hl-code"> = </span><span class="hl-identifier">resp</span><span class="hl-code">.</span><span class="hl-identifier">getWriter</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">&lt;html&gt;</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">&lt;body&gt;</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">Hello, World!</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">&lt;/body&gt;</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">println</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">&lt;/html&gt;</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">out</span><span class="hl-code">.</span><span class="hl-identifier">close</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span></pre></div>

<p class="paragraph">
src/main/webapp/WEB-INF/web.xml に以下のようにservlet設定を追加します。
<br />
</p>
<pre class="plugin_pre">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;web-app …&gt;
    &lt;display-name&gt;servlet1&lt;/display-name&gt;
    &lt;session-config&gt;
        &lt;session-timeout&gt;
            30
    &lt;/session-timeout&gt;
    &lt;/session-config&gt;
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;
    &lt;!-- append start --&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;Hello&lt;/servlet-name&gt;
        &lt;servlet-class&gt;test.servlet1.Hello&lt;/servlet-class&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;Hello&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
    &lt;!-- append end --&gt;
&lt;/web-app&gt;
</pre>

<p class="paragraph">
&quot;mvn package&quot; で target/servlet1-1.0-SNAPSHOT.war が生成されれば、一旦適当なTomcatのwebappsディレクトリにコピーし、deployして動作確認しておきます。
<br />
</p>

<h3 id="idbac790">codehausのリポジトリURLとtomcat-maven-pluginの組み込み</h3>

<p class="paragraph">
まずcodehausのsnapshotリポジトリURLをpom.xmlに組み込みます。
<br />
2012-04現在、codehausではsonatypeのNexus (  <a class="externallink" href="http://www.sonatype.com/Products/Nexus-Professional" target="_blank">http://www.sonatype.com/Products/Nexus-Professional</a> ) を運用していますので、以下のURLからsnapshotリポジトリのURLを確認できます。
<br />
</p>
<ol><li> <a class="externallink" href="https://nexus.codehaus.org/" target="_blank">https://nexus.codehaus.org/</a></li>
<li> サイドメニューの &quot;Views/Repositories&quot; から &quot;Repositories&quot; 選択 -&gt; &quot;Snapshots Group&quot; の &quot;Repository Path&quot; をコピー。</li>
<li> 上でコピーしたURLを以下のようにpom.xmlに組み込みます。要素の順番はあまり気にしなくて良いようです。不安であれば <a class="externallink" href="http://maven.apache.org/pom.html#Quick_Overview" target="_blank">http://maven.apache.org/pom.html#Quick_Overview</a> の順に配置すればよいでしょう。</li></ol>

<pre class="plugin_pre">
...
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;id&gt;codehaus-snapshots-group&lt;/id&gt;
      &lt;name&gt;Codehaus Snapshot Repositry&lt;/name&gt;
      &lt;url&gt;https://nexus.codehaus.org/content/groups/snapshots-group/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/snapshots&gt;
      &lt;id&gt;codehaus-snapshots-group&lt;/id&gt;
      &lt;name&gt;Codehaus Snapshot Repositry&lt;/name&gt;
      &lt;url&gt;https://nexus.codehaus.org/content/groups/snapshots-group/&lt;/url&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;
...
</pre>

<p class="paragraph">
続いてtomcat-maven-pluginを組み込みます。
<br />
</p>
<ol><li> &quot;Snapshots Group&quot; 選択</li>
<li> &quot;Browse Storage&quot; の &quot;Path Lookup:&quot; で &quot;org/codehaus/mojo/tomcat-maven-plugin&quot; を選択</li>
<li> &quot;1.2-SNAPSHOT&quot; から適当な jar を選択</li>
<li> &quot;Maven Information&quot; の &quot;XML&quot; に、そのままpom.xmlにコピペ出来る &quot;&lt;dependency&gt;&quot; タグが表示されるので、pom.xmlに以下のようにコピペ。</li></ol>

<pre class="plugin_pre">
...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.0.2&lt;/version&gt;
        &lt;configuration&gt;
          &lt;source&gt;1.5&lt;/source&gt;
          &lt;target&gt;1.5&lt;/target&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;!-- Copy &amp; Paste Start --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;tomcat-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.2-SNAPSHOT&lt;/version&gt;
        &lt;configuration&gt;
          &lt;path&gt;/&lt;/path&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;!-- Copy &amp; Paste End --&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
...
</pre>

<p class="paragraph">
では &quot;mvn tomcat:run&quot; を実行してみます。依存jarのDLが終わった後、Tomcatの起動メッセージが表示されます。
<br />
&quot;Starting Coyote HTTP/1.1 on http-8080&quot; のメッセージが表示されたら、ブラウザでlocalhostの8080番にアクセスしてみます。&quot;&lt;path&gt;&quot;要素にて、ContextPathを &quot;/&quot; にしていますので、
<br />
</p>
<pre>http://localhost:8080/hello
</pre>
<p class="paragraph">
にアクセスすれば Hello クラスのServletが実行されます。
<br />
</p>

<p class="paragraph">
上手く動かない場合は、すでに8080番をListenしているサービスがいないか、pom.xmlの記述をtypoしていないかなど確認してみてください。
<br />
また起動されたTomcatは、Ctrl-Cで終了できます。
<br />
</p>

<h3 id="id3d7751">Eclipseからのデバッグ実行</h3>

<p class="paragraph">
ここまで確認できれば、あとはEclipse上からMaven Buildの &quot;tomcat:run&quot; ゴールをデバッグ実行します。この時、デバッグビューにて実行中のMaven Buildを右クリックしてソースルックアップパスを適切に設定しておきましょう。
<br />
あとはブレークポイントを設定するなどして、自由にデバッグ実行が可能です。また、Eclipse上でJavaソースを編集して保存すると、即座にTomcat側にも反映されます。
<br />
</p>

<p class="paragraph">
tomcat-maven-pluginには他にも、warをTomcatにdeployしたり、deploy中のアプリ一欄を表示したりと色々便利なゴールが用意されています。また &quot;tomcat:run&quot; ゴール自体にも&quot;fork&quot;を始めとするオプションパラメータを設定できますので、CIサーバ上で結合テストを実施するなどにも活用できます。
<br />
本記事をきっかけとして、実際の現場でtomcat-maven-pluginを活用していただければ幸いです。
<br />
</p>

<hr class="full_hr" />
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-1153.html" title="Java/Maven3/Eclipse上でサクサクWeb開発 (tomcat-maven-pluginを使ったテンプレート + Groovy)">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1203.html" title="Java/Maven3/JUnit, Spock, TestNGを同時実行する">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-457.html" title="Java">Java</a>&nbsp;]</li>
</ul>
</div>

<div class="data_attrs_post">
original url: https://www.glamenv-septzen.net/view/1071<br>
</div>

</div>
<!-- //data_main -->

</div>


</div>
<!-- /content-wrap end -->

<!-- footer start -->
<div id="footer">
Copyright &copy; 2007 - 2025 Masahiko Sakamoto(msakamoto-sf)<br>
License&nbsp;:&nbsp;<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a><br>
Contact&nbsp;:&nbsp;<a target="_blank" href="https://x.com/msakamoto_sf">x(twitter)</a> / <a target="_blank" href="https://github.com/msakamoto-sf/">github</a> / <a class="maillink" href="mailto:&#x73;&#x61;&#x6B;&#x61;&#x6D;&#x6F;&#x74;&#x6F;&#x2E;&#x67;&#x73;&#x79;&#x63;&#x2E;&#x33;&#x73;&#x40;&#x67;&#x6D;&#x61;&#x69;&#x6C;&#x2E;&#x63;&#x6F;&#x6D;">email</a><br>
--&nbsp;Beautiful Icons&nbsp;--<br />
<a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank" title="Mark James Silk icon set 1.3">Mark James Silk icon set 1.3</a> by famfamfam<br />
<a href="http://www.pinvoke.com/" target="_blank" title="Fugue Icons">Fugue Icons</a> by Yusuke Kamiyamane<br />
</div>
<!-- /footer end -->

</div>
<!-- /body end -->

</body>
</html>