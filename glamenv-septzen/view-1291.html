<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>JavaScript/ExtJS/ExtJS4 + Sencha Cmd 勉強メモ1 - Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</title>
<!-- favicon 2017's reference:
https://developers.google.com/web/fundamentals/design-and-ui/browser-customization/
https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx
https://developer.chrome.com/multidevice/android/installtohomescreen
https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html
-->
<link rel="shortcut icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="57x57" href="../favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="../favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="../favicons/favicon-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-160x160.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-196x196.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">

<!-- browserconfig.xml : https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx -->
<meta name="msapplication-TileColor" content="#990000">
<meta name="msapplication-TileImage" content="../favicons/mstile-144x144.png">

<!-- these favicon files were generated by https://ao-system.net/favicongenerator/ , thanks!!(2017-02-18) -->

<style type="text/css"></style>

<link href="./css/pcbrowser.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_plugins.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_wiki.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/print.css" rel="stylesheet" type="text/css" media="print"/>
</head>
<body>
<!-- body start -->
<div class="body">
<div style="display: inline"><a name="pagetop"></a></div>
<div id="header-wrap">
<img src="./images/logo1.jpg" style="float: left; margin-right: 1em;"/>
<a href="./index.html" title="Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)"><img src="./icons/home.png" alt="home"/>&nbsp;Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</a>


<h1 style="margin-bottom: 10px;">JavaScript/ExtJS/ExtJS4 + Sencha Cmd 勉強メモ1</h1>

<div style="clear: both;"></div>
</div><!-- //header-wrap -->

<!-- content-wrap start -->
<div id="content-wrap"><div class="contents_s">

<!-- data_main -->
<div class="data_main">

<div class="data_attrs_pre">
作成日: 2014-06-01 17:44:53 &nbsp; / &nbsp; last updated at: 2014-06-08 20:13:12<br>
カテゴリ: <a href="category-86.html">ExtJS</a>&nbsp;<a href="category-27.html">JavaScript</a>&nbsp;</div>

<div class="data_body">
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-1297.html" title="JavaScript/ExtJS/Ext.Component を使ったカスタムコンポーネントの練習">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1292.html" title="JavaScript/ExtJS/ExtJS4 + Sencha Cmd 勉強メモ2, テーマ(Theme)のカスタマイズ">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-162.html" title="JavaScript">JavaScript</a>&nbsp;]</li>
</ul>
<hr class="full_hr" />

<p class="paragraph">
最近、ExtJSを勉強しているのですが、ExtJS 4.2 になって事実上、Sencha Cmdによる開発方式が前提となりました。
<br />
そこで、ExtJS 4.2 を使ってSencha Cmdを触ってみましたので、練習メモとして公開します。
<br />
</p>

<ul><li> ExtJS, Sencha Cmd<ul><li> <a class="externallink" href="http://www.sencha.com/products/extjs/" target="_blank">http://www.sencha.com/products/extjs/</a></li></ul></li>
<li> 公式ドキュメント<ul><li> <a class="externallink" href="http://docs.sencha.com/extjs/" target="_blank">http://docs.sencha.com/extjs/</a><ul><li> ※アクセスすると2014-05時点では 4.2.2 のドキュメントにジャンプします。ExtJSのzipパッケージの中にはそのバージョンのドキュメントが同梱されてますので、そちらをローカルで参照しても良いと思います。</li></ul></li></ul></li></ul>

<p class="paragraph">
今回の実験環境：
<br />
</p>
<pre class="plugin_pre">
Ubuntu 12.04 LTS (64bit)
ext-4.2.1.883 (GPL版)
Sencha Cmd v4.0.4.84
Ruby (rbenvにて ruby 2.0.0p481 をインストール済み)

/work/www 以下をDocumentRootとしてApacheHTTPDで公開
/work/www/ext-4.2.1.883 にExtJSを展開済み
/work/devtools 以下にSencha Cmdをインストール

Webブラウザによる動作確認：Firefox 29 on Win7 Pro 日本語版
</pre>

<p class="paragraph">
サンプルコード : <a class="externallink" href="https://github.com/msakamoto-sf/extjs42-senchacmdv4-exercise" target="_blank">https://github.com/msakamoto-sf/extjs42-senchacmdv4-exercise</a>
<br />
</p>


<hr />
<ul><li><a href="#idc2dd4c">Sencha Cmd のインストール</a></li>
<li><a href="#id38c765">Sencha Cmd でアプリのひな形を生成してみる (sencha generate app)</a><ul><li><a href="#id0f73a5">sencha generate app での★★ポイント★★</a></li>
<li><a href="#id762639">コンソールログ</a></li>
<li><a href="#id8e0671">生成されたファイル・ディレクトリの★★ポイント★★</a></li>
<li><a href="#id9295f4">★★ポイント★★ : ext/ext-xxxx.js のバリエーションについて</a></li>
<li><a href="#id91ce83">生成されたファイル・ディレクトリの中身を見てみる（抜粋）</a><ul><li><a href="#id2aa5e9">&quot;app&quot; ディレクトリ</a></li>
<li><a href="#idd874df">&quot;sass&quot; ディレクトリ</a></li>
<li><a href="#id821a6c">index.html</a></li>
<li><a href="#idb1afc5">app.json</a></li>
<li><a href="#id5b6e2b">app.js</a></li>
<li><a href="#id1a3b99">${app.dir</a>/app/Application.js}</li>
<li><a href="#id555a24">bootstrap.js</a></li>
<li><a href="#id2ceaae">bootstrap.json</a></li>
<li><a href="#id8f0d97">bootstrap.css</a></li>
<li><a href="#id63f676">.sencha/app/sencha.cfg</a></li>
<li><a href="#idc6efc6">.sencha/workspace/sencha.cfg</a></li></ul></li></ul></li>
<li><a href="#idd49242">Sencha Cmd でアプリをビルドしてみる (sencha app build)</a><ul><li><a href="#id40944f">ビルドする前に、index.htmlで動作を確認してみる。(sencha web start/stop)</a></li>
<li><a href="#iddaf04c">ビルドしてみる : sencha app build, sencha app build testing</a></li>
<li><a href="#idbf336a">ビルド途中の&quot;phantomjs: error while loading shared libraries: libfontconfig.so.1: cannot open shared object file: No such file or directory&quot;</a></li>
<li><a href="#id1070d5">ビルド成果物の確認(production)</a></li>
<li><a href="#id8f6240">テスト用のビルド (sencha app build testing)</a></li>
<li><a href="#id971968">ビルド成果物の確認(testing)</a></li>
<li><a href="#id2653b0">gitに登録</a></li>
<li><a href="#id6f2d25">★★ポイント★★ : ビルドされたindex.htmlからは相対パスでCSSとJSがロードされるので、他のパスからも正常に動作する。</a></li></ul></li>
<li><a href="#id609e64">&quot;sencha generate app&quot; で生成されたデフォルトのスケルトンアプリを動かしてみる</a><ul><li><a href="#id33bf4d">★★ポイント★★ : &quot;${app.dir</a>/bootstrap.css&quot; は最後にビルドしたenvironmentの内容が反映される。}</li>
<li><a href="#idf3f000">生成されたスケルトンコードのポイント</a></li></ul></li>
<li><a href="#id15acfd">&quot;sencha generate view&quot; でViewを追加してみる</a><ul><li><a href="#idffbf50">★★ポイント1★★: ExtJSコンポーネントの参照とSencha CmdによるCSS生成について</a></li>
<li><a href="#id2cd356">★★ポイント2★★: ExtJSコンポーネントが使用する画像ファイルの相対パス参照について</a></li>
<li><a href="#id630400">build/temp/ 以下を .gitignore に追加</a></li>
<li><a href="#idbc5cf5">異なるディレクトリ階層上から&quot;resources&quot;以下のCSSをロードしてみる</a></li>
<li><a href="#id47eaf9">index.htmlがロードするファイルを ext-all-dev.js に変更してみる</a></li>
<li><a href="#id8f7bca">senchaコマンドで生成されたファイルと &quot;.sencha/app/codegen.json&quot; について</a></li>
<li><a href="#id543c77">&quot;sencha generate&quot; でコンポーネント名を間違えるとどうなるか？</a></li></ul></li>
<li><a href="#iddc6efe">ビルドしたファイルを削除(sencha ant clean)</a></li></ul>
<hr />
<h3 id="idc2dd4c">Sencha Cmd のインストール</h3>

<p class="paragraph">
SenchaCmd-4.0.4.84-linux-x64.run.zip を公式サイトからダウンロードし、実験環境にUP.
<br />
</p>

<pre class="plugin_pre">
$ ls
SenchaCmd-4.0.4.84-linux-x64.run.zip
$ unzip SenchaCmd-4.0.4.84-linux-x64.run.zip
Archive:  SenchaCmd-4.0.4.84-linux-x64.run.zip
  inflating: SenchaCmd-4.0.4.84-linux-x64.run
$ ls
SenchaCmd-4.0.4.84-linux-x64.run  SenchaCmd-4.0.4.84-linux-x64.run.zip
$ file SenchaCmd-4.0.4.84-linux-x64.run
SenchaCmd-4.0.4.84-linux-x64.run: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, stripped
</pre>

<p class="paragraph">
SenchaCmd-4.0.4.84-linux-x64.run には実行権限がついてなかったので、chmodで追加して実行。長いライセンス表示と確認のあとインストール先を聞かれるので、&quot;/work/devtools&quot; を指定。
<br />
</p>
<pre class="plugin_pre">
$ chmod +x SenchaCmd-4.0.4.84-linux-x64.run
$ ./SenchaCmd-4.0.4.84-linux-x64.run
----------------------------------------------------------------------------
Welcome to the Sencha Cmd Setup Wizard.
The Sencha Cmd utilities are used to package and deploy Sencha applications.

----------------------------------------------------------------------------
Please read the following License Agreement. You must accept the terms of this
agreement before continuing with the installation.

Press [Enter] to continue :
Sencha Cmd
Copyright (c) 2012-2013 Sencha Inc. All rights reserved.
licensing@sencha.com

Commercial License
---------------------------------------------------------------------------------
---------
Sencha Cmd is licensed commercially for free.  Please visit
http://www.sencha.com/legal/sencha-tools-software-license-agreement for more
details.


Third Party Content
---------------------------------------------------------------------------------
---------
The following third party software is distributed with Sencha Cmd and is
provided under other licenses and/or has source available from other locations.

WebKit (LGPL) Copyright (C) 1991 Free Software Foundation, Inc
Site: http://www.webkit.org/
License: http://www.webkit.org/coding/lgpl-license.html

YUI Compressor (BSD licensed) included in Sencha Touch build tools Copyright ©
Press [Enter] to continue :

...(しばらく、ライセンス確認が続きます)...


Do you accept this license? [y/n]: y

----------------------------------------------------------------------------
Please specify the directory where Sencha Cmd will be installed.

Installation Directory [/home/msakamoto/bin]: /work/devtools

----------------------------------------------------------------------------
Setup is now ready to begin installing Sencha Cmd on your computer.

Do you want to continue? [Y/n]: Y

----------------------------------------------------------------------------
Please wait while Setup installs Sencha Cmd on your computer.

 Installing
 0% ______________ 50% ______________ 100%
 #########################################

----------------------------------------------------------------------------
Setup has finished installing Sencha Cmd on your computer.
</pre>

<p class="paragraph">
ここで .bashrc にPATHを追加しようとしてみてみたら、既に追加されてました。
<br />
</p>

<pre class="plugin_pre">
...

export SENCHA_CMD_3_0_0=&quot;/work/devtools/Sencha/Cmd/4.0.4.84&quot;

export PATH=/work/devtools/Sencha/Cmd/4.0.4.84:$PATH
</pre>

<p class="paragraph">
ログインし直して &quot;sencha which&quot; コマンドを実行してみると、バージョン情報とインストール先が表示されます。
<br />
</p>

<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:~$ sencha which
Sencha Cmd v4.0.4.84
/work/devtools/Sencha/Cmd/4.0.4.84/
</pre>

<h3 id="id38c765">Sencha Cmd でアプリのひな形を生成してみる (sencha generate app)</h3>

<p class="paragraph">
&quot;sencha generate app&quot; でアプリのひな形を生成してみます。
<br />
</p>

<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:~$ cd /work/www
msakamoto@dev1-u1204lts-x64:/work/www$ mkdir extjs-tests
msakamoto@dev1-u1204lts-x64:/work/www$ cd extjs-tests/
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests$ sencha -sdk /work/www/ext-4.2.1.883 generate app MyApp t1
</pre>

<p class="paragraph">
&quot;/work/www/extjs-tests/t1&quot; の下に、アプリのひな形が生成されます。
<br />
</p>

<h4 id="id0f73a5">sencha generate app での★★ポイント★★</h4>

<p class="paragraph">
&quot;-sdk&quot; オプションで、ExtJSのインストールパスを指定する必要があります。ExtJSで使うJSやテーマファイルなどを、ごっそりと &quot;ext&quot; ディレクトリにコピーするためです。
<br />
</p>

<h4 id="id762639">コンソールログ</h4>

<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests$ sencha -sdk /work/www/ext-4.2.1.883 generate app MyApp t1
Sencha Cmd v4.0.4.84
[INF]
[INF] init-plugin:
[INF]
[INF] -before-generate-workspace:
[INF]
[INF] cmd-root-plugin.init-properties:
[INF]
[INF] init-properties:
[INF]
[INF] init-sencha-command:
[INF]
[INF] init:
[INF]
[INF] generate-workspace-impl:
[INF]      [echo] generating into /work/www/extjs-tests/t1 from /work/devtools/Sencha/Cmd/4.0.4.84/templates/workspace
[INF]     [mkdir] Created dir: /work/www/extjs-tests/t1/packages
[INF]
[INF] cmd-root-plugin.copy-framework-to-workspace-impl:
[INF] [propertyfile] Updating property file: /work/www/extjs-tests/t1/.sencha/workspace/sencha.cfg
[INF]
[INF] copy-framework-to-workspace-impl:
[INF]      [copy] Copying 4522 files to /work/www/extjs-tests/t1/ext
[INF]      [copy] Copying 89 files to /work/www/extjs-tests/t1/ext/src/ux
[INF] [propertyfile] Updating property file: /work/www/extjs-tests/t1/.sencha/workspace/sencha.cfg
[INF]
[INF] copy-framework-to-workspace:
[INF]
[INF] generate-workspace:
[INF]
[INF] -after-generate-workspace:
[INF]
[INF] init-plugin:
[INF]
[INF] cmd-root-plugin.init-properties:
[INF]
[INF] init-properties:
[INF]
[INF] init-sencha-command:
[INF]
[INF] init:
[INF]
[INF] before-upgrade:
[INF]
[INF] generate-app-impl:
[INF]
[INF] generate-starter-app:
[INF]     [mkdir] Created dir: /work/www/extjs-tests/t1/resources
[INF]     [mkdir] Created dir: /work/www/extjs-tests/t1/overrides
[INF]     [mkdir] Created dir: /work/www/extjs-tests/t1/sass/src
[INF]     [mkdir] Created dir: /work/www/extjs-tests/t1/sass/var
[INF]     [mkdir] Created dir: /work/www/extjs-tests/t1/sass/etc
[INF] [x-property-file] Updating property file: /work/www/extjs-tests/t1/.sencha/app/sencha.cfg
[INF]
[INF] after-upgrade:
[INF] Saving certificate as /work/devtools/Sencha/Cmd/repo/pkgs/cert.json
[INF] Saving private key as /work/devtools/Sencha/Cmd/repo/.sencha/repo/private-key.json
[INF]
[INF] init-plugin:
[INF]
[INF] cmd-root-plugin.init-properties:
[INF]
[INF] init-properties:
[INF]
[INF] init-sencha-command:
[INF]
[INF] init:
[INF]
[INF] app-refresh:
[INF]      [echo] Refreshing app at /work/www/extjs-tests/t1
[INF]
[INF] app-refresh-impl:
[INF]
[INF] -before-init-local:
[INF]
[INF] -init-local:
[INF]
[INF] -after-init-local:
[INF]
[INF] init-local:
[INF]
[INF] find-cmd-in-path:
[INF]
[INF] find-cmd-in-environment:
[INF]
[INF] find-cmd-in-shell:
[INF]
[INF] init-cmd:
[INF]      [echo] Using Sencha Cmd from /work/devtools/Sencha/Cmd/4.0.4.84 for /work/www/extjs-tests/t1/build.xml
[INF]
[INF] -before-init:
[INF]
[INF] -init:
[INF] Initializing Sencha Cmd ant environment
[INF] Adding antlib taskdef for com/sencha/command/compass/ant/antlib.xml
[INF]
[INF] -after-init:
[INF]
[INF] -before-init-defaults:
[INF]
[INF] -init-defaults:
[INF]
[INF] -after-init-defaults:
[INF]
[INF] -init-compiler:
[INF]
[INF] init:
[INF]
[INF] refresh:
[INF]
[INF] -before-refresh:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF]
[INF] -detect-app-build-properties:
[INF] Loading app json manifest...
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-base/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-base/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-neutral/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-neutral/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-classic/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-classic/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/app
[INF] Loading classpath entry /work/www/extjs-tests/t1/app.js
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/app
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/app
[INF] Concatenating output to file /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/cmd-packages.js
[INF] Adding external reference : @full-page =&gt; @overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/cmd-packages.js
[INF] Adding external reference : Ext.util.Observable =&gt; /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/cmd-packages.js
[INF]
[INF] -refresh-app:
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending content to /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending content to /work/www/extjs-tests/t1/bootstrap.json
[INF]
[INF] -refresh:
[INF]
[INF] -after-refresh:
[INF]
[INF] after-upgrade:
[INF]
[INF] generate-app:
[INF]
[INF] -after-generate-app:
[INF] [x-property-file] Updating property file: /work/www/extjs-tests/t1/.sencha/app/sencha.cfg
</pre>

<h4 id="id8e0671">生成されたファイル・ディレクトリの★★ポイント★★</h4>

<p class="paragraph">
上記コマンドで &quot;t1&quot; というディレクトリが作成され、その中にアプリのソースツリーが生成されます。以降、本記事では &quot;/work/www/extjs-tests/t1&quot; ディレクトリを、&quot;.sencha/app/sencha.cfg&quot; 中の記述に従い &quot;${app.dir}&quot; と表記します。
<br />
</p>

<p class="paragraph">
&quot;${app.dir}&quot; 直下のファイル・ディレクトリ構成は以下のようになっています。
<br />
</p>
<pre class="plugin_pre">
.sencha/
app/
app.js
app.json
bootstrap.css
bootstrap.js
bootstrap.json
build/
build.xml
ext/
index.html
overrides/
packages/
Readme.md
resources/
sass/
</pre>

<p class="paragraph">
これらの主なディレクトリ構成については公式ドキュメントにも記載があります。ここでは、本記事の内容に関連していたり、開発者が編集して良いのか / 編集してはいけないのか、について以下のように紹介します。
<br />
</p>

<table>
	<tr>
		<th>${app.dir}以下</th>
		<th>編集可不可</th>
		<th>説明</th>
	</tr>
	<tr>
		<td>.sencha/app/sencha.cfg </td>
		<td> 編集可 </td>
		<td> Sencha Cmdが使用する主な設定ファイル </td>
	</tr>
	<tr>
		<td> .sencha/app/codegen.json </td>
		<td> 不明 </td>
		<td> &quot;sencha generate&quot; で生成したファイルのメタ情報をトラッキングしている。 </td>
	</tr>
	<tr>
		<td> index.html </td>
		<td> 編集可 </td>
		<td> エントリーポイントで、ファイル名は app.json で変更可能。 <br /> 特殊なコメントブロックを埋め込むことで、ビルド時に最終的なjsやcssを参照するように書き換えられる。 </td>
	</tr>
	<tr>
		<td> app.js </td>
		<td> 編集可 </td>
		<td> index.html から参照され、&quot;Ext.application()&quot; を呼び出している。 </td>
	</tr>
	<tr>
		<td> app.json </td>
		<td> 編集可 </td>
		<td> Sencha Cmd が参照するアプリの設定ファイル。最終的なHTML + JavaScriptアプリには含まれない。 </td>
	</tr>
	<tr>
		<td> bootstrap.css </td>
		<td> 編集不可 </td>
		<td> index.html から参照され、テーマのCSSファイルを &quot;@import&quot; により取り込んでいる。 <br /> 後述するが、直前にビルドされたテーマのCSSへの相対パスに自動的に置換されるため、編集不可。 </td>
	</tr>
	<tr>
		<td> bootstrap.js </td>
		<td> 編集不可 </td>
		<td> index.html から参照され、ExtJSに含まれているクラス名や、アプリが使うクラス名などの一覧と自動ロードのJSが含まれている。 <br /> &quot;sencha app refresh&quot; により自動生成される。 <br /> 最終的なビルド出力には、このファイルは含まれない。 </td>
	</tr>
</table>

<ul><li> 上記で &quot;編集不可&quot; と記載したのは、ファイル中に &quot;should NOT be edited&quot; とあったファイルになります。</li>
<li> &quot;編集可&quot; と記載したファイルについても、将来のアップグレード時の注意点などがコメントで書かれてたりするので、詳細は自分で確認してみてください。</li>
<li> codegen.jsonについてですが、後述しますがフォーマット自体は普通のJSONファイルなので、&quot;sencha generate&quot; で名前を間違って指定してしまった場合など、ある程度開発者による手動調整は受け付けてくれていると思われます。</li></ul>

<h4 id="id9295f4">★★ポイント★★ : ext/ext-xxxx.js のバリエーションについて</h4>

<p class="paragraph">
&quot;${app.dir}/ext&quot; ディレクトリの下には、ExtJSの本体ファイルが入ってます。 ただし、似たような名前のJSファイルがいくつかあり、混乱します。
<br />
</p>
<pre>ファイル名構成：
&quot;ext&quot; + 内容種類 + ビルド種類 + &quot;.js&quot;
</pre>

<p class="paragraph">
&quot;内容種類&quot;
<br />
</p>
<ol><li> 無印(ext.js, ext-debug.js など) : ExtJSクラスシステムとLoader、最低限度のコンポーネント。index.htmlではデフォルトでこれの&quot;-dev&quot;バージョン、ext-dev.js を参照している。</li>
<li> &quot;-all&quot; : 全部入り。ExtJSを単体で使うぶんにはこれでも良い。ただしRight To Leftのコンポーネントは含まれない。</li>
<li> &quot;-all-rtl&quot; : 4.2で追加された、Right To Left のコンポーネントを含む全部入り。</li></ol>

<p class="paragraph">
&quot;ビルド種類&quot;
<br />
</p>
<ol><li> 無印(ext.js, ext-all.js など) : minifyされたバージョン。リリース環境向け。</li>
<li> &quot;-debug&quot; : minifyされていないが、ドキュメントやコメントも削除されたバージョン。</li>
<li> &quot;-debug-w-comments&quot; : minifyされておらず、ドキュメントやコメントも残っているバージョン。</li>
<li> &quot;-dev&quot; : &quot;-debug-w-comments&quot; に加え、deprecatedなAPIを使った場合などにJSコンソールにwarningログを出してくれる。</li></ol>

<p class="paragraph">
Right To Leftを考慮しなければ、開発時にはext-all-dev.jsを使い、リリースにはext-all.jsを使えば良いと思われます。
<br />
</p>

<p class="paragraph">
ただし、Sencha Cmdで生成したアプリの場合、基本的には最終的に app.js にExtのコンポーネントやアプリで開発したファイルがすべて統合されてしまいますので、あまりこのへんの事は気にする必要はありません。
<br />
</p>

<p class="paragraph">
とはいえ、&quot;sencha generate app&quot; が生成したデフォルトのindex.htmlでは ext-dev.js を使っているため、コンポーネントを一個ずつ個別にロードする事となり非常に遅いです。後述しますが、ext-all-dev.js を使うように調整することは可能なので、その辺は随時、実験して見て下さい。
<br />
</p>

<p class="paragraph">
参考：
<br />
</p>
<ul><li> extjs - ext-all-debug.js vs ext-all-dev.js - Stack Overflow<ul><li> <a class="externallink" href="http://stackoverflow.com/questions/22164500/ext-all-debug-js-vs-ext-all-dev-js" target="_blank">http://stackoverflow.com/questions/22164500/ext-all-debug-js-vs-ext-all-dev-js</a></li></ul></li>
<li> Ext JS 4.2 Betaが利用できるようになりました。 | 株式会社ゼノフィ<ul><li> <a class="externallink" href="http://www.xenophy.com/javascript/5148" target="_blank">http://www.xenophy.com/javascript/5148</a><ul><li> Right To Left コンポーネントの追加について記載されてます。</li></ul></li></ul></li></ul>

<h4 id="id91ce83">生成されたファイル・ディレクトリの中身を見てみる（抜粋）</h4>

<p class="paragraph">
いくつか、生成されたファイル・ディレクトリの中身を見てみます。
<br />
</p>

<h5 id="id2aa5e9">&quot;app&quot; ディレクトリ</h5>

<p class="paragraph">
ExtJS MVCアプリケーションのソースの置き場所となります。簡単なスケルトンソースが生成されています。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ tree app
app
├── Application.js
├── controller
│   ├── Main.js
│   └── Readme.md
├── model
│   └── Readme.md
├── Readme.md
├── store
│   └── Readme.md
└── view
    ├── Main.js
    ├── Readme.md
    └── Viewport.js
</pre>

<h5 id="idd874df">&quot;sass&quot; ディレクトリ</h5>

<p class="paragraph">
まだテーマ関連調べてないのでわからないんですが、多分テーマ関連じゃないかなーと・・・
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ tree sass/
sass/
├── config.rb
├── etc
├── example
│   ├── bootstrap.css
│   ├── custom.js
│   ├── render.js
│   └── theme.html
├── src
└── var
</pre>

<h5 id="id821a6c">index.html</h5>

<p class="paragraph">
&quot;&lt;x-compile&gt;&quot; や &quot;&lt;x-bootstrap&gt;&quot; など、senchaのビルドシステムが自動で参照・置換するブロックが埋め込まれています。この状態のindex.htmlを参照しても、app.jsやboostrap.css, bootstrap.jsが適切に調整されているおかげで、ちゃんと動作します。
<br />
</p>

<div class="hl-main"><pre><span class="hl-brackets">&lt;</span><span class="hl-code">!</span><span class="hl-var">DOCTYPE</span><span class="hl-code"> </span><span class="hl-var">HTML</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">meta</span><span class="hl-code"> </span><span class="hl-var">charset</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">UTF-8</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">MyApp</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;x-compile&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
        </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;x-bootstrap&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
            </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">link</span><span class="hl-code"> </span><span class="hl-var">rel</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">stylesheet</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">href</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">bootstrap.css</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
            </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">ext/ext-dev.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
            </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">bootstrap.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
        </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;/x-bootstrap&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
        </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">app.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;/x-compile&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span></pre></div>

<h5 id="idb1afc5">app.json</h5>

<p class="paragraph">
sencha のビルドシステムが参照する設定ファイルですので、アプリの動作には関連しません。Senchaのpackageシステムの設定などが入ってくるようです。
<br />
</p>
<pre class="plugin_pre">
{
    &quot;name&quot;: &quot;MyApp&quot;,

    &quot;requires&quot;: [
    ],

    &quot;id&quot;: &quot;97333d8b-3cca-4f30-aa90-d40a2910b45e&quot;
}
</pre>

<h5 id="id5b6e2b">app.js</h5>

<p class="paragraph">
&quot;Ext.application()&quot;を呼び出すjsファイルになっています。ただ、これの実体は&quot;extend&quot;にも指定されている &quot;${app.dir}/app/Application.js&quot; になりますので、細かい実体はそちらで作りこんでくのだと思われます。
<br />
なお、autoCreateViewportがtrueになってますので、 &quot;${app.dir}/app/view/Viewport.js&quot; が自動的に読み込まれ、スケルトンの画面を表示する仕組みになってます。
<br />
</p>
<pre class="plugin_pre">
/*
    This file is generated and updated by Sencha Cmd. You can edit this file as
    needed for your application, but these edits will have to be merged by
    Sencha Cmd when upgrading.
*/

Ext.application({
    name: &#039;MyApp&#039;,

    extend: &#039;MyApp.Application&#039;,

    autoCreateViewport: true
});
</pre>

<h5 id="id1a3b99">${app.dir}/app/Application.js</h5>

<p class="paragraph">
特に何もない、スケルトンのクラスファイルになってます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ more app/Application.js
Ext.define(&#039;MyApp.Application&#039;, {
    name: &#039;MyApp&#039;,

    extend: &#039;Ext.app.Application&#039;,

    views: [
        // TODO: add views here
    ],

    controllers: [
        // TODO: add controllers here
    ],

    stores: [
        // TODO: add stores here
    ]
});
</pre>

<h5 id="id555a24">bootstrap.js</h5>

<p class="paragraph">
このファイルはSencha Cmdが自動生成するので、編集不可のようです。MVCのJSファイルを追加した後 &quot;sencha app refresh&quot; すると、ディレクトリをスキャンして自動的に追加してくれます。
<br />
</p>

<pre class="plugin_pre">
/**
 * This file is generated by Sencha Cmd and should NOT be edited.  It is
 * provided to support globbing requires, custom xtypes, and other
 * metadata-driven class system features
 */
Ext.Loader.addClassPathMappings({
  &quot;Ext&quot;: &quot;ext/src&quot;,
  &quot;Ext.Msg&quot;: &quot;ext/src/window/MessageBox.js&quot;,
  &quot;Ext.rtl.EventObjectImpl&quot;: &quot;ext/src/rtl/EventObject.js&quot;,
  &quot;MyApp&quot;: &quot;app&quot;
});
Ext.ClassManager.addNameAlternateMappings({
  &quot;Ext.AbstractComponent&quot;: [],
  &quot;Ext.AbstractManager&quot;: [],
  &quot;Ext.AbstractPlugin&quot;: [],
  &quot;Ext.Action&quot;: [],
  &quot;Ext.Ajax&quot;: [],
  &quot;Ext.Component&quot;: [],
  &quot;Ext.ComponentLoader&quot;: [],
  &quot;Ext.ComponentManager&quot;: [
    &quot;Ext.ComponentMgr&quot;
  ],
...
  &quot;Ext.window.Window&quot;: [
    &quot;widget.window&quot;
  ],
  &quot;MyApp.Application&quot;: [],
  &quot;MyApp.controller.Main&quot;: [],
  &quot;MyApp.view.Main&quot;: [
    &quot;widget.app-main&quot;
  ],
  &quot;MyApp.view.Viewport&quot;: []
});
Ext.setVersion(&quot;ext-theme-base&quot;, &quot;4.2.1&quot;);
Ext.setVersion(&quot;ext-theme-classic&quot;, &quot;4.2.1&quot;);
Ext.setVersion(&quot;ext-theme-neutral&quot;, &quot;4.2.1&quot;);
...
</pre>

<h5 id="id2ceaae">bootstrap.json</h5>

<p class="paragraph">
これもsenchaのビルドシステムが参照する設定ファイルのようで、こちらは編集不可のようです。カスタマイズはapp.jsonに書いてね、というコメントが入ってます。
<br />
</p>
<pre class="plugin_pre">
/**
 * This file is generated by Sencha Cmd and should NOT be edited. It is a
 * combination of content from app.json, and all required package&#039;s package.json
 * files.  Customizations should be placed in app.json.
 */
{&quot;id&quot;:&quot;97333d8b-3cca-4f30-aa90-d40a2910b45e&quot;,&quot;js&quot;:[],&quot;css&quot;:[]}
</pre>

<h5 id="id8f0d97">bootstrap.css</h5>

<p class="paragraph">
index.htmlから参照されています。生成直後では &quot;ext/packages/&quot; の下のテーマファイルのcssを参照しています。
<br />
後述しますが、最後にビルドしたCSSファイルを参照するよう自動的に置換されますので、編集不可と考えられます。
<br />
</p>
<pre class="plugin_pre">
/**
 * This file is generated by Sencha Cmd and should NOT be edited.  It will
 * redirect to the most recently built css file for the application to
 * support development time inspection of css output.
 */
@import &#039;ext/packages/ext-theme-classic/build/resources/ext-theme-classic-all.css&#039;;
</pre>

<h5 id="id63f676">.sencha/app/sencha.cfg</h5>

<p class="paragraph">
Sencha CmdはAntを使ってまして、それが参照するプロパティファイルとなってます。Antの設定ファイルらしく、&quot;${...}&quot; による設定値の置換が使われてます。
<br />
</p>
<pre class="plugin_pre">
# The name of the application
app.name=MyApp

# The name of the framework used by the application (ext / touch)
app.framework=ext

# The path(s) to application javascript sources (comma separated)
app.classpath=${app.dir}/app,${app.dir}/app.js

# Output location for application build artifacts
app.build.dir=${workspace.build.dir}/${app.name}

# The root namespace to use when mapping scss resources to js classes
# in the sass/src and sass/var directories
app.sass.namespace=MyApp

# Path to sass rule definition files corresponding to JavaScript classes.
app.sass.srcpath=${app.dir}/sass/src

# Path to sass variable definition files corresponding to JavaScript classes.
app.sass.varpath=${app.dir}/sass/var

# Path to sass function and mixin files.
app.sass.etcpath=${app.dir}/sass/etc/all.scss

# Path to extra ruby files to include into the generated sass config.rb,
# &lt;approot&gt;/sass/config.rb will be included automatically if present and does
# not need to be specified.
# app.sass.rubypath=

# The name of the package containing the theme scss for the app
app.theme=ext-theme-classic

# This property can be modified to change the input and output page file
# used in the compile command. (eg: index.aspx, index.jsp ... )
app.page.name=index.html

# the input page file
app.page.file=${app.dir}/${app.page.name}

# this property specifies a comma separated list of paths containing
# resources to copy to the build directory
app.resource.paths=${app.dir}/resources

#==============================================================================
# Custom Properties - Place customizations below this line to avoid merge
# conflicts with newer versions

app.framework.version=4.2.1.883
app.cmd.version=4.0.4.84
</pre>

<h5 id="idc6efc6">.sencha/workspace/sencha.cfg</h5>

<p class="paragraph">
こちらは、workspaceという単位での設定ファイルになります。今回は特にworkspaceについては採り上げません。
<br />
</p>
<pre class="plugin_pre">
#Sat, 31 May 2014 15:28:13 +0900
# -----------------------------------------------------------------------------
# This file contains configuration options that apply to all applications in
# the workspace. By convention, these options start with &quot;workspace.&quot; but any
# option can be set here. Options specified in an application&#039;s sencha.cfg will
# take priority over those values contained in this file. These options will
# take priority over configuration values in Sencha Cmd or a framework plugin.

# -----------------------------------------------------------------------------
# This configuration property (if set) is included by default in all compile
# commands executed according to this formulation:
#
#   sencha compile -classpath=...,${framework.classpath},${workspace.classpath},${app.classpath}

#workspace.classpath=

#------------------------------------------------------------------------------
# This is the folder for build outputs in the workspace

workspace.build.dir=${workspace.dir}/build

#------------------------------------------------------------------------------
# This folder contains all generated and extracted packages.

workspace.packages.dir=${workspace.dir}/packages

workspace.theme.dir=${workspace.packages.dir}/${args.themeName}

# =============================================================================
# Customizations go below this divider to avoid merge conflicts on upgrade
# =============================================================================

workspace.cmd.version=4.0.4.84

ext.dir=${workspace.dir}/ext
</pre>

<h3 id="idd49242">Sencha Cmd でアプリをビルドしてみる (sencha app build)</h3>

<p class="paragraph">
アプリの生成が終わりましたので、実際にビルドしてみます。
<br />
ここで、ExtJSのドキュメントの &quot;Getting Started with ExtJS 4&quot; にあるように、&quot;${app.dir}/app/Application.js&quot; を以下のように、launch()でViewportを直接生成し、HTMLをベタ書きして終わるだけの形にしておきます。（単純化して、すぐに確認できる状態にしておきます。）
<br />
</p>

<p class="paragraph">
${app.dir}/app/Application.js:
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">MyApp.Application</span><span class="hl-quotes">'</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">MyApp</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.app.Application</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-identifier">launch</span><span class="hl-code">: </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">create</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">Ext.container.Viewport</span><span class="hl-quotes">'</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">layout</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">fit</span><span class="hl-quotes">'</span><span class="hl-code">,
            </span><span class="hl-identifier">items</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
                </span><span class="hl-brackets">{</span><span class="hl-code">
                    </span><span class="hl-identifier">title</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Hello Ext</span><span class="hl-quotes">'</span><span class="hl-code">,
                    </span><span class="hl-identifier">html</span><span class="hl-code"> : </span><span class="hl-quotes">'</span><span class="hl-string">Hello! Welcome to Ext JS.</span><span class="hl-quotes">'</span><span class="hl-code">
                </span><span class="hl-brackets">}</span><span class="hl-code">
            </span><span class="hl-brackets">]</span><span class="hl-code">
        </span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<h4 id="id40944f">ビルドする前に、index.htmlで動作を確認してみる。(sencha web start/stop)</h4>

<p class="paragraph">
ローカルで簡単にWebサーバを立ちあげたい場合に、&quot;sencha web start&quot; で簡単に「コマンド実行時のカレントディレクトリを」DocumentRootとしてWebサーバを起動できます。実体はJettyを使っているようです。
<br />
デフォルトではTCPポート番号1841番をlistenします。
<br />
</p>

<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha web start
Sencha Cmd v4.0.4.84
[INF] Starting shutdown listener socket
[INF] Listening for stop requests on: 56801
[INF] Mapping http://localhost:1841/ to ....
[INF] Starting http://localhost:1841
[INF] jetty-8.1.7.v20120910
[INF] NO JSP Support for /, did not find org.apache.jasper.servlet.JspServlet
[INF] started o.e.j.w.WebAppContext{/,file:/work/www/extjs-tests/t1/}
[INF] started o.e.j.w.WebAppContext{/,file:/work/www/extjs-tests/t1/}
[INF] Started SelectChannelConnector@0.0.0.0:1841
</pre>

<p class="paragraph">
実際にアクセスしてみると、以下のように Application.js に書いたとおりに表示されました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-01.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-01.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
また、Firefox29の開発ツールの&quot;ネットワーク&quot;で通信状況を確認すると、以下のようにコンポーネントが１つずつ、ロードされていました。このため、表示されるまでに数十秒以上待たされます。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-02.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-02.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
起動したWebサーバを停止するには、Ctrl-Cで強制終了するか、別のターミナルを開いて &quot;sencha web stop&quot; を実行します。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha web stop
Sencha Cmd v4.0.4.84
[INF] Contacting http://localhost:1841/.stop for shutdown port
[INF] Shutdown port is 56801

[INF] Sending shutdown
[INF] Shutdown away
</pre>

<h4 id="iddaf04c">ビルドしてみる : sencha app build, sencha app build testing</h4>

<p class="paragraph">
ではビルドしてみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha app build
Sencha Cmd v4.0.4.84
[INF]
[INF] init-plugin:
[INF]
[INF] cmd-root-plugin.init-properties:
[INF]
[INF] init-properties:
[INF]
[INF] init-sencha-command:
[INF]
[INF] init:
[INF]
[INF] app-build-impl:
[INF]
[INF] -before-init-local:
[INF]
[INF] -init-local:
[INF]
[INF] -after-init-local:
[INF]
[INF] init-local:
[INF]
[INF] find-cmd-in-path:
[INF]
[INF] find-cmd-in-environment:
[INF]
[INF] find-cmd-in-shell:
[INF]
[INF] init-cmd:
[INF]      [echo] Using Sencha Cmd from /work/devtools/Sencha/Cmd/4.0.4.84 for /work/www/extjs-tests/t1/build.xml
[INF]
[INF] -before-init:
[INF]
[INF] -init:
[INF] Initializing Sencha Cmd ant environment
[INF] Adding antlib taskdef for com/sencha/command/compass/ant/antlib.xml
[INF]
[INF] -after-init:
[INF]
[INF] -before-init-defaults:
[INF]
[INF] -init-defaults:
[INF]
[INF] -after-init-defaults:
[INF]
[INF] -init-compiler:
[INF]
[INF] init:
[INF]
[INF] -before-build:
[INF]
[INF] refresh:
[INF]
[INF] -before-refresh:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -detect-app-build-properties:
[INF] Loading app json manifest...
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-base/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-base/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-neutral/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-neutral/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-classic/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-classic/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/app
[INF] Loading classpath entry /work/www/extjs-tests/t1/app.js
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/app
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/app
[INF] Concatenating output to file /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/cmd-packages.js
[INF] Adding external reference : @full-page =&gt; @overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/cmd-packages.js
[INF] Adding external reference : Ext.util.Observable =&gt; /work/www/extjs-tests/t1/build/temp/production/MyApp/sencha-compiler/cmd-packages.js
[INF]
[INF] -refresh-app:
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending content to /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending content to /work/www/extjs-tests/t1/bootstrap.json
[INF]
[INF] -refresh:
[INF]
[INF] -after-refresh:
[INF]
[INF] resolve:
[INF]
[INF] js:
[INF]
[INF] -before-js:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -detect-app-build-properties:
[INF]
[INF] -compile-js:
[INF] Loading classpath entry /work/devtools/Sencha/Cmd/4.0.4.84/plugins/src
[INF] Loading classpath entry /work/devtools/Sencha/Cmd/4.0.4.84/plugins/ext/src
[INF] Loading classpath entry /work/devtools/Sencha/Cmd/4.0.4.84/plugins/ext/4.2/src
[INF] Building optimized concatenated output..
[INF] Compressing data with YuiJavascriptCompressor
[INF] Concatenating output to file /work/www/extjs-tests/t1/build/production/MyApp/app.js
[INF]
[INF] -js:
[INF]
[INF] -after-js:
[INF]
[INF] resources:
[INF]
[INF] -before-resources:
[INF]
[INF] -before-inherit-resources:
[INF]
[INF] -before-copy-resources:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -resources:
[INF] merging resources into /work/www/extjs-tests/t1/build/production/MyApp/resources
[INF] merged 224 resources into /work/www/extjs-tests/t1/build/production/MyApp/resources
[INF] merging resources into /work/www/extjs-tests/t1/build/production/MyApp
[INF] merged 0 resources into /work/www/extjs-tests/t1/build/production/MyApp
[INF]
[INF] -after-copy-resources:
[INF]
[INF] -after-inherit-resources:
[INF]
[INF] -after-resources:
[INF]
[INF] sass:
[INF]
[INF] -before-sass:
[INF]
[INF] -compass-compile-theme-package:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -compile-sass:
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/sass/MyApp-all.scss
[INF] appending sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/sass/MyApp-all.scss
[INF] appending sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/sass/MyApp-all.scss
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/sass/config.rb
[INF] executing compass using system installed ruby runtime
   create MyApp-all.css
[INF]      [echo] Compressing /work/www/extjs-tests/t1/build/production/MyApp/resources/MyApp-all.css to /work/www/extjs-tests/t1/build/production/MyApp/resources/MyApp-all.css
[INF] srcfile: /work/www/extjs-tests/t1/build/production/MyApp/resources/MyApp-all.css (494740 bytes)
[INF] outfile: /work/www/extjs-tests/t1/build/production/MyApp/resources/MyApp-all.css
[INF] Compressed size 209018 bytes. Saved 285722 bytes (57 %)
[INF]
[INF] -compass-compile-theme-folders:
[INF]
[INF] -compass-compile-sass-dir:
[INF]
[INF] -compass-compile:
[INF]
[INF] -sass:
[INF]
[INF] -after-sass:
[INF]
[INF] slice:
[INF]
[INF] -before-slice:
[INF]
[INF] -slice-images:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -detect-app-build-properties:
[INF]
[INF] -slice-app-theme:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -compile-slicer-sass:
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/slicer-temp/MyApp-example.scss
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/slicer-temp/config.rb
[INF]
[INF] -compass-compile-slicer-css:
[INF] executing compass using system installed ruby runtime
   create MyApp-example.css
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF]      [echo] Capture theme image to /work/www/extjs-tests/t1/build/temp/production/MyApp/slicer-temp/theme-capture.png
[INF] Capturing theme image
[INF] /work/devtools/Sencha/Cmd/4.0.4.84/phantomjs/phantomjs: error while loading shared libraries: libfontconfig.so.1: cannot open shared object file: No such file or directory

[ERR]
[ERR] BUILD FAILED
[ERR] com.sencha.exceptions.ExProcess: phantomjs process exited with code 127
[ERR]   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMetho
[ERR] dAccessorImpl.java:57)
[ERR]
[ERR] Total time: 45 seconds
[ERR] The following error occurred while executing this line:
/work/www/extjs-tests/t1/.sencha/app/build-impl.xml:321: The following error occurred while executing this line:
/work/www/extjs-tests/t1/.sencha/app/slice-impl.xml:208: The following error occurred while executing this line:
/work/www/extjs-tests/t1/.sencha/app/slice-impl.xml:209: The following error occurred while executing this line:
/work/www/extjs-tests/t1/.sencha/app/slice-impl.xml:80: com.sencha.exceptions.ExProcess: phantomjs process exited with code 127
</pre>
<p class="paragraph">
ちょっと途中でエラーが発生して止まってしまいました。
<br />
画像スライスを生成するところで、ヘッドレスブラウザのライブラリであるphantomjsを起動しているようですが、そこでlibfontconfigライブラリが見つからず失敗しているようです。
<br />
</p>

<h4 id="idbf336a">ビルド途中の&quot;phantomjs: error while loading shared libraries: libfontconfig.so.1: cannot open shared object file: No such file or directory&quot;</h4>

<p class="paragraph">
これについては、既に以下のGitHub上のissueで解決策が提示されています。
<br />
</p>
<ul><li> phantomjs has a secret dependency (documentation error) · Issue #10904 · ariya/phantomjs<ul><li> <a class="externallink" href="https://github.com/ariya/phantomjs/issues/10904" target="_blank">https://github.com/ariya/phantomjs/issues/10904</a></li></ul></li></ul>

<p class="paragraph">
ubuntu12の場合なら、libfontconfigをインストールするだけでOKでした。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sudo apt-get install libfontconfig
Reading package lists... Done
Building dependency tree
Reading state information... Done
Note, selecting &#039;libfontconfig1&#039; instead of &#039;libfontconfig&#039;
The following extra packages will be installed:
  fontconfig-config ttf-dejavu-core
The following NEW packages will be installed:
  fontconfig-config libfontconfig1 ttf-dejavu-core
0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.
Need to get 1,721 kB of archives.
After this operation, 3,610 kB of additional disk space will be used.
Do you want to continue [Y/n]? y
Get:1 http://jp.archive.ubuntu.com/ubuntu/ precise/main ttf-dejavu-core all 2.33-2ubuntu1 [1,552 kB]
Get:2 http://jp.archive.ubuntu.com/ubuntu/ precise-updates/main fontconfig-config all 2.8.0-3ubuntu9.1 [44.4 kB]
Get:3 http://jp.archive.ubuntu.com/ubuntu/ precise-updates/main libfontconfig1 amd64 2.8.0-3ubuntu9.1 [125 kB]
Fetched 1,721 kB in 0s (1,895 kB/s)
Selecting previously unselected package ttf-dejavu-core.
(Reading database ... 93766 files and directories currently installed.)
Unpacking ttf-dejavu-core (from .../ttf-dejavu-core_2.33-2ubuntu1_all.deb) ...
Selecting previously unselected package fontconfig-config.
Unpacking fontconfig-config (from .../fontconfig-config_2.8.0-3ubuntu9.1_all.deb) ...
Selecting previously unselected package libfontconfig1.
Unpacking libfontconfig1 (from .../libfontconfig1_2.8.0-3ubuntu9.1_amd64.deb) ...
Processing triggers for man-db ...
Setting up ttf-dejavu-core (2.33-2ubuntu1) ...
Setting up fontconfig-config (2.8.0-3ubuntu9.1) ...
Setting up libfontconfig1 (2.8.0-3ubuntu9.1) ...
Processing triggers for libc-bin ...
ldconfig deferred processing now taking place
</pre>

<p class="paragraph">
もう一度ビルドに挑戦してみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha app build
Sencha Cmd v4.0.4.84
[INF]
...
[INF] -init-compiler:
[INF]
[INF] -compile-slicer-sass:
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/production/MyApp/slicer-temp/MyApp-example.scss
[INF]
[INF] -compass-compile-slicer-css:
[INF] executing compass using system installed ruby runtime
identical MyApp-example.css
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF]      [echo] Capture theme image to /work/www/extjs-tests/t1/build/temp/production/MyApp/slicer-temp/theme-capture.png
[INF] Capturing theme image
[INF] loading page /work/www/extjs-tests/t1/sass/example/theme.html
Capturing screenshot
Saving slicer widget manifest
Capture complete

[INF] Capture complete
[INF]      [echo] Slicing theme images to /work/www/extjs-tests/t1/build/production/MyApp/resources
[INF] Slicing images...
[WRN] Widget tab-1063 : TOP has images/tab/tab-default-top-active-bg.gif gradient but no stretch specified
[WRN] Widget tab-1064 : TOP has images/tab/tab-default-top-over-bg.gif gradient but no stretch specified
[WRN] Widget tab-1065 : TOP has images/tab/tab-default-top-disabled-bg.gif gradient but no stretch specified
[WRN] Widget tab-1067 : TOP has images/tab/tab-default-bottom-active-bg.gif gradient but no stretch specified
[WRN] Widget tab-1068 : TOP has images/tab/tab-default-bottom-over-bg.gif gradient but no stretch specified
[WRN] Widget tab-1069 : TOP has images/tab/tab-default-bottom-disabled-bg.gif gradient but no stretch specified
[WRN] Widget progressbar-1074-bar : TOP has images/progress/progress-default-bg.gif gradient but no stretch specified
[WRN] Widget ext-gen1356 : TOP has images/datepicker/datepicker-header-bg.gif gradient but no stretch specified
[WRN] Widget datepicker-1106-footerEl : TOP has images/datepicker/datepicker-footer-bg.gif gradient but no stretch specified
[INF] Slicing complete - generated 235 images
[INF]
[INF] -slice:
[INF]
[INF] -after-slice:
[INF]
[INF] page:
[INF]
[INF] -before-page:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -copy-app-resources:
[INF]
[INF] -generate-deltas:
[INF]
[INF] -detect-app-build-properties:
[INF]
[INF] -build-standalone-json-manifest:
[INF]
[INF] -build-output-page:
[INF]
[INF] -build-output-markup-page:
[INF] Building output markup to /work/www/extjs-tests/t1/build/production/MyApp/index.html
[INF]
[INF] -generate-cache-manifest:
[INF]
[INF] -page:
[INF]
[INF] -after-page:
[INF]
[INF] native-package:
[INF]
[INF] -build:
[INF]
[INF] -after-build:
[INF]
[INF] build:
[INF]
[INF] app-build:
</pre>

<p class="paragraph">
成功しました。
<br />
</p>

<h4 id="id1070d5">ビルド成果物の確認(production)</h4>

<p class="paragraph">
&quot;sencha app build&quot; では、デフォルトでは&quot;production&quot;モードでビルドされます。
<br />
最終的なビルド成果物は &quot;${app.dir}/build/production&quot; ディレクトリに生成されます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ tree build
build
├── production
│   └── MyApp
│       ├── app.js
│       ├── index.html
│       └── resources
│           ├── images   ... ext-theme-classic/images 以下がコピーされてる。
...
│           ├── MyApp-all.css
│           └── Readme.md
└── temp
    └── production
        └── MyApp
            ├── sass
            │   ├── config.rb
            │   └── MyApp-all.scss
            ├── sencha-compiler
            │   ├── app
            │   │   └── full-page-master-bundle.js
            │   └── cmd-packages.js
            └── slicer-temp
                ├── config.rb
                ├── MyApp-example.css
                ├── MyApp-example.scss
                ├── theme-capture.json
                └── theme-capture.png
</pre>

<p class="paragraph">
index.htmlは以下のようになり、cssとjsのロード部分が最終的なcssとjsを参照するよう、ビルドシステムにより置換されています。
<br />
</p>

<p class="paragraph">
${app.dir}/build/production/MyApp/index.html:
<br />
</p>
<div class="hl-main"><pre><span class="hl-brackets">&lt;</span><span class="hl-code">!</span><span class="hl-var">DOCTYPE</span><span class="hl-code"> </span><span class="hl-var">HTML</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">meta</span><span class="hl-code"> </span><span class="hl-var">charset</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">UTF-8</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">MyApp</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">link</span><span class="hl-code"> </span><span class="hl-var">rel</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">stylesheet</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">href</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">resources/MyApp-all.css</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">/&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">type</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">text/javascript</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">app.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span></pre></div>

<p class="paragraph">
&quot;${app.dir}/build/production/MyApp&quot; ディレクトリに移動して、&quot;sencha web start&quot; でビルド成果物を実際にWebブラウザで動かしてみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ cd build/production/MyApp
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1/build/production/MyApp$ sencha web start
Sencha Cmd v4.0.4.84
[INF] Starting shutdown listener socket
[INF] Listening for stop requests on: 60105
[INF] Mapping http://localhost:1841/ to ....
[INF] Starting http://localhost:1841
[INF] jetty-8.1.7.v20120910
[INF] NO JSP Support for /, did not find org.apache.jasper.servlet.JspServlet
[INF] started o.e.j.w.WebAppContext{/,file:/work/www/extjs-tests/t1/build/production/MyApp/}
[INF] started o.e.j.w.WebAppContext{/,file:/work/www/extjs-tests/t1/build/production/MyApp/}
[INF] Started SelectChannelConnector@0.0.0.0:1841
</pre>

<p class="paragraph">
レンダリングされた画面のスクリーンショットについては、先ほどのindex.htmlと同じなので省略します。
<br />
ここでネットワーク通信状況を見てみますと、以下のようにCSSとJSが一ファイルずつになり、ファイルサイズも通信時間もリリース向けのものとなりました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-03_app_build.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-03_app_build.png" alt="" title=""  /></a>
<br />
</p>

<h4 id="id8f6240">テスト用のビルド (sencha app build testing)</h4>

<p class="paragraph">
&quot;sencha app build&quot; コマンドでは、以下のようにどの環境向けのものかを指定することが出来ます。
<br />
</p>
<pre>sencha app build [production|testing|native|package]
</pre>

<p class="paragraph">
省略時はproductionとなります。
<br />
ここで、testing環境向けにビルドしてみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha app build testing
Sencha Cmd v4.0.4.84
[INF]
[INF] init-plugin:
[INF]
[INF] cmd-root-plugin.init-properties:
[INF]
[INF] init-properties:
[INF]
[INF] init-sencha-command:
[INF]
[INF] init:
[INF]
[INF] app-build-impl:
[INF]
[INF] -before-init-local:
[INF]
[INF] -init-local:
[INF]
[INF] -after-init-local:
[INF]
[INF] init-local:
[INF]
[INF] find-cmd-in-path:
[INF]
[INF] find-cmd-in-environment:
[INF]
[INF] find-cmd-in-shell:
[INF]
[INF] init-cmd:
[INF]      [echo] Using Sencha Cmd from /work/devtools/Sencha/Cmd/4.0.4.84 for /work/www/extjs-tests/t1/build.xml
[INF]
[INF] -before-init:
[INF]
[INF] -init:
[INF] Initializing Sencha Cmd ant environment
[INF] Adding antlib taskdef for com/sencha/command/compass/ant/antlib.xml
[INF]
[INF] -after-init:
[INF]
[INF] -before-init-defaults:
[INF]
[INF] -init-defaults:
[INF]
[INF] -after-init-defaults:
[INF]
[INF] -init-compiler:
[INF]
[INF] init:
[INF]
[INF] -before-build:
[INF]
[INF] refresh:
[INF]
[INF] -before-refresh:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -detect-app-build-properties:
[INF] Loading app json manifest...
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-base/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-base/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-neutral/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-neutral/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-classic/src
[INF] Loading classpath entry /work/www/extjs-tests/t1/ext/packages/ext-theme-classic/overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/app
[INF] Loading classpath entry /work/www/extjs-tests/t1/app.js
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/testing/MyApp/sencha-compiler/app
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/testing/MyApp/sencha-compiler/app
[INF] Concatenating output to file /work/www/extjs-tests/t1/build/temp/testing/MyApp/sencha-compiler/cmd-packages.js
[INF] Adding external reference : @full-page =&gt; @overrides
[INF] Loading classpath entry /work/www/extjs-tests/t1/build/temp/testing/MyApp/sencha-compiler/cmd-packages.js
[INF] Adding external reference : Ext.util.Observable =&gt; /work/www/extjs-tests/t1/build/temp/testing/MyApp/sencha-compiler/cmd-packages.js
[INF]
[INF] -refresh-app:
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending content to /work/www/extjs-tests/t1/bootstrap.js
[INF] Appending content to /work/www/extjs-tests/t1/bootstrap.json
[INF]
[INF] -refresh:
[INF]
[INF] -after-refresh:
[INF]
[INF] resolve:
[INF]
[INF] js:
[INF]
[INF] -before-js:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -detect-app-build-properties:
[INF]
[INF] -compile-js:
[INF] Concatenating output to file /work/www/extjs-tests/t1/build/testing/MyApp/app.js
[INF]
[INF] -js:
[INF]
[INF] -after-js:
[INF]
[INF] resources:
[INF]
[INF] -before-resources:
[INF]
[INF] -before-inherit-resources:
[INF]
[INF] -before-copy-resources:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -resources:
[INF] merging resources into /work/www/extjs-tests/t1/build/testing/MyApp/resources
[INF] merged 224 resources into /work/www/extjs-tests/t1/build/testing/MyApp/resources
[INF] merging resources into /work/www/extjs-tests/t1/build/testing/MyApp
[INF] merged 0 resources into /work/www/extjs-tests/t1/build/testing/MyApp
[INF]
[INF] -after-copy-resources:
[INF]
[INF] -after-inherit-resources:
[INF]
[INF] -after-resources:
[INF]
[INF] sass:
[INF]
[INF] -before-sass:
[INF]
[INF] -compass-compile-theme-package:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -compile-sass:
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/testing/MyApp/sass/MyApp-all.scss
[INF] appending sass content to /work/www/extjs-tests/t1/build/temp/testing/MyApp/sass/MyApp-all.scss
[INF] appending sass content to /work/www/extjs-tests/t1/build/temp/testing/MyApp/sass/MyApp-all.scss
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/testing/MyApp/sass/config.rb
[INF] executing compass using system installed ruby runtime
   create MyApp-all.css
[INF]
[INF] -compass-compile-theme-folders:
[INF]
[INF] -compass-compile-sass-dir:
[INF]
[INF] -compass-compile:
[INF]
[INF] -sass:
[INF]
[INF] -after-sass:
[INF]
[INF] slice:
[INF]
[INF] -before-slice:
[INF]
[INF] -slice-images:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -detect-app-build-properties:
[INF]
[INF] -slice-app-theme:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -compile-slicer-sass:
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/testing/MyApp/slicer-temp/MyApp-example.scss
[INF] writing sass content to /work/www/extjs-tests/t1/build/temp/testing/MyApp/slicer-temp/config.rb
[INF]
[INF] -compass-compile-slicer-css:
[INF] executing compass using system installed ruby runtime
   create MyApp-example.css
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF] Appending concatenated output to file /work/www/extjs-tests/t1/sass/example/bootstrap.js
[INF]      [echo] Capture theme image to /work/www/extjs-tests/t1/build/temp/testing/MyApp/slicer-temp/theme-capture.png
[INF] Capturing theme image
[INF] loading page /work/www/extjs-tests/t1/sass/example/theme.html
Capturing screenshot
Saving slicer widget manifest
Capture complete

[INF] Capture complete
[INF]      [echo] Slicing theme images to /work/www/extjs-tests/t1/build/testing/MyApp/resources
[INF] Slicing images...
[WRN] Widget tab-1063 : TOP has images/tab/tab-default-top-active-bg.gif gradient but no stretch specified
[WRN] Widget tab-1064 : TOP has images/tab/tab-default-top-over-bg.gif gradient but no stretch specified
[WRN] Widget tab-1065 : TOP has images/tab/tab-default-top-disabled-bg.gif gradient but no stretch specified
[WRN] Widget tab-1067 : TOP has images/tab/tab-default-bottom-active-bg.gif gradient but no stretch specified
[WRN] Widget tab-1068 : TOP has images/tab/tab-default-bottom-over-bg.gif gradient but no stretch specified
[WRN] Widget tab-1069 : TOP has images/tab/tab-default-bottom-disabled-bg.gif gradient but no stretch specified
[WRN] Widget progressbar-1074-bar : TOP has images/progress/progress-default-bg.gif gradient but no stretch specified
[WRN] Widget ext-gen1356 : TOP has images/datepicker/datepicker-header-bg.gif gradient but no stretch specified
[WRN] Widget datepicker-1106-footerEl : TOP has images/datepicker/datepicker-footer-bg.gif gradient but no stretch specified
[INF] Slicing complete - generated 235 images
[INF]
[INF] -slice:
[INF]
[INF] -after-slice:
[INF]
[INF] page:
[INF]
[INF] -before-page:
[INF]
[INF] -init:
[INF]
[INF] -init-compiler:
[INF]
[INF] -copy-app-resources:
[INF]
[INF] -generate-deltas:
[INF]
[INF] -detect-app-build-properties:
[INF]
[INF] -build-standalone-json-manifest:
[INF]
[INF] -build-output-page:
[INF]
[INF] -build-output-markup-page:
[INF] Building output markup to /work/www/extjs-tests/t1/build/testing/MyApp/index.html
[INF]
[INF] -generate-cache-manifest:
[INF]
[INF] -page:
[INF]
[INF] -after-page:
[INF]
[INF] native-package:
[INF]
[INF] -build:
[INF]
[INF] -after-build:
[INF]
[INF] build:
[INF]
[INF] app-build:
</pre>

<p class="paragraph">
ビルドに成功しました。
<br />
</p>

<h4 id="id971968">ビルド成果物の確認(testing)</h4>

<p class="paragraph">
&quot;sencha app build testing&quot;でのビルド成果物のディレクトリ構造：
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ tree build
build
├── production
│   (...)
├── temp
│   ├── production
│   │   (...)
│   └── testing
│       └── MyApp
│           ├── sass
│           │   ├── config.rb
│           │   └── MyApp-all.scss
│           ├── sencha-compiler
│           │   ├── app
│           │   │   └── full-page-master-bundle.js
│           │   └── cmd-packages.js
│           └── slicer-temp
│               ├── config.rb
│               ├── MyApp-example.css
│               ├── MyApp-example.scss
│               ├── theme-capture.json
│               └── theme-capture.png
└── testing
    └── MyApp
        ├── app.js
        ├── index.html
        └── resources
            ├── images
            (...)
            ├── MyApp-all.css
            └── Readme.md
</pre>

<p class="paragraph">
&quot;${app.dir}/build/testing&quot; 以下に、最終的な成果物が出力されています。
<br />
</p>


<p class="paragraph">
&quot;${app.dir}/build/testing/MyApp/index.html&quot; : 内容的にはproductionで生成されたものと変わりません。相対パスでCSSやJSが参照されているため、結果として、testingでビルドされたCSSやJSが参照されます。
<br />
</p>
<div class="hl-main"><pre><span class="hl-brackets">&lt;</span><span class="hl-code">!</span><span class="hl-var">DOCTYPE</span><span class="hl-code"> </span><span class="hl-var">HTML</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">meta</span><span class="hl-code"> </span><span class="hl-var">charset</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">UTF-8</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">MyApp</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">link</span><span class="hl-code"> </span><span class="hl-var">rel</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">stylesheet</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">href</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">resources/MyApp-all.css</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">/&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">type</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">text/javascript</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">app.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span></pre></div>

<p class="paragraph">
&quot;${app.dir}/build/testing/MyApp/app.js&quot; : testingでのビルドですと、minifyまではされていないので、人間が読める = ブラウザの開発者ツールなどでデバッグしやすい状態になってます。
<br />
</p>
<div class="hl-main"><pre><span class="hl-comment">/*</span><span class="hl-comment">
This file is part of Ext JS 4.2
 
Copyright (c) 2011-2013 Sencha Inc
 
Contact:  </span><span class="hl-url">http://www.sencha.com/contact</span><span class="hl-comment">
 
GNU General Public License Usage
This file may be used under the terms of the GNU General Public License version 3.0 as
published by the Free Software Foundation and appearing in the file LICENSE included in the
packaging of this file.
 
Please review the following information to ensure the GNU General Public License version 3.0
requirements will be met: </span><span class="hl-url">http://www.gnu.org/copyleft/gpl.html.</span><span class="hl-comment">
 
If you are unsure which license is appropriate for your use, please contact the sales department
at </span><span class="hl-url">http://www.sencha.com/contact.</span><span class="hl-comment">
 
Build date: 2013-05-16 14:36:50 (f9be68accb407158ba2b1be2c226a6ce1f649314)
</span><span class="hl-comment">*/</span><span class="hl-code">
</span><span class="hl-comment">//</span><span class="hl-comment"> @tag foundation,core</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-comment">//</span><span class="hl-comment"> @define Ext</span><span class="hl-comment"></span><span class="hl-code">
 
</span><span class="hl-comment">/*</span><span class="hl-comment">*
 * @class Ext
 * @singleton
 </span><span class="hl-comment">*/</span><span class="hl-code">
</span><span class="hl-reserved">var</span><span class="hl-code"> </span><span class="hl-identifier">Ext</span><span class="hl-code"> = </span><span class="hl-identifier">Ext</span><span class="hl-code"> || </span><span class="hl-brackets">{</span><span class="hl-brackets">}</span><span class="hl-code">;
</span><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">_startTime</span><span class="hl-code"> = </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-builtin">Date</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">.</span><span class="hl-identifier">getTime</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
...</span></pre></div>

<p class="paragraph">
実際に&quot;${app.dir}/build/testing/MyApp&quot; ディレクトリにcdして、&quot;sencha web start&quot;でWebサーバを起動してアクセスしてみます。
<br />
レンダリングされた画面のスクリーンショットについては、先ほどのindex.htmlと同じなので省略します。
<br />
ネットワーク通信状況を見てみますと、productionのときと比べてminifyされてない分、特にJSファイルのサイズが1.5MBと巨大になっていることが分かります。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-04_app_build_testing.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-04_app_build_testing.png" alt="" title=""  /></a>
<br />
</p>

<h4 id="id2653b0">gitに登録</h4>

<p class="paragraph">
この段階で、一旦gitとしてソースツリーをinit &amp; commitして、今後ファイルやディレクトリが変更された際、git statusからどこが変わったのか見えるようにしました。
<br />
</p>

<pre>msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git init
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git add .
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git commit -m &#039;initial commit&#039;
</pre>

<h4 id="id6f2d25">★★ポイント★★ : ビルドされたindex.htmlからは相対パスでCSSとJSがロードされるので、他のパスからも正常に動作する。</h4>

<p class="paragraph">
今まで動作確認に使ってた &quot;sencha web start&quot; では、&quot;${app.dir}/build/production/MyApp&quot; など index.html があるのと同じディレクトリにcdして実行してきました。
<br />
しかし、&quot;${app.dir}/index.html&quot; はもとより、ビルドされたindex.htmlも相対パスでCSSをJSをロードしているので、他のパスからアクセスしても正常に動作します。
<br />
実際、今回の環境では &quot;/work/www&quot; をDocumentRootとしてApacheHTTPDで公開してますので、
<br />
</p>
<pre>http://xxxxxxxx/extjs-tests/t1/build/production/MyApp/
</pre>
<p class="paragraph">
にアクセスすれば、
<br />
</p>
<pre>/work/www/extjs-tests/t1/build/production/MyApp/index.html
</pre>
<p class="paragraph">
にアクセスしたことになり、相対パス指定であれば
<br />
</p>
<pre>/work/www/extjs-tests/t1/build/production/MyApp/app.js
/work/www/extjs-tests/t1/build/production/MyApp/resources/MyApp-all.css
</pre>
<p class="paragraph">
をロードして、結果として正常に動作するはずです。
<br />
</p>

<p class="paragraph">
ということで確認してみたところ、production/testing両方共正常に動作してくれました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-05_build_dir_publishing.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-05_build_dir_publishing.png" alt="" title=""  /></a>
<br />
</p>

<h3 id="id609e64">&quot;sencha generate app&quot; で生成されたデフォルトのスケルトンアプリを動かしてみる</h3>

<p class="paragraph">
基本的なビルド方法を確認できたので、 &quot;${app.dir}/app/Applicaiton.js&quot; を &quot;sencha gnerate app&quot; が生成した元の内容に戻してみます。
<br />
</p>

<p class="paragraph">
&quot;${app.dir}/app/Application.js&quot; :
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">MyApp.Application</span><span class="hl-quotes">'</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">MyApp</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.app.Application</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">views</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> TODO: add views here</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">,
 
    </span><span class="hl-identifier">controllers</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> TODO: add controllers here</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">,
 
    </span><span class="hl-identifier">stores</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> TODO: add stores here</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
&quot;sencha app refresh&quot; 後、ビルドしてみます。（今回はJSを追加したりはしてないので、本来は &quot;sencha app refresh&quot; は不要ですが、念のため。）
<br />
→
<br />
</p>
<pre>$ sencha app refresh
$ sencha app build testing
$ sencha app build
</pre>

<p class="paragraph">
ブラウザでアクセスしてみますと、以下のようにデフォルトのスケルトンのViewが表示されました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-06_generated_app_default.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-06_generated_app_default.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
ここで、gitで変更差分をチェックしてみると、気になる差分がありました。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git status
# On branch master
# Changes not staged for commit:
#   (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
#   (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)
#
#       modified:   app/Application.js
#       modified:   bootstrap.css
#       modified:   bootstrap.js
#       modified:   build/production/MyApp/app.js
#       modified:   build/testing/MyApp/app.js
#       modified:   sass/example/bootstrap.js
#       modified:   sass/example/example.css
#
no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</pre>

<p class="paragraph">
&quot;${app.dir}/bootstrap.css, bootstrap.js&quot; が変更されています。差分を確認してみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git diff bootstrap.css
diff --git a/bootstrap.css b/bootstrap.css
index 3837424..5d9ec26 100644
--- a/bootstrap.css
+++ b/bootstrap.css
@@ -5,5 +5,5 @@
  * to the most recently built CSS file for the application to allow index.html
  * in the development directory to load properly (i.e., &quot;dev mode&quot;).
  */
-@import &#039;build/testing/MyApp/resources/MyApp-all.css&#039;;
+@import &#039;build/production/MyApp/resources/MyApp-all.css&#039;;


msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git diff bootstrap.js
diff --git a/bootstrap.js b/bootstrap.js
index 7c27ae0..990f563 100644
--- a/bootstrap.js
+++ b/bootstrap.js
@@ -412,7 +412,6 @@ Ext.ClassManager.addNameAlternateMappings({
   ],
   &quot;Ext.grid.RowEditor&quot;: [],
   &quot;Ext.grid.RowEditorButtons&quot;: [],
-  &quot;Ext.grid.Scroller&quot;: [],
   &quot;Ext.grid.View&quot;: [],
   &quot;Ext.grid.ViewDropZone&quot;: [],
   &quot;Ext.grid.column.Action&quot;: [
@@ -1269,7 +1268,6 @@ Ext.ClassManager.addNameAliasMappings({
   &quot;Ext.grid.RowEditorButtons&quot;: [
     &quot;widget.roweditorbuttons&quot;
   ],
-  &quot;Ext.grid.Scroller&quot;: [],
   &quot;Ext.grid.View&quot;: [
     &quot;widget.gridview&quot;
   ],
</pre>

<p class="paragraph">
bootstrap.jsについては、&quot;Ext.grid.Scroller&quot;が削除されてるだけで、恐らく&quot;sencha app refresh&quot;の影響と思われます。
<br />
bootstrap.css の&quot;@import&quot; がproductionのビルド結果を参照するようになってるのがちょっと気になりました。
<br />
</p>

<h4 id="id33bf4d">★★ポイント★★ : &quot;${app.dir}/bootstrap.css&quot; は最後にビルドしたenvironmentの内容が反映される。</h4>

<p class="paragraph">
そもそも、gitでコミットした時点では、&quot;build/testing/...&quot; になってました。
<br />
推測としては、最後にビルドされたCSSに置き換わっている可能性が考えられます。
<br />
試しに、今度は &quot;sencha app build testing&quot; でビルドしてみます。
<br />
</p>
<pre>$ sencha app build testing
</pre>
<p class="paragraph">
その後、git statusで変更状況を確認してみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git status
# On branch master
# Changes not staged for commit:
#   (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
#   (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)
#
#       modified:   app/Application.js
#       modified:   build/production/MyApp/app.js
#       modified:   build/testing/MyApp/app.js
#
no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</pre>

<p class="paragraph">
boostrapp.css と、以前のdiffにあった
<br />
</p>
<pre>sass/example/bootstrap.js
sass/example/example.css
</pre>
<p class="paragraph">
が消えています。
<br />
</p>

<p class="paragraph">
最後にgitしたのは、&quot;sencha app build testing&quot; した直後でしたので、おそらく &quot;${app.dir}/bootstrap.css&quot; や &quot;sass/example/bootstrap.js, example.css&quot; は最後にビルドしたenvironmentのパスで更新されているものと思われます。
<br />
</p>

<p class="paragraph">
この点は開発フローでの扱いに注意が必要となりそうです。&quot;build/(environment)/(app名)&quot; 以下でテストしていれば、どのenvironmentでビルドしたものか間違えませんが、&quot;${app.dir}/index.html&quot; でテストしていると、特にCSSについて、直前にどちらのenvironmentでビルドしたかに左右されます。
<br />
また、&quot;${app.dir}/bootstrap.css&quot; の内容についてどの時点のものをコミットするのかなどもルール付けしておいた方が良いでしょう。（とはいえ、最終的には &quot;build/production/&quot; 以下のをリリースすることになるので、あくまでも開発者が混乱しないためのルール付け、という位置づけになりそう）
<br />
</p>

<h4 id="idf3f000">生成されたスケルトンコードのポイント</h4>

<p class="paragraph">
デフォルトで生成されたスケルトンコードについて、実際にどういう構成になっているのか見てみます。
<br />
</p>

<p class="paragraph">
&quot;${app.dir}/app.js&quot;:
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">application</span><span class="hl-brackets">(</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">MyApp</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">MyApp.Application</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">autoCreateViewport</span><span class="hl-code">: </span><span class="hl-reserved">true</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
index.htmlはapp.jsを呼んでいるだけで、app.jsは &quot;Ext.application()&quot; によりExtJSのMVCアプリケーションを起動しています。
<br />
※index.htmlは他にもbootstrap.jsをロードしていますが、開発用にクラスファイルを一個ずつロードしており、最終的なビルド成果物のjsにも直接は含まれませんので、省略します。
<br />
</p>

<p class="paragraph">
ポイントは
<br />
</p>
<pre>autoCreateViewport: true
</pre>
<p class="paragraph">
の部分で、これにより、app/view/Viewport.js が自動的にロードされます。
<br />
&quot;${app.dir}/app/view/Viewport.js&quot; :
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">MyApp.view.Viewport</span><span class="hl-quotes">'</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.container.Viewport</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-identifier">requires</span><span class="hl-code">:</span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-quotes">'</span><span class="hl-string">Ext.layout.container.Fit</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-quotes">'</span><span class="hl-string">MyApp.view.Main</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">,
 
    </span><span class="hl-identifier">layout</span><span class="hl-code">: </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">type</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">fit</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">,
 
    </span><span class="hl-identifier">items</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">app-main</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-brackets">]</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
MyApp.view.Mainを表示しています。&quot;${app.dir}/app/view/Main.js&quot; では Ext.container.Container を継承していて、シンプルにborderレイアウトでパネルやタブパネルをレンダリングしています。
<br />
</p>

<p class="paragraph">
app.jsでもう一つのポイント、実際のアプリケーションクラスを拡張している点ですが、この実体は &quot;${app.dir}/app/Application.js&quot; になります。
<br />
</p>
<pre>extend: &#039;MyApp.Application&#039;,
</pre>

<p class="paragraph">
&quot;${app.dir}/app/Application.js&quot;:
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">MyApp.Application</span><span class="hl-quotes">'</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">MyApp</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.app.Application</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">views</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> TODO: add views here</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">,
 
    </span><span class="hl-identifier">controllers</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> TODO: add controllers here</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">,
 
    </span><span class="hl-identifier">stores</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-comment">//</span><span class="hl-comment"> TODO: add stores here</span><span class="hl-comment"></span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
Application.js = MyApp.Application は app.js の Ext.application() により呼ばれます。launch()が定義されておらずcontrollersも空っぽであるため、何もせずにそのまま、&quot;autoCreateViewport&quot;がtrueなので命名規約にしたがって &quot;MyApp.view.Viewport&quot; を起動してます。
<br />
</p>

<h3 id="id15acfd">&quot;sencha generate view&quot; でViewを追加してみる</h3>

<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha generate view sub.FormDemo
Sencha Cmd v4.0.4.84
[INF]
[INF] init-plugin:
[INF]
[INF] enable-architect:
[INF]
[INF] -before-generate-view:
[INF]
[INF] cmd-root-plugin.init-properties:
[INF]
[INF] init-properties:
[INF]
[INF] init-sencha-command:
[INF]
[INF] init:
[INF]
[INF] generate-view-impl:
[INF]
[INF] generate-view:
</pre>

<p class="paragraph">
&quot;git stat&quot;で差分を確認してみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git stat
# On branch master
# Changes not staged for commit:
#   (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
#   (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)
#
#       modified:   .sencha/app/codegen.json
#
# Untracked files:
#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
#
#       app/view/sub/
no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</pre>

<p class="paragraph">
&quot;${app.dir}/.sencha/app/codegen.json&quot; の差分:
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git diff .sencha/app/codegen.json
diff --git a/.sencha/app/codegen.json b/.sencha/app/codegen.json
index 8e989dd..66b6a85 100644
--- a/.sencha/app/codegen.json
+++ b/.sencha/app/codegen.json
@@ -35,6 +35,9 @@
     },
     &quot;{controllerFileName}.js.tpl.merge&quot;: {
       &quot;b092f4aad11d2f7eaab5ce3e2dcc2fc3134f3188&quot;: &quot;eJxzrSjRS0lNy8xL1VCvTs7PKynKz8lJLfJLzE0tLkhMTq3VQxOtVddRqOZSAILUipLUvBQrBXVXoBmJBQV6znCF6ly1mtZcACwSIF0\u003d&quot;
+    },
+    &quot;{viewFileName}.js.tpl.merge&quot;: {
+      &quot;acde5ea901286ca2f976bcddea23e159dbaa0e6f&quot;: &quot;eJxzrSjRS0lNy8xL1VCqTiwo8EvMTa3VK8tMLderBpFgvpKOQjWXAhCkVpSk5qVYKai7ArU55+cW5Oel5pWo64AlM0pyc4BSHqk5Ofk6CuH5RTkpiorqXLWa1gDU/CBX&quot;
     }
   },
   &quot;targets&quot;: {
@@ -335,6 +338,16 @@
         &quot;controllerNamespace&quot;: &quot;MyApp.controller&quot;,
         &quot;library&quot;: &quot;all&quot;
       }
+    },
+    &quot;app/view/sub/FormDemo.js&quot;: {
+      &quot;source&quot;: &quot;{viewFileName}.js.tpl.merge&quot;,
+      &quot;version&quot;: &quot;acde5ea901286ca2f976bcddea23e159dbaa0e6f&quot;,
+      &quot;parameters&quot;: {
+        &quot;appName&quot;: &quot;MyApp&quot;,
+        &quot;viewName&quot;: &quot;sub.FormDemo&quot;,
+        &quot;name&quot;: &quot;sub.FormDemo&quot;,
+        &quot;viewFileName&quot;: &quot;sub/FormDemo&quot;
+      }
     }
   }
 }
\ No newline at end of file
</pre>

<p class="paragraph">
生成したファイルのメタ情報らしきものが記録されています。これについては後述します。
<br />
</p>

<p class="paragraph">
他に、実際のViewファイルが生成されています。
<br />
&quot;${app.dir}/app/view/sub/FormDemo.js&quot;:
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">MyApp.view.sub.FormDemo</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.Component</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-identifier">html</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Hello, World!!</span><span class="hl-quotes">'</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
これを、いくつかのフォームコンポーネントのデモ用に以下のように修正します。テーマに含まれてる画像アイコンを使うようなコンポーネントを盛り込んでみました。(numberfieldのスピンボタン、datefieldのカレンダアイコン)
<br />
&quot;${app.dir}/app/view/sub/FormDemo.js&quot;:
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">MyApp.view.sub.FormDemo</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
  </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.form.Panel</span><span class="hl-quotes">'</span><span class="hl-code">,
  </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">sub-formdemo</span><span class="hl-quotes">'</span><span class="hl-code">,
  </span><span class="hl-identifier">frame</span><span class="hl-code">: </span><span class="hl-reserved">true</span><span class="hl-code">,
  </span><span class="hl-identifier">title</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Form Demo</span><span class="hl-quotes">'</span><span class="hl-code">,
  </span><span class="hl-identifier">bodyPadding</span><span class="hl-code">: </span><span class="hl-number">10</span><span class="hl-code">,
  </span><span class="hl-identifier">autoScroll</span><span class="hl-code">:</span><span class="hl-reserved">true</span><span class="hl-code">,
  </span><span class="hl-identifier">defaultType</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">textfield</span><span class="hl-quotes">'</span><span class="hl-code">,
  </span><span class="hl-identifier">defaults</span><span class="hl-code"> : </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">anchor</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">100%</span><span class="hl-quotes">'</span><span class="hl-code">
  </span><span class="hl-brackets">}</span><span class="hl-code">,
  </span><span class="hl-identifier">initComponent</span><span class="hl-code">: </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">items</span><span class="hl-code"> = </span><span class="hl-brackets">[</span><span class="hl-code">
    </span><span class="hl-brackets">{</span><span class="hl-code">
      </span><span class="hl-identifier">fieldLabel</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">First Name</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">emptyText</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">First Name</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">first</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">,
    </span><span class="hl-brackets">{</span><span class="hl-code">
      </span><span class="hl-identifier">fieldLabel</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Last Name</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">emptyText</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Last Name</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">last</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">,
    </span><span class="hl-brackets">{</span><span class="hl-code">
      </span><span class="hl-identifier">fieldLabel</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Numbers</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">numberfield</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">numerdemo</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">value</span><span class="hl-code">: </span><span class="hl-number">1</span><span class="hl-code">,
      </span><span class="hl-identifier">minValue</span><span class="hl-code">: </span><span class="hl-number">1</span><span class="hl-code">,
      </span><span class="hl-identifier">maxValue</span><span class="hl-code">: </span><span class="hl-number">125</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">,
    </span><span class="hl-brackets">{</span><span class="hl-code">
      </span><span class="hl-identifier">fieldLabel</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Date of Birth</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">datefield</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">name</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">dob</span><span class="hl-quotes">'</span><span class="hl-code">,
      </span><span class="hl-identifier">maxValue</span><span class="hl-code">: </span><span class="hl-reserved">new</span><span class="hl-code"> </span><span class="hl-builtin">Date</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-brackets">]</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">callParent</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
  </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
さらにこれを表示するように、MyApp.view.Main を以下のように修正します。
<br />
&quot;${app.dir}/app/view/Main.js&quot;:
<br />
</p>
<div class="hl-main"><pre><span class="hl-identifier">Ext</span><span class="hl-code">.</span><span class="hl-identifier">define</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">MyApp.view.Main</span><span class="hl-quotes">'</span><span class="hl-code">, </span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-identifier">extend</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Ext.container.Container</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-identifier">requires</span><span class="hl-code">:</span><span class="hl-brackets">[</span><span class="hl-code">
        </span><span class="hl-quotes">'</span><span class="hl-string">Ext.tab.Panel</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-quotes">'</span><span class="hl-string">Ext.layout.container.Border</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-quotes">'</span><span class="hl-string">MyApp.view.sub.FormDemo</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">]</span><span class="hl-code">,
 
    </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">app-main</span><span class="hl-quotes">'</span><span class="hl-code">,
 
    </span><span class="hl-identifier">layout</span><span class="hl-code">: </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">type</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">border</span><span class="hl-quotes">'</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">,
 
    </span><span class="hl-identifier">items</span><span class="hl-code">: </span><span class="hl-brackets">[</span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">region</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">west</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">panel</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-identifier">title</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">west</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-identifier">width</span><span class="hl-code">: </span><span class="hl-number">150</span><span class="hl-code">,
        </span><span class="hl-identifier">split</span><span class="hl-code">: </span><span class="hl-reserved">true</span><span class="hl-code">,
        </span><span class="hl-identifier">collapsible</span><span class="hl-code">: </span><span class="hl-reserved">true</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-code">,</span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">region</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">center</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">sub-formdemo</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-brackets">}</span><span class="hl-code">,</span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">region</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">south</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-identifier">xtype</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">tabpanel</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-identifier">split</span><span class="hl-code">: </span><span class="hl-reserved">true</span><span class="hl-code">,
        </span><span class="hl-identifier">collapsible</span><span class="hl-code">: </span><span class="hl-reserved">true</span><span class="hl-code">,
        </span><span class="hl-identifier">items</span><span class="hl-code">:</span><span class="hl-brackets">[</span><span class="hl-brackets">{</span><span class="hl-code">
            </span><span class="hl-identifier">title</span><span class="hl-code">: </span><span class="hl-quotes">'</span><span class="hl-string">Center Tab 1</span><span class="hl-quotes">'</span><span class="hl-code">
        </span><span class="hl-brackets">}</span><span class="hl-brackets">]</span><span class="hl-code">
    </span><span class="hl-brackets">}</span><span class="hl-brackets">]</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div>

<p class="paragraph">
&quot;sencha generate view&quot;した段階では、新しいJSファイルはbootstrap.jsには追加されていません。&quot;sencha app refresh&quot;でbootstrap.jsに追加させます。
<br />
</p>
<pre>msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ sencha app refresh
</pre>

<p class="paragraph">
bootstrap.jsの差分を確認してみると、確かにJSファイルが追加されています。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git diff bootstrap.js
diff --git a/bootstrap.js b/bootstrap.js
index 7c27ae0..d1b28ba 100644
--- a/bootstrap.js
+++ b/bootstrap.js
@@ -412,7 +412,6 @@ Ext.ClassManager.addNameAlternateMappings({
   ],
   &quot;Ext.grid.RowEditor&quot;: [],
   &quot;Ext.grid.RowEditorButtons&quot;: [],
-  &quot;Ext.grid.Scroller&quot;: [],
   &quot;Ext.grid.View&quot;: [],
   &quot;Ext.grid.ViewDropZone&quot;: [],
   &quot;Ext.grid.column.Action&quot;: [
@@ -831,7 +830,8 @@ Ext.ClassManager.addNameAlternateMappings({
   &quot;MyApp.Application&quot;: [],
   &quot;MyApp.controller.Main&quot;: [],
   &quot;MyApp.view.Main&quot;: [],
-  &quot;MyApp.view.Viewport&quot;: []
+  &quot;MyApp.view.Viewport&quot;: [],
+  &quot;MyApp.view.sub.FormDemo&quot;: []
 });
 Ext.ClassManager.addNameAliasMappings({
   &quot;Ext.AbstractComponent&quot;: [],
@@ -1269,7 +1269,6 @@ Ext.ClassManager.addNameAliasMappings({
   &quot;Ext.grid.RowEditorButtons&quot;: [
     &quot;widget.roweditorbuttons&quot;
   ],
-  &quot;Ext.grid.Scroller&quot;: [],
   &quot;Ext.grid.View&quot;: [
     &quot;widget.gridview&quot;
   ],
@@ -1824,7 +1823,10 @@ Ext.ClassManager.addNameAliasMappings({
   &quot;MyApp.view.Main&quot;: [
     &quot;widget.app-main&quot;
   ],
-  &quot;MyApp.view.Viewport&quot;: []
+  &quot;MyApp.view.Viewport&quot;: [],
+  &quot;MyApp.view.sub.FormDemo&quot;: [
+    &quot;widget.sub-formdemo&quot;
+  ]
 });
 Ext.setVersion(&quot;ext-theme-base&quot;, &quot;4.2.1&quot;);
 Ext.setVersion(&quot;ext-theme-classic&quot;, &quot;4.2.1&quot;);
</pre>

<p class="paragraph">
ビルドしてみます。
<br />
</p>
<pre>$ sencha app build
$ sencha app build testing
</pre>

<p class="paragraph">
実際にアクセスしてみると、期待通りフォームが表示されました。また、スピンボタンのアイコンや日付入力のカレンダのアイコン、Borderレイアウトでの細かいアイコンなども正常に表示されています。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-07_add_view_image.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-07_add_view_image.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
通信状況を確認してみますと、アイコン画像でのロードが追加されていました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-08_new_res_loads.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-08_new_res_loads.png" alt="" title=""  /></a>
<br />
</p>

<h4 id="idffbf50">★★ポイント1★★: ExtJSコンポーネントの参照とSencha CmdによるCSS生成について</h4>

<p class="paragraph">
&quot;sencha app build&quot; する前に、&quot;${app.dir}/index.html&quot; にアクセスして見栄えを確認してみたのですが、その時点ではアイコンやスタイルなどが適切に反映されてませんでした。
<br />
&quot;sencha app build&quot; した後で初めて、&quot;${app.dir}/build/(environment)/(app.name)/resources/(app.name)-all.css&quot; にフォームなどで使われるCSS要素が追加されました。
<br />
</p>

<p class="paragraph">
&quot;${app.dir}/bootstrap.css&quot; は直前にビルドした(app.name)-all.cssを参照するよう自動的に変更されます。つまり、&quot;sencha app build&quot; する前は、まだフォーム要素などのCSSが追加される前にビルドされたCSSを参照していたため、当然、Borderレイアウトやフォームが使うアイコン画像は反映されていませんでした。
<br />
</p>

<p class="paragraph">
これは、Senca Cmdのビルドシステムにおいて、sass/compassがExtJSコンポーネントの使用状況とどこかで連動していることを予想させます。
<br />
少なくとも、ExtJSコンポーネントを追加するなどしたら忘れずに一度は &quot;sencha app build&quot; して、CSSを更新しておく必要がありそうです。
<br />
</p>

<h4 id="id2cd356">★★ポイント2★★: ExtJSコンポーネントが使用する画像ファイルの相対パス参照について</h4>

<p class="paragraph">
ExtJSコンポーネントが使用する画像ファイルを正常にロードできることを確認しましたので、この時点で&quot;git status&quot;で変更状況を確認してみます。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git status
# On branch master
# Changes not staged for commit:
#   (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
#   (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)
#
#       modified:   .sencha/app/codegen.json
#       modified:   app/view/Main.js
#       modified:   bootstrap.js
#       modified:   build/production/MyApp/app.js
#       modified:   build/production/MyApp/resources/MyApp-all.css
#       modified:   build/temp/production/MyApp/sass/.sass-cache/6c3fff7139e546e62870b7f9540d0c2dc26b04ff/MyApp-all.scssc
#       modified:   build/temp/production/MyApp/sass/MyApp-all.scss
#       modified:   build/temp/production/MyApp/slicer-temp/.sass-cache/d4d4499c660ed36ffe74e12798c83b4b959a9946/MyApp-example.scssc
#       modified:   build/temp/production/MyApp/slicer-temp/MyApp-example.scss
#       modified:   build/temp/testing/MyApp/sass/.sass-cache/e051c4517e0c0690f68b5b2bed608b8ef47d26da/MyApp-all.scssc
#       modified:   build/temp/testing/MyApp/sass/MyApp-all.scss
#       modified:   build/temp/testing/MyApp/slicer-temp/.sass-cache/6ef636349425802b6b77cd95b68222361cfe5f98/MyApp-example.scssc
#       modified:   build/temp/testing/MyApp/slicer-temp/MyApp-example.scss
#       modified:   build/testing/MyApp/app.js
#       modified:   build/testing/MyApp/resources/MyApp-all.css
#       modified:   sass/example/bootstrap.js
#
# Untracked files:
#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
#
#       app/view/sub/
#       build/temp/production/MyApp/sass/.sass-cache/410db9494027a7dec0942a19df39602c27e1cb92/
...
</pre>

<p class="paragraph">
CSSファイルの変更がありましたので、人間でも読める形式のtesting環境のMyApp-all.cssの差分を見てみます。画像ファイルへの参照が追加されています。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git diff build/testing/MyApp/resources/MyApp-all.css
diff --git a/build/testing/MyApp/resources/MyApp-all.css b/build/testing/MyApp/resources/MyApp-all.css

...

+/* line 29, ../../../../ext/packages/ext-theme-neutral/sass/src/window/MessageBox.scss */
+.x-message-box-info {
+  background-image: url(images/shared/icon-info.gif);
+}
+
+/* line 33, ../../../../ext/packages/ext-theme-neutral/sass/src/window/MessageBox.scss */
+.x-message-box-warning {
+  background-image: url(images/shared/icon-warning.gif);
+}

...

+/* line 41, ../../../../ext/packages/ext-theme-neutral/sass/src/form/field/Spinner.scss */
+.x-toolbar-item div.x-form-spinner-up,
+.x-toolbar-item div.x-form-spinner-down {
+  background-image: url(images/form/spinner-small.gif);
+  height: 10px;
+}

...
</pre>


<p class="paragraph">
実際にロードされたgif画像のURLは以下のようになりました。（抜粋）
<br />
</p>
<pre>http://192.168.250.103/extjs-tests/t1/build/testing/MyApp/resources/images/form/spinner.gif
http://192.168.250.103/extjs-tests/t1/build/testing/MyApp/resources/images/form/date-trigger.gif
</pre>

<p class="paragraph">
もう少し噛み砕いてみます。
<br />
</p>
<pre>${app.dir}/build/testing/MyApp/resources/MyApp-all.css
中の
background-image: url(images/form/xxxxxx.gif);
で指定された画像ファイルの実体が
${app.dir}/build/testing/MyApp/resources/images/form/xxxxx.gif
となってロードされてます。
</pre>

<p class="paragraph">
つまり、CSSファイルに対しての相対パスで画像が読み込まれていることが分かります。
<br />
ということは、&quot;resources&quot; 以下を好きな場所に配置する、あるいは、index.htmlの方を好きな場所に配置しても問題なくロードできそうです。
<br />
</p>

<h4 id="id630400">build/temp/ 以下を .gitignore に追加</h4>

<p class="paragraph">
この辺りで、&quot;${app.dir}/build/temp/&quot; 以下を .gitignore に追加してみます。
<br />
</p>

<p class="paragraph">
&quot;${app.dir}/.gitignore:
<br />
</p>
<pre>build/temp/
</pre>

<p class="paragraph">
&quot;git rm&quot; で監視対象からファイルを外します。
<br />
</p>
<pre>$ git rm -r build/temp/
</pre>

<p class="paragraph">
参考：
<br />
</p>
<ul><li> [Git] Gitで指定したファイルを管理下から外す｜未分類｜Nullyのぶろぐ<ul><li> <a class="externallink" href="http://blog.nully.org/2010/11/30/git-git%E3%81%A7%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E7%AE%A1%E7%90%86%E4%B8%8B%E3%81%8B%E3%82%89%E5%A4%96%E3%81%99/" target="_blank">http://blog.nully.org/2010/11/30/git-git%E3%81%A7%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E7%AE%A1%E7%90%86%E4%B8%8B%E3%81%8B%E3%82%89%E5%A4%96%E3%81%99/</a></li></ul></li>
<li> 既にGit管理下のファイルを管理下から外す方法 - Qiita<ul><li> <a class="externallink" href="http://qiita.com/ayakix/items/1855dd11f2e1e34d940c" target="_blank">http://qiita.com/ayakix/items/1855dd11f2e1e34d940c</a></li></ul></li></ul>

<h4 id="idbc5cf5">異なるディレクトリ階層上から&quot;resources&quot;以下のCSSをロードしてみる</h4>

<p class="paragraph">
ExtJSコンポーネントのアイコンが &quot;${app.dir}/build/(environment)/(app名)/resources/&quot; からの相対パスで読み込めることを確認したので、実際に他のHTMLからディレクトリ階層をずらしてロードしてみます。
<br />
</p>

<p class="paragraph">
例えば、testingでビルドしたindex.htmlは以下のようになっています。
<br />
&quot;${app.dir}/build/testing/MyApp/index.html&quot; :
<br />
</p>
<div class="hl-main"><pre><span class="hl-brackets">&lt;</span><span class="hl-code">!</span><span class="hl-var">DOCTYPE</span><span class="hl-code"> </span><span class="hl-var">HTML</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">meta</span><span class="hl-code"> </span><span class="hl-var">charset</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">UTF-8</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">MyApp</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">link</span><span class="hl-code"> </span><span class="hl-var">rel</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">stylesheet</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">href</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">resources/MyApp-all.css</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">/&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">type</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">text/javascript</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">app.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span></pre></div>

<p class="paragraph">
これをそのまま、&quot;${app.dir}&quot; 直下の foo.html にコピーし、以下の様に foo.html からの相対パス指定でtestingビルドのcssとapp.jsをロードするように調整してみます。
<br />
&quot;${app.dir}/foo.html&quot;:
<br />
</p>
<div class="hl-main"><pre><span class="hl-brackets">&lt;</span><span class="hl-code">!</span><span class="hl-var">DOCTYPE</span><span class="hl-code"> </span><span class="hl-var">HTML</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">meta</span><span class="hl-code"> </span><span class="hl-var">charset</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">UTF-8</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">MyApp</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">link</span><span class="hl-code"> </span><span class="hl-var">rel</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">stylesheet</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">href</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">build/testing/MyApp/resources/MyApp-all.css</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">/&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">type</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">text/javascript</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">build/testing/MyApp/app.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span></pre></div>


<p class="paragraph">
特に問題なくロードされ、動作しました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-09_load_res_from_upper_path.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-09_load_res_from_upper_path.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
ネットワーク通信を確認してみると、画像系も正常にロードされています。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-10_load_res_from_upper_path.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-10_load_res_from_upper_path.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
ロードした画像のURLをいくつか抜粋して確認してみると、cssファイルからの相対パスで正常にロードできています。
<br />
</p>
<pre>http://192.168.250.103/extjs-tests/t1/build/testing/MyApp/resources/images/form/spinner.gif
http://192.168.250.103/extjs-tests/t1/build/testing/MyApp/resources/images/form/date-trigger.gif
</pre>

<p class="paragraph">
なお、この状態で sencha app build してみても foo.html が &quot;build/&quot; 以下にコピーされることはありませんでした。単に無視されてるだけのようです。
<br />
</p>

<h4 id="id47eaf9">index.htmlがロードするファイルを ext-all-dev.js に変更してみる</h4>

<p class="paragraph">
&quot;${app.dir}/index.html&quot; を開発中にアクセスする際に悩ましいのは、デフォルトでは &quot;ext/ext-dev.js&quot; をロードしているため、Extコンポーネントのクラスファイルを一つ一つロードすることになり、起動が遅くなる点です。
<br />
そこで以下のように、&quot;ext/ext-dev.js&quot; を全部入りの開発用である &quot;ext/ext-all-dev.js&quot; に修正してみます。
<br />
</p>
<div class="hl-main"><pre><span class="hl-brackets">&lt;</span><span class="hl-code">!</span><span class="hl-var">DOCTYPE</span><span class="hl-code"> </span><span class="hl-var">HTML</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">meta</span><span class="hl-code"> </span><span class="hl-var">charset</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">UTF-8</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">MyApp</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">title</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;x-compile&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
        </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;x-bootstrap&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
            </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">link</span><span class="hl-code"> </span><span class="hl-var">rel</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">stylesheet</span><span class="hl-quotes">&quot;</span><span class="hl-code"> </span><span class="hl-var">href</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">bootstrap.css</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-code">
            </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">ext/ext-all-dev.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
            </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">bootstrap.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
        </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;/x-bootstrap&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
        </span><span class="hl-brackets">&lt;</span><span class="hl-reserved">script</span><span class="hl-code"> </span><span class="hl-var">src</span><span class="hl-code">=</span><span class="hl-quotes">&quot;</span><span class="hl-string">app.js</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">script</span><span class="hl-brackets">&gt;</span><span class="hl-code">
    </span><span class="hl-comment">&lt;!--</span><span class="hl-comment"> &lt;/x-compile&gt; </span><span class="hl-comment">--&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">head</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">body</span><span class="hl-brackets">&gt;</span><span class="hl-code">
</span><span class="hl-brackets">&lt;/</span><span class="hl-reserved">html</span><span class="hl-brackets">&gt;</span></pre></div>

<p class="paragraph">
初回アクセス：ext-all-dev.jsはそれなりのサイズに成りますので、初回ロードは時間がかかってます。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-11_ext-all-dev1.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-11_ext-all-dev1.png" alt="" title=""  /></a>
<br />
</p>


<p class="paragraph">
2回めのアクセス：静的なファイルは304 Modifiedが返されるようになったため、ロード時間が大幅に短縮され、実用的な速度で開発を進められるようになりました。
<br />
<a href="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-11_ext-all-dev2.png" title="" target="_blank"><img src="./../images/20140530_extjs4_senchacmd/extjs4-senchacmd-11_ext-all-dev2.png" alt="" title=""  /></a>
<br />
</p>

<p class="paragraph">
&quot;&lt;x-bootstrap&gt;&quot;に囲まれた中身は、コンパイラで処理され、最終的にビルドされるindex.htmlは前と変わらないため、副作用も多分そんなに無いのではと思います。
<br />
</p>

<p class="paragraph">
なお、なぜかext-all-dev.jsのサイズが1回めは 1,035.61KB で、2回めは 3,410.94KB と表示されているのが気になります。
<br />
そこで、ローカルプロキシを経由させて、1回め/2回めで流れる本当のHTTP通信を覗いてみました。
<br />
</p>

<p class="paragraph">
1回め：gzipされたデータが返されており、そのサイズが1,440,560バイトになっています。
<br />
</p>
<pre class="plugin_pre">
GET /extjs-tests/t1/ext/ext-all-dev.js HTTP/1.1
Host: 192.168.250.103
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: */*
Accept-Language: ja,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://192.168.250.103/extjs-tests/t1/
Connection: keep-alive


HTTP/1.1 200 OK
Date: Sun, 01 Jun 2014 08:20:12 GMT
Server: Apache/2.2.22 (Ubuntu)
Last-Modified: Sat, 31 May 2014 06:28:08 GMT
ETag: &quot;4b600-613d35-4faac43f90e7f&quot;
Accept-Ranges: bytes
Vary: Accept-Encoding
Content-Encoding: gzip
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: application/javascript
Content-Length: 1440560

(gzipされたデータ)
</pre>

<p class="paragraph">
2回め：&quot;304 Not Modified&quot; が返されており、レスポンスボディは空っぽです。
<br />
</p>
<pre class="plugin_pre">
GET /extjs-tests/t1/ext/ext-all-dev.js HTTP/1.1
Host: 192.168.250.103
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: */*
Accept-Language: ja,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://192.168.250.103/extjs-tests/t1/
Connection: keep-alive
If-Modified-Since: Sat, 31 May 2014 06:28:08 GMT
If-None-Match: &quot;4b600-613d35-4faac43f90e7f&quot;
Cache-Control: max-age=0


HTTP/1.1 304 Not Modified
Date: Sun, 01 Jun 2014 08:20:35 GMT
Server: Apache/2.2.22 (Ubuntu)
Connection: Keep-Alive
Keep-Alive: timeout=5, max=100
ETag: &quot;4b600-613d35-4faac43f90e7f&quot;
Vary: Accept-Encoding

</pre>

<p class="paragraph">
以上より、開発者ツールのネットワーク通信で表示されるサイズは若干信用出来ないものの、実際のHTTPパケットを見る限りでは正常に2回め以降のキャッシュヒットが動いていることが確認できました。
<br />
</p>

<h4 id="id8f7bca">senchaコマンドで生成されたファイルと &quot;.sencha/app/codegen.json&quot; について</h4>

<p class="paragraph">
&quot;${app.dir}/app/&quot; 以下の、ExtのMVCモデルに基づいたJavaScriptファイルは、&quot;sencha generate&quot; コマンドにより controller/form/model/view を生成することが出来ます。
<br />
また、開発者が自分で一から作成することもできます。
<br />
</p>

<p class="paragraph">
開発者が自分で作成するのと、&quot;sencha generate&quot; コマンド経由で作成する違いとしては、 &quot;sencha generate&quot; 経由で生成した場合、 &quot;.sencha/app/codegen.json&quot; というファイルに以下のように生成した時のメタ情報が記録される点です。
<br />
</p>
<pre class="plugin_pre">
{
  &quot;sources&quot;: {
    &quot;app.js.tpl.merge&quot;: {
      &quot;adb7999f937a224ece5dc57252db7048652e6616&quot;: &quot;eJxNj81uwjAQhO9+irnxIxTu9FQhrlxaVeK4iYfEUmJHzroBId69xkiFPXhH3v1m7O3aINd35yacXU/k3tIzitJCvEUabdH1FV/0TSfYD7bCKSQ04kHrFPqPy1T8PGkzcw4R15AiZBx714i64Deo04PgxAJPmF3fo5NfQgNqYmBsS2CxeoVi7ujze9
oo1vm2MuutMYeLVm/uy9szXwbusLjlyTHL+2Jjyj0vSm/fJ9XnC85bj6VySNKwj8xf/3GcxxB1B42J5r76MH/syWTb&quot;
    },

...

    &quot;app.json&quot;: {
      &quot;source&quot;: &quot;app.json.tpl.merge&quot;,
      &quot;version&quot;: &quot;5c35fa135e5c429faf9348c096b567a3079ad83b&quot;,
      &quot;parameters&quot;: {
        &quot;viewNamespace&quot;: &quot;MyApp.view&quot;,
        &quot;frameworkName&quot;: &quot;ext&quot;,
        &quot;frameworkPath&quot;: &quot;ext&quot;,
        &quot;senchadir&quot;: &quot;.sencha&quot;,
        &quot;controllerFileName&quot;: &quot;Main&quot;,
        &quot;appModels&quot;: &quot;&quot;,
        &quot;viewFileName&quot;: &quot;Main&quot;,
        &quot;appControllers&quot;: &quot;&quot;,
        &quot;appViews&quot;: &quot;&quot;,
        &quot;uniqueId&quot;: &quot;97333d8b-3cca-4f30-aa90-d40a2910b45e&quot;,
        &quot;appName&quot;: &quot;MyApp&quot;,
        &quot;modelNamespace&quot;: &quot;MyApp.model&quot;,
        &quot;controllerName&quot;: &quot;Main&quot;,
        &quot;viewName&quot;: &quot;Main&quot;,
        &quot;themeName&quot;: &quot;default&quot;,
        &quot;packagesRelPath&quot;: &quot;ext/packages&quot;,
        &quot;name&quot;: &quot;MyApp&quot;,
        &quot;controllerNamespace&quot;: &quot;MyApp.controller&quot;,
        &quot;library&quot;: &quot;all&quot;,
        &quot;appStores&quot;: &quot;&quot;
      }
    },
    &quot;app/controller/Main.js&quot;: {
      &quot;source&quot;: &quot;{controllerFileName}.js.tpl.merge&quot;,
      &quot;version&quot;: &quot;b092f4aad11d2f7eaab5ce3e2dcc2fc3134f3188&quot;,
      &quot;parameters&quot;: {
        &quot;appName&quot;: &quot;MyApp&quot;,
        &quot;controllerName&quot;: &quot;Main&quot;,
        &quot;controllerFileName&quot;: &quot;Main&quot;,
        &quot;name&quot;: &quot;MyApp&quot;,
        &quot;controllerNamespace&quot;: &quot;MyApp.controller&quot;,
        &quot;library&quot;: &quot;all&quot;
      }
    },
    &quot;app/view/sub/FormDemo.js&quot;: {
      &quot;source&quot;: &quot;{viewFileName}.js.tpl.merge&quot;,
      &quot;version&quot;: &quot;acde5ea901286ca2f976bcddea23e159dbaa0e6f&quot;,
      &quot;parameters&quot;: {
        &quot;appName&quot;: &quot;MyApp&quot;,
        &quot;viewName&quot;: &quot;sub.FormDemo&quot;,
        &quot;name&quot;: &quot;sub.FormDemo&quot;,
        &quot;viewFileName&quot;: &quot;sub/FormDemo&quot;
      }
    }
  }
}
</pre>

<p class="paragraph">
codegen.jsonが何に使われるのかは、なかなか公式ドキュメントを参照しても見つからず、唯一、Sencha Cmd のバージョン3のリリースノートに解説を見つけることができました。
<br />
</p>

<ul><li> <a class="externallink" href="http://cdn.sencha.com/cmd/3.1.2.342/release-notes.html" target="_blank">http://cdn.sencha.com/cmd/3.1.2.342/release-notes.html</a></li></ul>

<p class="paragraph">
これによると、codegen.json にはsenchaが生成する際のメタ情報が保存されるようです。これは将来のsencha cmdのバージョンアップで、元々sencha cmdが生成したファイルを適切にマージできるようにするためのトラッキング情報として使われるようです。
<br />
ただ、2014年現在はSencha Cmd バージョン4となっており、現在も使われているのかどうかは不明です。
<br />
後述の通り、&quot;sencha generate&quot;する際に名前を間違ってしまっても登録されてしまったり、また、登録されたエントリを削除するコマンドが無かったり、イレギュラーなケースでは手動調整が必要になりそうです。
<br />
とはいえ、バージョン管理しておけばどのタイミングでどのファイルが生成されたのかを追えるようにはなるので、もし何か間違ったり、余計なエントリが残っていても、ある程度は手動で対応できると思われます。
<br />
</p>

<h4 id="id543c77">&quot;sencha generate&quot; でコンポーネント名を間違えるとどうなるか？</h4>

<p class="paragraph">
上の例では、いきなり
<br />
</p>
<pre>$ sencha generate view sub.FormDemo
</pre>
<p class="paragraph">
として、&quot;${app.dir}/app/view/sub/FormDemo.js&quot; を生成しています。
<br />
</p>

<p class="paragraph">
実は、一発でこの命名規約を理解できたわけではなく、最初は以下みたいに&quot;MyApp&quot; から始めてしまったんです。
<br />
</p>
<pre>$ sencha generate view MyApp.view.sub.SubPanelDemo
</pre>

<p class="paragraph">
そしたら、&quot;${app.dir}/app/view/MyApp/view/sub/SubPanelDemo.js&quot; が生成されてしまったのです。
<br />
&quot;.sencha/app/codegen.json&quot; にもバッチリ、トラッキング情報が記録されてしまいました。
<br />
</p>
<pre class="plugin_pre">
msakamoto@dev1-u1204lts-x64:/work/www/extjs-tests/t1$ git diff .sencha/app/codegen.json
diff --git a/.sencha/app/codegen.json b/.sencha/app/codegen.json
index 8e989dd..4e17157 100644
--- a/.sencha/app/codegen.json
+++ b/.sencha/app/codegen.json
@@ -35,6 +35,9 @@
     },
     &quot;{controllerFileName}.js.tpl.merge&quot;: {
       &quot;b092f4aad11d2f7eaab5ce3e2dcc2fc3134f3188&quot;: &quot;eJxzrSjRS0lNy8xL1VCvTs7PKynKz8lJLfJLzE0tLkhMTq3VQxOtVddRqOZSAILUipLUvBQrBXVXoBmJBQV6znCF6ly1mtZcACwSIF0\u003d&quot;
+    },
+    &quot;{viewFileName}.js.tpl.merge&quot;: {
+      &quot;acde5ea901286ca2f976bcddea23e159dbaa0e6f&quot;: &quot;eJxzrSjRS0lNy8xL1VCqTiwo8EvMTa3VK8tMLderBpFgvpKOQjWXAhCkVpSk5qVYKai7ArU55+cW5Oel5pWo64AlM0pyc4BSHqk5Ofk6CuH5RTkpiorqXLWa1gDU/CBX&quot;
     }
   },
   &quot;targets&quot;: {
@@ -335,6 +338,16 @@
         &quot;controllerNamespace&quot;: &quot;MyApp.controller&quot;,
         &quot;library&quot;: &quot;all&quot;
       }
+    },
+    &quot;app/view/MyApp/view/sub/SubPanelDemo.js&quot;: {
+      &quot;source&quot;: &quot;{viewFileName}.js.tpl.merge&quot;,
+      &quot;version&quot;: &quot;acde5ea901286ca2f976bcddea23e159dbaa0e6f&quot;,
+      &quot;parameters&quot;: {
+        &quot;appName&quot;: &quot;MyApp&quot;,
+        &quot;viewName&quot;: &quot;MyApp.view.sub.SubPanelDemo&quot;,
+        &quot;name&quot;: &quot;MyApp.view.sub.SubPanelDemo&quot;,
+        &quot;viewFileName&quot;: &quot;MyApp/view/sub/SubPanelDemo&quot;
+      }
     }
   }
 }
\ No newline at end of file
</pre>

<p class="paragraph">
なので、gitで元の状態に戻したりしてます。
<br />
</p>

<h3 id="iddc6efe">ビルドしたファイルを削除(sencha ant clean)</h3>

<pre>sencha ant clean
</pre>

<p class="paragraph">
ただ、試したところproduction環境しかcleanしてくれませんでした。testing環境はどうするんでしょうか・・・。
<br />
※一応、&quot;sencha app build&quot; には &quot;--clean, -c&quot; オプションが用意されていて、前の出力を削除してからビルドしてくれます。
<br />
</p>
<pre>例1:
$ sencha app build -c
例2:
$ sencha app build testing --clean
</pre>

<p class="paragraph">
ただ、削除「だけ」をtesting環境でやる方法が見つかりませんでした・・・。
<br />
</p>


<hr class="full_hr" />
<ul class="plugin_navi">
<li>[&nbsp;<a href="./view-1297.html" title="JavaScript/ExtJS/Ext.Component を使ったカスタムコンポーネントの練習">Prev</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1292.html" title="JavaScript/ExtJS/ExtJS4 + Sencha Cmd 勉強メモ2, テーマ(Theme)のカスタマイズ">Next</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-1315.html" title="JavaScript/ExtJS">Up</a>&nbsp;]</li>
<li>[&nbsp;<a href="./view-162.html" title="JavaScript">JavaScript</a>&nbsp;]</li>
</ul>
</div>

<div class="data_attrs_post">
original url: https://www.glamenv-septzen.net/view/1291<br>
</div>

</div>
<!-- //data_main -->

</div>


</div>
<!-- /content-wrap end -->

<!-- footer start -->
<div id="footer">
Copyright &copy; 2007 - 2025 Masahiko Sakamoto(msakamoto-sf)<br>
License&nbsp;:&nbsp;<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a><br>
Contact&nbsp;:&nbsp;<a target="_blank" href="https://x.com/msakamoto_sf">x(twitter)</a> / <a target="_blank" href="https://github.com/msakamoto-sf/">github</a> / <a class="maillink" href="mailto:&#x73;&#x61;&#x6B;&#x61;&#x6D;&#x6F;&#x74;&#x6F;&#x2E;&#x67;&#x73;&#x79;&#x63;&#x2E;&#x33;&#x73;&#x40;&#x67;&#x6D;&#x61;&#x69;&#x6C;&#x2E;&#x63;&#x6F;&#x6D;">email</a><br>
--&nbsp;Beautiful Icons&nbsp;--<br />
<a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank" title="Mark James Silk icon set 1.3">Mark James Silk icon set 1.3</a> by famfamfam<br />
<a href="http://www.pinvoke.com/" target="_blank" title="Fugue Icons">Fugue Icons</a> by Yusuke Kamiyamane<br />
</div>
<!-- /footer end -->

</div>
<!-- /body end -->

</body>
</html>