<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>技術/Solaris10インストールメモ - Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</title>
<!-- favicon 2017's reference:
https://developers.google.com/web/fundamentals/design-and-ui/browser-customization/
https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx
https://developer.chrome.com/multidevice/android/installtohomescreen
https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html
-->
<link rel="shortcut icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="57x57" href="../favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="../favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="../favicons/favicon-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-160x160.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-196x196.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">

<!-- browserconfig.xml : https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx -->
<meta name="msapplication-TileColor" content="#990000">
<meta name="msapplication-TileImage" content="../favicons/mstile-144x144.png">

<!-- these favicon files were generated by https://ao-system.net/favicongenerator/ , thanks!!(2017-02-18) -->

<style type="text/css"></style>

<link href="./css/pcbrowser.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_plugins.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_wiki.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/print.css" rel="stylesheet" type="text/css" media="print"/>
</head>
<body>
<!-- body start -->
<div class="body">
<div style="display: inline"><a name="pagetop"></a></div>
<div id="header-wrap">
<img src="./images/logo1.jpg" style="float: left; margin-right: 1em;"/>
<a href="./index.html" title="Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)"><img src="./icons/home.png" alt="home"/>&nbsp;Glamenv-Septzen(ぐらめぬ・ぜぷつぇん)(archive)</a>


<h1 style="margin-bottom: 10px;">技術/Solaris10インストールメモ</h1>

<div style="clear: both;"></div>
</div><!-- //header-wrap -->

<!-- content-wrap start -->
<div id="content-wrap"><div class="contents_s">

<!-- data_main -->
<div class="data_main">

<div class="data_attrs_pre">
作成日: 2006-07-02 13:54:38 &nbsp; / &nbsp; last updated at: 2008-12-23 13:58:54<br>
カテゴリ: <a href="category-18.html">Solaris</a>&nbsp;</div>

<div class="data_body">
<p class="paragraph">
お仕事でSolaris10上でJavaとCを使った開発をすることになりました。Solaris10自体は、メディアキットを2005年の夏くらいに購入してまして、埃をかぶっていました。Javaはまああまり問題ない筈なんですが、Cの開発が大分雰囲気が違うようでした。せっかくx86用のメディアキットもあることですので、VMware5の中で飼ってみることにしました。
<br />
Cの開発は「Sun Studio 11」を使うことになる、とも聞いていましたので、そちらも併せてインストールしてみます。
<br />
</p>

<ul><li> Solaris10 (2005年に購入したメディアキット使用)</li>
<li> VMware 5</li>
<li> Sun Studio 11</li></ul>

<ul><li><a href="#id16e228">Solaris10のインストール</a></li>
<li><a href="#id637b2e">パッチ適用について</a></li>
<li><a href="#ide879de">環境構築</a><ul><li><a href="#idcf1a53">bashやパスの調整</a><ul><li><a href="#id9a31ca">~/.bashrc</a></li>
<li><a href="#idfb4062">~/.bash_profile</a></li></ul></li></ul></li>
<li><a href="#id761087">Sun Studio11 をインストール。</a></li>
<li><a href="#id873150">その他</a><ul><li><a href="#id3b39ed">シャットダウンと再起動</a></li>
<li><a href="#idc5cd83">/usr/ucb</a></li></ul></li></ul>
<hr />
<h3 id="id16e228">Solaris10のインストール</h3>

<p class="paragraph">
「はじめてのSolaris10」を参考にインストールを行いました。VMwareを使った方法も載っていましたが、どうも物理ディスクを用いて直接インストールを行う手法のようです。今回はVMwareの中で完結すればよいので、その辺りは無視しました。
<br />
</p>

<p class="paragraph">
<a class="externallink" href="http://www.amazon.co.jp/exec/obidos/ASIN/4777511553/503-4155079-1790347" target="_blank">http://www.amazon.co.jp/exec/obidos/ASIN/4777511553/503-4155079-1790347</a>
<br />
</p>

<p class="paragraph">
VMwareで仮想マシンを新規作成するとき、OSとしてSolaris10がexperimentalとはいえリストにありましたので、それを選択して仮想マシンを作成しました。メモリは念のため512MBに増量しておきました。ディスクは20GBを確保しておきました。
<br />
</p>

<p class="paragraph">
他に、Xの設定やTipsなどで次のURLを参考にしました。
<br />
</p>
<ul><li> <a class="externallink" href="http://www.02.246.ne.jp/~torutk/solaris/solaris10_x86.html" target="_blank">http://www.02.246.ne.jp/~torutk/solaris/solaris10_x86.html</a></li></ul>

<p class="paragraph">
加えまして、Software Companion CD もインストールしておきました。
<br />
</p>

<h3 id="id637b2e">パッチ適用について</h3>

<p class="paragraph">
&quot;Recommended Patch&quot;(パッチクラスタ)をSunのサイトからDLしようとすると、有償契約しないとログインできない様でした。
<br />
Solaris10のパッチやソフトウェア構成管理について、こちらの理解が追いつかない状態でしたので、とりあえずRecommended Patchの入手は諦め、&quot;Sun Update Connection&quot;に挑戦しました。
<br />
</p>
<pre>smpatch update
</pre>
<p class="paragraph">
とするだけでよい、と書籍にはあったのですが・・・ネットワーク通信で１～２時間ほどとられた上に、大量にエラーメッセージが表示されてしまい、やる気を無くしてしまいました。
<br />
ちなみに、パッチ適用が不完全だったのが悪かったのかこの後リブートしたとき、コンソール画面が真っ暗な状態になってしまい非常に焦りました。再度リブートしたら直ったみたいです。
<br />
</p>

<h3 id="ide879de">環境構築</h3>

<p class="paragraph">
ネットワークなどの環境構築については、Sunのマニュアルドキュメントや上記URL、あと次のURL等も参照してどうにかDHCPと固定IPを自在に設定できるようになりました。
<br />
</p>

<ul><li> IPアドレス変更の罠(/etc/inet/hosts だけじゃなく、/etc/inet/ipnodes も変更が必要、ということ)<ul><li> <a class="externallink" href="http://spacesheriffsharivan.blog9.fc2.com/blog-entry-18.html#more" target="_blank">http://spacesheriffsharivan.blog9.fc2.com/blog-entry-18.html#more</a></li></ul></li>
<li> 環境構築部分とかも含めて、総合的にあちこちで参考：<ul><li> <a class="externallink" href="http://www.rinneza.com/junya/tech/solaris10_x86/" target="_blank">http://www.rinneza.com/junya/tech/solaris10_x86/</a></li></ul></li></ul>

<p class="paragraph">
ユーザー環境構築については、Linuxから持ってきたドットファイル群を調整して悪戦苦闘しています。
<br />
</p>

<p class="paragraph">
どうでもいいですが、rootのホームディレクトリって/etc/passwd見る限り
<br />
</p>
<pre>root:x:0:0:Super-User:/:/sbin/sh
</pre>
<p class="paragraph">
って&quot;/&quot;になってるんですが・・・これってSolaris系じゃ普通なんでしょうか。/の直下にrootユーザー用のドットファイルがあるというのは、ちょっと衝撃でした。まあ、&quot;ls -a /&quot;自体滅多に叩くコマンドじゃ無いんですが。
<br />
</p>

<p class="paragraph">
あと、起動時のXのログイン画面もうざいのでコンソールログインにおとしたいところだったんですが、パッチ適用時の真っ暗コンソール画面が非常に怖いので(放っておいたら勝手にXに移ってくれた為、事なきを得ていた)、やっぱりXは動かしっぱなしにしておきます。まあ、IPはDHCPじゃなくて固定にしましたから別にコンソールが真っ暗でもSSHログインで入れるので問題ないといえば無いんですが。
<br />
</p>

<h4 id="idcf1a53">bashやパスの調整</h4>

<p class="paragraph">
順番は相前後してしまいますが、Sun Studio11をインストール後の調整で、一般ユーザーで以下のような設定に落ち着いています。
<br />
</p>

<h5 id="id9a31ca">~/.bashrc</h5>
<pre>[ &quot;$BASH&quot; = &quot;&quot; ] &amp;&amp;  return
# source system wide aliases
if [ -f /etc/bashrc ]; then
    source /etc/bashrc
fi

case `tty` in
    &#039;not a tty&#039;)
    ;;
    *)
    stty erase &#039;^H&#039;
    ;;
esac

alias vi=&#039;vim&#039;
alias rm=&#039;rm -i&#039;
alias cp=&#039;cp -i&#039;
alias mv=&#039;mv -i&#039;
alias ..=&#039;cd ..&#039;
alias ll=&#039;ls -l&#039;
alias la=&#039;ls -aF&#039;
alias ls=&#039;ls -F&#039;
</pre>

<h5 id="idfb4062">~/.bash_profile</h5>
<pre>stty -istrip
if [ -f ~/.bashrc ]; then
        source ~/.bashrc
fi

# User specific environment and startup programs

ENV=$HOME/.bashrc
USERNAME=&quot;&quot;

PATH=/opt/SUNWspro/bin:/usr/sfw/bin:/opt/sfw/bin:$PATH
PAGER=&#039;less&#039;

export USERNAME ENV PATH
export PAGER
export PS1=&#039;[\u@\h \W]\$ &#039;

export LESSCHARSET=&#039;utf-8&#039;

MANPATH=/usr/man:/usr/share/man:/usr/sfw/man
MANPATH=$MANPATH:/opt/SUNWspro/man
export MANPATH

export EDITOR=&#039;/opt/sfw/bin/vim&#039;
export JAVA_HOME=&#039;/usr/java&#039;
</pre>

<ul><li> MANPATHで、/opt/SUNWspro/man (SunStudio11)を先頭に持ってきてしまうと、幾つかシステム上のmanよりも先に出てきてしまうらしくまずいことになりました。ですので、SunStudio11のmanは後ろに持ってきています。</li>
<li> Javaは、インストールした時点でjava, javacなどがJDK1.5のものにリンクされていたようです。このまま、JAVA_HOMEを設定しておきます。</li>
<li> PAGERをlessにしたところ、日本語のmanページで&quot;&lt;XXX&gt;&quot;の嵐に見舞われました。色々試行錯誤の末、文字コードを&#039;utf-8&#039;にしたら機嫌を直してくれました。<ul><li> <a class="externallink" href="http://www.atmarkit.co.jp/flinux/rensai/linuxtips/547fedoramanp.html" target="_blank">http://www.atmarkit.co.jp/flinux/rensai/linuxtips/547fedoramanp.html</a></li>
<li> <a class="externallink" href="http://www.miraclelinux.com/technet/faq/data/00087.html" target="_blank">http://www.miraclelinux.com/technet/faq/data/00087.html</a></li>
<li> <a class="externallink" href="http://pocketstudio.jp/linux/?FC4%2FFAQ%2Fman%20%A4%AC%CA%B8%BB%FA%B2%BD%A4%B1%A4%B7%A4%C6%A4%DE%A4%B9%A4%AC%A1%A9" target="_blank">http://pocketstudio.jp/linux/?FC4%2FFAQ%2Fman%20%A4%AC%CA%B8%BB%FA%B2%BD%A4%B1%A4%B7%A4%C6%A4%DE%A4%B9%A4%AC%A1%A9</a></li></ul></li>
<li> viについては、/opt/sfw/bin/vimの方が圧倒的に使いやすいので、そちらにしました。関連して、.bashrcの方で&quot;vi&quot;を&quot;vim&quot;のaliasにしておきました。</li></ul>

<p class="paragraph">
他にlinuxから持ってきた.lessは、こちらのlessとは互換性が無いようでしたのでリネームして無効化しておきました。
<br />
</p>

<h3 id="id761087">Sun Studio11 をインストール。</h3>

<p class="paragraph">
とりあえず次のURLを参考にしました。Sunの本来のドキュメントを参考にするべきなのでしょうが・・・。
<br />
<a class="externallink" href="http://www.02.246.ne.jp/~torutk/solaris/sunstudio11.html" target="_blank">http://www.02.246.ne.jp/~torutk/solaris/sunstudio11.html</a>
<br />
</p>

<p class="paragraph">
上記URLによると、パッチも出ているようです。
<br />
<a class="externallink" href="http://developers.sun.com/prodtech/cc/downloads/patches/ss11_patches.html" target="_blank">http://developers.sun.com/prodtech/cc/downloads/patches/ss11_patches.html</a>
<br />
</p>

<p class="paragraph">
全然関係ありませんが、Sun Studio11では&quot;dbx&quot;というデバッグツールがついてくるみたいでした。gdbとどう違うのか、とか、実際にお仕事で便利に使えるかもなので挑戦してみたいです。
<br />
</p>

<p class="paragraph">
それはともかくとしてパッチを適用しようとしたら、エラーになってしまいました。
<br />
</p>
<pre># cd /var/tmp/120759-06
# patchadd `pwd`
...
Patch 120759-06 failed to install due to a failure produced by pkgadd.
...
See /var/sadm/patch/120759-06/log for details
...
# more /var/sadm/patch/120759-06/log
pkgadd: ERROR: The package &lt;SPROlang&gt; is currently installed on the system in the
global zone. To install the new instance of this package in the global
zone only, you must specify the -G option. To install the new instance
of this package in all zones you must first remove the existing instance
of this package from the global zone first (via pkgrm) and then install
the new instance of this package in all zones.
pkgadd: ERROR: package &lt;SPROlang&gt; cannot be installed on this system/zone
</pre>
<p class="paragraph">
Solaris10では、一台のハードウェア上で複数のSolaris10をソフトウェア的に稼働できる「Solarisコンテナ」という機能があるようです。最初にハードウェアにインストールされたSolarisが「グローバルゾーン」となって、その上で複数のSolarisを動かすようです。
<br />
メッセージを見るに、どうやらグローバルゾーンに対してpatchaddするには&quot;-G&quot;オプションが要るようです。
<br />
</p>

<p class="paragraph">
というわけで、
<br />
</p>
<pre># patchadd -G `pwd`
</pre>
<p class="paragraph">
したら上手く行きました。ちなみに、最後のpwdは現在位置をしていするのを省いたわけです。
<br />
</p>
<pre># patchadd -G -d .
</pre>
<p class="paragraph">
でも同じようでした。
<br />
</p>

<h3 id="id873150">その他</h3>

<h4 id="id3b39ed">シャットダウンと再起動</h4>

<p class="paragraph">
&quot;shutdown&quot;コマンドを使用するのは同じですが、オプションが大分異なります。
<br />
</p>
<pre># shutdown -y -g0 -i5
    -y : ログイン中の他のユーザーの画面にシャットダウンのメッセージを表示しない
    -g0 : -g&lt;N&gt;として、shutdownコマンド発動までの秒数を指定する。ここでは0秒(即時)
    -i5 : -i&lt;N&gt;として、ランレベルを指定する。再起動するときはランレベル6を指定する。
</pre>

<p class="paragraph">
<a href="./files/画像/2006070201_shutdown.jpg" title="画像/2006070201_shutdown.jpg" target="_blank"><img src="./files/画像/2006070201_shutdown.jpg" alt="画像/2006070201_shutdown.jpg" title="画像/2006070201_shutdown.jpg"  /></a>
<br />
</p>

<h4 id="idc5cd83">/usr/ucb</h4>
<p class="paragraph">
/usr/ucb の下に、何かいろいろ詰まっていました。役に立つのであればPATHに加えておきたいところですが・・・
<br />
</p>
<ul><li> <a class="externallink" href="http://cl.pocari.org/2003-01-08-2.html" target="_blank">http://cl.pocari.org/2003-01-08-2.html</a></li>
<li> <a class="externallink" href="http://www.unt.edu/UNT/departments/CC/Benchmarks/julaug95/solaris.htm" target="_blank">http://www.unt.edu/UNT/departments/CC/Benchmarks/julaug95/solaris.htm</a></li>
<li> <a class="externallink" href="http://solaris.sunfish.suginami.tokyo.jp/SD/9806/" target="_blank">http://solaris.sunfish.suginami.tokyo.jp/SD/9806/</a></li>
<li> <a class="externallink" href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-dev/27585" target="_blank">http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-dev/27585</a></li>
<li> <a class="externallink" href="http://www.ctc-g.co.jp/security/0150-01.html" target="_blank">http://www.ctc-g.co.jp/security/0150-01.html</a></li></ul>

<p class="paragraph">
調べてみますと、University of California at Berkeley (だからucb)と関連するBSD互換ツールのようです。
<br />
ただし、便利だからとうかつにPATHに加えたりしますと、ccコマンドをはじめとしていろいろと躓きそうです。
<br />
&quot;/usr/ucb をPATHに加えるのが間違い&quot;という認識もあるようですので、これはスルーしておきます。
<br />
</p>
</div>

<div class="data_attrs_post">
original url: https://www.glamenv-septzen.net/view/92<br>
</div>

</div>
<!-- //data_main -->

</div>


</div>
<!-- /content-wrap end -->

<!-- footer start -->
<div id="footer">
Copyright &copy; 2007 - 2025 Masahiko Sakamoto(msakamoto-sf)<br>
License&nbsp;:&nbsp;<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a><br>
Contact&nbsp;:&nbsp;<a target="_blank" href="https://x.com/msakamoto_sf">x(twitter)</a> / <a target="_blank" href="https://github.com/msakamoto-sf/">github</a> / <a class="maillink" href="mailto:&#x73;&#x61;&#x6B;&#x61;&#x6D;&#x6F;&#x74;&#x6F;&#x2E;&#x67;&#x73;&#x79;&#x63;&#x2E;&#x33;&#x73;&#x40;&#x67;&#x6D;&#x61;&#x69;&#x6C;&#x2E;&#x63;&#x6F;&#x6D;">email</a><br>
--&nbsp;Beautiful Icons&nbsp;--<br />
<a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank" title="Mark James Silk icon set 1.3">Mark James Silk icon set 1.3</a> by famfamfam<br />
<a href="http://www.pinvoke.com/" target="_blank" title="Fugue Icons">Fugue Icons</a> by Yusuke Kamiyamane<br />
</div>
<!-- /footer end -->

</div>
<!-- /body end -->

</body>
</html>