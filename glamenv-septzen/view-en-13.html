<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Python/Installing pydasm and pydbg with Python 2.5, WinXP, VC++2008 Express Edition - Glamenv-Septzen(en)(archive)</title>
<!-- favicon 2017's reference:
https://developers.google.com/web/fundamentals/design-and-ui/browser-customization/
https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx
https://developer.chrome.com/multidevice/android/installtohomescreen
https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html
-->
<link rel="shortcut icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="../favicons/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" sizes="57x57" href="../favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="../favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="../favicons/favicon-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-160x160.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-196x196.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">

<!-- browserconfig.xml : https://msdn.microsoft.com/ja-jp/library/dn455106(v=vs.85).aspx -->
<meta name="msapplication-TileColor" content="#990000">
<meta name="msapplication-TileImage" content="../favicons/mstile-144x144.png">

<!-- these favicon files were generated by https://ao-system.net/favicongenerator/ , thanks!!(2017-02-18) -->

<style type="text/css"></style>

<link href="./css/pcbrowser.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_plugins.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/pcbrowser_wiki.css" rel="stylesheet" type="text/css" media="screen"/>
<link href="./css/print.css" rel="stylesheet" type="text/css" media="print"/>
</head>
<body>
<!-- body start -->
<div class="body">
<div style="display: inline"><a name="pagetop"></a></div>
<div id="header-wrap">
<img src="./images/logo1.jpg" style="float: left; margin-right: 1em;"/>
<a href="./index-en.html" title="Glamenv-Septzen(en)(archive)"><img src="./icons/home.png" alt="home"/>&nbsp;Glamenv-Septzen(en)(archive)</a>


<h1 style="margin-bottom: 10px;">Python/Installing pydasm and pydbg with Python 2.5, WinXP, VC++2008 Express Edition</h1>

<div style="clear: both;"></div>
</div><!-- //header-wrap -->

<!-- content-wrap start -->
<div id="content-wrap"><div class="contents_s">

<!-- data_main -->
<div class="data_main">

<div class="data_attrs_pre">
created at: 2010-11-01 11:44:59 &nbsp; / &nbsp; last updated at: 2010-11-02 21:38:07<br>
category: <a href="category-en-13.html">Python</a>&nbsp;</div>

<div class="data_body">
<p class="paragraph">
Yesterday I tried installing pydbg and pydasm on my notepc.
<br />
pydasm is popular, famous library to disassemble machine codes (opcodes).
<br />
pydbg is also popular, famous library to build lightweight, extensible debugger for Windows platform.
<br />
Actually, pydbg is included in PaiMei, windows platform debugger framework.
<br />
</p>

<p class="paragraph">
The journey was hard, full of struggle and traps with python distutils.
<br />
I left these notes, memos, and traps for future person (including myself) who want installing these excellent reverse engineering tools written in python and c.
<br />
</p>

<p class="paragraph">
My notepc environments are:
<br />
</p>
<pre>CPU : Intel Pentium M (Centrino) 1.2GHz
RAM : 1GB
OS : Windows XP Professional SP3 (Japanese)
Python: Python 2.5 (install from MSI installer)
        Install Dir : C:\Python25
Visual Studio : Visual C++ 2008 Express Edision (SP1)
Subversion: TortoiseSVN 1.6.x
</pre>

<p class="paragraph">
We require Subversion to obtain PaiMei later.
<br />
</p>


<p class="paragraph">
Okay, Let&#039;s begin.
<br />
</p>

<ul><li><a href="#id31b1d2">Installing pydasm step-by-step</a><ul><li><a href="#id8c0759">getting libdasm</a></li>
<li><a href="#id8c0c36">try compile -&gt; errors!!</a></li>
<li><a href="#idade615">avoiding distutil&#039;s registry key checks</a></li>
<li><a href="#id080fad">try compiling again -&gt; build success!!</a></li>
<li><a href="#iddaabb5">install pydasm and test ... oh-no, &quot;MSVCR90.dll&quot; not foud !?</a></li>
<li><a href="#id20efbd">edit msvccompiler.py again, change compile option -&gt; pydasm works correct!!</a></li></ul></li>
<li><a href="#idbeaa9c">Installing pydbg step-by-step</a><ul><li><a href="#idde388d">checkout from SVN repositry and install -&gt; &quot;Python26.dll not found&quot; !?</a></li>
<li><a href="#idc81011">remove bundled pydasm.pyd in pydbg -&gt; success!!</a></li>
<li><a href="#id027721">note for other modules in PaiMei</a></li></ul></li></ul>
<hr />
<h3 id="id31b1d2">Installing pydasm step-by-step</h3>

<p class="paragraph">
pydbg requires pydasm. We have to install pydasm before installing pydbg.
<br />
But pydasm is written by c, and no official binary release for win32 platform.
<br />
</p>

<p class="paragraph">
Out environments uses:
<br />
</p>
<pre>Python 2.5
Visual C++ 2008 Express Edition SP1
</pre>

<h4 id="id8c0759">getting libdasm</h4>

<p class="paragraph">
pydasm is included &quot;libdasm&quot;, simple x86 disassembly library. Author of pydasm is another person to author of libdasm.
<br />
libdasm was written by jt (nologin.org), pydasm was written by ero (dkbza.org). pydasm was contributed to libdasm.
<br />
</p>

<ul><li> dkbza - pydasm (just showing libdasm download link, short overview, example codes)<ul><li> <a class="externallink" href="http://dkbza.org/pydasm.html" target="_blank">http://dkbza.org/pydasm.html</a></li></ul></li></ul>

<p class="paragraph">
Now, let&#039;s download libdasm, including pydasm from following url:
<br />
</p>
<ul><li> libdasm : nologin -- code<ul><li> <a class="externallink" href="http://www.nologin.org/main.pl?action=codeView&amp;codeId=49&amp;" target="_blank">http://www.nologin.org/main.pl?action=codeView&amp;codeId=49&amp;</a></li></ul></li></ul>

<p class="paragraph">
When download success, expand tar.gz into your favorite directory.
<br />
Yesterday, I get libdasm-1.5.tar.gz. After expanding, I got following directory trees:
<br />
</p>
<pre>libdasm-1.5\
    libdasm.c
    README.txt
    ...
    bin\
    pydasm\
    ...
</pre>

<h4 id="id8c0c36">try compile -&gt; errors!!</h4>

<p class="paragraph">
Next, open command prompt, setup your VC++ environment (ex: vcvars32.bat). Confirm &quot;C:\Python25&quot; is added PATH environment or &quot;.py&quot; extension is associated with &quot;C:\Python25\python.exe&quot;.
<br />
In your command prompt, cd to &quot;libdasm-1.5\pydasm&quot;, and type:
<br />
</p>
<pre>&gt; setup.py build_ext
running build_ext
error: Python was built with Visual Studio 2003;
extensions must be built with a compiler than can generate compatible binaries.
Visual Studio 2003 was not found on this system. If you have Cygwin installed,
you can try compiling with MingW32, by passing &quot;-c mingw32&quot; to setup.py.
</pre>

<p class="paragraph">
Ouch!! Why? My command prompt enviroments are surely prepared for VC++ tools!!
<br />
</p>
<pre>&gt; cl
Microsoft(R) 32-bit C/C++ Optimizing Compiler Version 15.00.30729.01 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.
...
&gt; link
Microsoft (R) Incremental Linker Version 9.00.30729.01
Copyright (C) Microsoft Corporation.  All rights reserved.
</pre>

<p class="paragraph">
The answer is, Python&#039;s distutils tool (used from setup.py) checks Visual Studio&#039;s registry keys and confirm proper version is installed or not.
<br />
Unfortunately, registry keys installed by VC++2008 Express Edision on my environment are not what distutils expected.
<br />
</p>

<h4 id="idade615">avoiding distutil&#039;s registry key checks</h4>

<p class="paragraph">
Then how to avoid these annoying registry key checks ?
<br />
The answer is, edit distutil&#039;s library source code. Python is open source, and distutils are written in python.
<br />
</p>

<p class="paragraph">
(Skips my surveys and researches for distutils and its source code.)
<br />
</p>

<p class="paragraph">
As a result, edit following source code:
<br />
</p>
<pre>C:\Python25\Lib\distutils\msvccompiler.py
</pre>

<p class="paragraph">
In msvccompiler.py:
<br />
</p>
<pre>...
class MSVCCompiler (CCompiler) :
    ...
    def __init__ (self, verbose=0, dry_run=0, force=0):
        ...
        # comment out here!!
        self.__macros = MacroExpander(self.__version)
</pre>

<p class="paragraph">
Registry keys checks are implemented in MacroExpander() and its constructor. And, &quot;self.__macros&quot; is optional, not needed. So removing this line doesn&#039;t effect to compiling.
<br />
After removing unneccesary line, delete old &quot;.pyc&quot; file, msvccompiler.pyc, may be exists in same directory to &quot;.py&quot;.
<br />
</p>

<h4 id="id080fad">try compiling again -&gt; build success!!</h4>

<p class="paragraph">
In msvccompiler.py, there&#039;s no registry checks when &quot;DISTUTILS_USE_SDK&quot; and &quot;MSSdk&quot; environments are set and &quot;cl.exe&quot; is found in PATH environment.
<br />
So we set &quot;DISTUTILS_USE_SDK&quot; and &quot;MSSdk&quot; in our command prompt window:
<br />
</p>
<pre>&gt; set DISTUTILS_USE_SDK=1
&gt; set MSSdk=1
</pre>
<p class="paragraph">
Every thing is okay for each environment values. msvccompiler.py only checks each key is exists, ignoring values.
<br />
</p>

<p class="paragraph">
Okay, let&#039;s try compiling:
<br />
</p>
<pre>&gt; setup.py build_ext
running build_ext
building &#039;pydasm&#039; extension
creating build
creating build\temp.win32-2.5
creating build\temp.win32-2.5\Release
C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\cl.exe \
    /c /nologo /Ox /MD /W3 /GX /DNDEBUG \
    -IC:\Python25\include -IC:\Python25\include -IC:\Python25\PC \
    /Tc../libdasm.c /Fobuild\temp.win32-2.5\Release\../libdasm.obj
C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\cl.exe \
    /c /nologo /Ox /MD /W3 /GX /DNDEBUG \
    -IC:\Python25\include -IC:\Python25\include -IC:\Python25\PC \
    /Tcpydasm.c /Fobuild\temp.win32-2.5\Release\pydasm.obj
creating build\lib.win32-2.5
C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\link.exe \
    /DLL /nologo /INCREMENTAL:NO \
    /LIBPATH:C:\Python25\libs /LIBPATH:C:\Python25\PCBuild /EXPORT:initpydasm \
    build\temp.win32-2.5\Release\../libdasm.obj build\temp.win32-2.5\Release\pydasm.obj \
    /OUT:build\lib.win32-2.5\pydasm.pyd \
    /IMPLIB:build\temp.win32-2.5\Release\..\pydasm.lib
</pre>
<p class="paragraph">
(omitting warnings from build output)
<br />
</p>

<p class="paragraph">
When all work correct, we&#039;ll get 
<br />
</p>
<pre>libdasm-1.5\pydasm\build\lib.win32-2.5\pydasm.pyd
</pre>

<h4 id="iddaabb5">install pydasm and test ... oh-no, &quot;MSVCR90.dll&quot; not foud !?</h4>

<p class="paragraph">
Now invoking install command:
<br />
</p>
<pre>&gt; setup.py install
running install
running build
running build_ext
running install_lib
copying build\lib.win32-2.5\pydasm.pyd -&gt; C:\Python25\Lib\site-packages
copying build\lib.win32-2.5\pydasm.pyd.manifest -&gt; C:\Python25\Lib\site-packages
running install_egg_info
Removing C:\Python25\Lib\site-packages\pydasm-1.5-py2.5.egg-info
Writing C:\Python25\Lib\site-packages\pydasm-1.5-py2.5.egg-info
</pre>

<p class="paragraph">
Then invoking python and try to import pydasm:
<br />
</p>
<pre>&gt; C:\Python25\python.exe
Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import pydasm
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
ImportError: DLL load failed: 指定されたモジュールが見つかりません。
&gt;&gt;&gt; quit()
</pre>

<p class="paragraph">
Oh-no, last &quot;ImportError&quot; says &quot;specified module not found&quot;. And on my environment, &quot;MSVCR90.dll not found&quot; messagebox was shown.
<br />
</p>

<p class="paragraph">
Checking module dependencies:
<br />
</p>
<pre>&gt; dumpbin /dependents C:\Python25\python.exe
...
   python25.dll
   MSVCR71.dll   &lt;-- Python25 depends on MSVCR71.dll
   KERNEL32.dll
...
&gt; dumpbin /dependents build\lib.win32-2.5\pydasm.pyd
...
   MSVCR90.dll    &lt;-- pydasm depends on MSVCR90.dll !!
   python25.dll
   KERNEL32.dll
</pre>

<p class="paragraph">
On my environment, MSVCR90.dll was installed to Visual Studio installed directory, but not to Windows system directory.If you&#039;ve already installed VC-Runtime including MSVCR90.dll to your Windows system directory, those ImportError and message box may not be shown, all works correctly.
<br />
</p>

<p class="paragraph">
How do that ? There&#039;re 2 ways to resolve this error.
<br />
</p>
<ol><li> install VC-Runtime including MSVCR90.dll to Windows.<ol><li> This is straightforward, but Python uses MSVCR71.dll (compiled by older version VisualStudio). I&#039;m afraid of conflict between runtime dlls.</li></ol></li>
<li> link VC-Runtime static.<ol><li> This makes portable module, but need to change compile options, module file size become big.</li></ol></li></ol>

<p class="paragraph">
I&#039;m afraid of conflits between runtime dlls strongly (may be another trap), so I delve into second way.
<br />
</p>

<h4 id="id20efbd">edit msvccompiler.py again, change compile option -&gt; pydasm works correct!!</h4>

<p class="paragraph">
Then how to change compile option ? What option should we choose ?
<br />
msvccompiler.py setups compiler options in MSVCCompiler class&#039;s initialize method.
<br />
</p>

<p class="paragraph">
msvccompiler.py:
<br />
</p>
<pre class="plugin_pre">
...
class MSVCCompiler (CCompiler) :
...
    def initialize(self):
        ...
        self.preprocess_options = None
        if self.__arch == &quot;Intel&quot;:
            self.compile_options = [ &#039;/nologo&#039;, &#039;/Ox&#039;, &#039;/MD&#039;, &#039;/W3&#039;, &#039;/GX&#039; ,
                                     &#039;/DNDEBUG&#039;]
            self.compile_options_debug = [&#039;/nologo&#039;, &#039;/Od&#039;, &#039;/MDd&#039;, &#039;/W3&#039;, &#039;/GX&#039;,
                                          &#039;/Z7&#039;, &#039;/D_DEBUG&#039;]
</pre>

<p class="paragraph">
&quot;/MD&quot; and &quot;/MDd&quot; indicates dynamic linking multithreaded library.
<br />
For more details about runtime library and compiler options, see following MSDN.
<br />
</p>
<ul><li> C Run-Time Libraries<ul><li> <a class="externallink" href="http://msdn.microsoft.com/en-us/library/abx4dbyh.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/abx4dbyh.aspx</a><ul><li> &quot;MSDN Library&quot; &gt; &quot;Development Tools and Languages&quot; &gt; &quot;Visual Studio 2010&quot; &gt; &quot;Visual Studio&quot; &gt; &quot;Visual Studio Languages&quot; &gt; &quot;Visual C++&quot; &gt; &quot;Visual C++ Reference&quot; &gt; &quot;Visual C++ Libraries Reference&quot; &gt; &quot;Run-Time Library&quot; &gt; &quot;C Run-Time Libraries&quot;</li></ul></li></ul></li></ul>

<p class="paragraph">
This time we want to link static multithreaded library, So we choose &quot;/MT&quot; and &quot;/MTd&quot;.
<br />
Edit msvccompiler.py:
<br />
</p>
<pre class="plugin_pre">
...
class MSVCCompiler (CCompiler) :
...
    def initialize(self):
        ...
        self.preprocess_options = None
        if self.__arch == &quot;Intel&quot;:
            # change &#039;/MD&#039; =&gt; &#039;/MT&#039;
            self.compile_options = [ &#039;/nologo&#039;, &#039;/Ox&#039;, &#039;/MT&#039;, &#039;/W3&#039;, &#039;/GX&#039; ,
                                     &#039;/DNDEBUG&#039;]
            # change &#039;/MDd&#039; =&gt; &#039;/MTd&#039;
            self.compile_options_debug = [&#039;/nologo&#039;, &#039;/Od&#039;, &#039;/MTd&#039;, &#039;/W3&#039;, &#039;/GX&#039;,
                                          &#039;/Z7&#039;, &#039;/D_DEBUG&#039;]
</pre>

<p class="paragraph">
Delete old msvccompiler.pyc and pydasm\build directory, and try build again.
<br />
</p>
<pre class="plugin_pre">
&gt; setup.py build_ext
&gt; dumpbin /dependents build\lib.win32-2.5\pydasm.pyd
 Image has the following dependencies:

   python25.dll
   KERNEL32.dll
...
&gt; setup.py install
...
&gt; C:\Python25\python.exe
Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import pydasm
&gt;&gt;&gt; buffer = &#039;\x90\x31\xc9\x31\xca\x31\xcb&#039;
&gt;&gt;&gt; offset = 0
&gt;&gt;&gt; while offset &lt; len(buffer):
...     i = pydasm.get_instruction(buffer[offset:], pydasm.MODE_32)
...     print pydasm.get_instruction_string(i, pydasm.FORMAT_INTEL, 0)
...     if not i:
...         break
...     offset += i.length
...
nop
xor ecx,ecx
xor edx,ecx
xor ebx,ecx
&gt;&gt;&gt; quit()
</pre>

<p class="paragraph">
All-right, pydasm seems to work correctly.
<br />
</p>

<p class="paragraph">
Next, try to install PaiMei, pydbg.
<br />
</p>

<h3 id="idbeaa9c">Installing pydbg step-by-step</h3>

<ul><li> PaiMei Official Docs<ul><li> <a class="externallink" href="http://pedram.redhive.com/PaiMei/docs/" target="_blank">http://pedram.redhive.com/PaiMei/docs/</a></li></ul></li>
<li> PaiMei Google Codes Site<ul><li> <a class="externallink" href="http://code.google.com/p/paimei/" target="_blank">http://code.google.com/p/paimei/</a></li></ul></li>
<li> Other Resources:<ul><li> <a class="externallink" href="http://thatsbroken.com/?p=26" target="_blank">http://thatsbroken.com/?p=26</a></li>
<li> <a class="externallink" href="http://maliciousattacker.blogspot.com/2006/12/pydbg-in-vmware.html" target="_blank">http://maliciousattacker.blogspot.com/2006/12/pydbg-in-vmware.html</a></li>
<li> <a class="externallink" href="http://www.openrce.org/downloads/details/208/PaiMei" target="_blank">http://www.openrce.org/downloads/details/208/PaiMei</a></li>
<li> <a class="externallink" href="http://maliciousattacker.blogspot.com/2007/01/setting-up-pydbg.html" target="_blank">http://maliciousattacker.blogspot.com/2007/01/setting-up-pydbg.html</a></li></ul></li></ul>

<h4 id="idde388d">checkout from SVN repositry and install -&gt; &quot;Python26.dll not found&quot; !?</h4>

<p class="paragraph">
1st, checkout (or export) PaiMei latest source tree from SVN repositry. Use your favorite SVN tools.
<br />
Yesterday, I checkouted r248 trunk source tree.
<br />
</p>

<p class="paragraph">
2nd, open command prompt window, cd to PaiMei directory, and run setup.py.
<br />
</p>
<pre>&gt; setup.py build
(...)
&gt; setup.py install
(...)
</pre>

<p class="paragraph">
3rd, try to import pydbg:
<br />
</p>
<pre class="plugin_pre">
&gt; C:\Python25\python.exe
Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import pydbg
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;pydbg\__init__.py&quot;, line 47, in &lt;module&gt;
    from pydbg                   import *
  File &quot;C:\in_vitro\SVNWORK\paimei\pydbg\pydbg.py&quot;, line 32, in &lt;module&gt;
    import pydasm
ImportError: DLL load failed: 指定されたモジュールが見つかりません。
</pre>
<p class="paragraph">
And message box was shown, saying &quot;Python26.dll not found&quot;.
<br />
</p>

<p class="paragraph">
See carefully above python stacktrace. It is very strange that error has occurred at &quot;import pydasm&quot;.
<br />
At previous section, we confirm &quot;import pydasm&quot; work correctly. What&#039;s happening?
<br />
</p>

<h4 id="idc81011">remove bundled pydasm.pyd in pydbg -&gt; success!!</h4>

<p class="paragraph">
The Answer is : &quot;pydasm.pyd&quot; is bundled in pydbg module directory, and it was compiled with Python 2.6.
<br />
</p>
<pre class="plugin_pre">
&gt; dumpbin /dependents C:\Python25\Lib\site-packages\pydbg\pydasm.pyd
                                                    ^^^^^^^^^^^^^^^^ pydasm.pyd was bundled!!
...
  Image has the following dependencies:

    MSVCR90.dll
    python26.dll
    KERNEL32.dll
...
</pre>

<p class="paragraph">
Then, we simply remove bundled &quot;pydbg\pydasm.pyd&quot;. Close command prompt, shutdown all python program, and re-open command prompt (clear loaded dlls).
<br />
</p>

<p class="paragraph">
Try-again:
<br />
</p>
<pre class="plugin_pre">
&gt; C:\Python25\python.exe
Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import pydbg
&gt;&gt;&gt;
</pre>
<p class="paragraph">
All-right, no errors!!
<br />
</p>

<p class="paragraph">
Finally, invoke calc.exe, get its PID, and test following example:
<br />
</p>
<pre class="plugin_pre">
from pydbg import *
from pydbg.defines import *
def handler_breakpoint (pydbg):
  if pydbg.first_breakpoint:
    print &quot;[*] Hit 1st breakpoint!&quot;
    return DBG_CONTINUE
  print &quot;[*] Hit breakpoint!&quot;
  return DBG_CONTINUE
dbg = pydbg()
dbg.set_callback(EXCEPTION_BREAKPOINT, handler_breakpoint)
dbg.attach(XXXXX) # pid of calc.exe
recv = dbg.func_resolve(&quot;user32&quot;, &quot;ShowWindow&quot;)
dbg.bp_set(recv)
dbg.debug_event_loop()
</pre>

<p class="paragraph">
Example:
<br />
</p>
<pre class="plugin_pre">
&gt; C:\Python25\python.exe
Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; from pydbg import *
&gt;&gt;&gt; from pydbg.defines import *
&gt;&gt;&gt; def handler_breakpoint (pydbg):
...   if pydbg.first_breakpoint:
...     print &quot;[*] Hit 1st breakpoint!&quot;
...     return DBG_CONTINUE
...   print &quot;[*] Hit breakpoint!&quot;
...   return DBG_CONTINUE
...
&gt;&gt;&gt; dbg = pydbg()
&gt;&gt;&gt; dbg.set_callback(EXCEPTION_BREAKPOINT, handler_breakpoint)
&gt;&gt;&gt; dbg.attach(5084)
&lt;pydbg.pydbg.pydbg instance at 0x00BF8198&gt;
&gt;&gt;&gt; recv = dbg.func_resolve(&quot;user32&quot;, &quot;ShowWindow&quot;)
&gt;&gt;&gt; dbg.bp_set(recv)
&lt;pydbg.pydbg.pydbg instance at 0x00BF8198&gt;
&gt;&gt;&gt; dbg.debug_event_loop()
[*] Hit 1st breakpoint!
[*] Hit breakpoint!
...
(minimize, or restore calc window)
...
[*] Hit breakpoint!
&gt;&gt;&gt; quit()
</pre>

<h4 id="id027721">note for other modules in PaiMei</h4>

<p class="paragraph">
In this article, we JUST ONLY want to install pydbg in PaiMei.
<br />
This article ignored to setup other modules in PaiMei, like PIDA, GUI components.
<br />
If you want to setup these modules, PaiMei framework fullset, see documents in official site or &quot;docs/index.html&quot; in SVN source tree.
<br />
</p>

</div>

<div class="data_attrs_post">
original url: https://www.glamenv-septzen.net/en/view/13<br>
</div>

</div>
<!-- //data_main -->

</div>


</div>
<!-- /content-wrap end -->

<!-- footer start -->
<div id="footer">
Copyright &copy; 2007 - 2025 Masahiko Sakamoto(msakamoto-sf)<br>
License&nbsp;:&nbsp;<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a><br>
Contact&nbsp;:&nbsp;<a target="_blank" href="https://x.com/msakamoto_sf">x(twitter)</a> / <a target="_blank" href="https://github.com/msakamoto-sf/">github</a> / <a class="maillink" href="mailto:&#x73;&#x61;&#x6B;&#x61;&#x6D;&#x6F;&#x74;&#x6F;&#x2E;&#x67;&#x73;&#x79;&#x63;&#x2E;&#x33;&#x73;&#x40;&#x67;&#x6D;&#x61;&#x69;&#x6C;&#x2E;&#x63;&#x6F;&#x6D;">email</a><br>
--&nbsp;Beautiful Icons&nbsp;--<br />
<a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank" title="Mark James Silk icon set 1.3">Mark James Silk icon set 1.3</a> by famfamfam<br />
<a href="http://www.pinvoke.com/" target="_blank" title="Fugue Icons">Fugue Icons</a> by Yusuke Kamiyamane<br />
</div>
<!-- /footer end -->

</div>
<!-- /body end -->

</body>
</html>