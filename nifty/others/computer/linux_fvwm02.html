<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>～FVWMの逆襲（fvwm-2.5.7 with esox）～</title>
<style>
</style>
</head>
<body >
<!-- i.e. -->
<!-- $title := "タイトル" -->
<!-- $toppage := "トップページ" -->
<!-- $subtop := "いろいろ" -->
<a href="../../index.html">トップページ</a>＞＞＞<a href="../index.html#computer">「いろいろ」目次</a><br>
<br>
<h1>～FVWMの逆襲（fvwm-2.5.7 with esox）～</h1>
初版作成：2003/06/25<br>
<!-- 二版作成：$date_2<br> -->
<br>
<h2><a name="contents">目次</a></h2>
<ol>
	<li><a href="#preface">前書き</a></li>
	<li><a href="#main">本題</a></li>
	<li><a href="#postscript">後書き或いは感想</a></li>
</ol>
<h2><a name="preface">前書き</a></h2>
　以前、FVWMのチューニングをしました。が、ハイスペックなマシンとTLXW8の操作性の良さのおかげで最近ずっとKDE2で満足していました。<br>
　ところが<b>愛しのPanasonic PRONOTE, CF-B5</b>にTLXW8を入れるにあたり、さすがにKDE2という訳にもいかなくなってしまいました。Pen3 700MHz, 192MB上で種々のデーモンを動かし、VMwareを実行しようと考えており、少しでもメモリがほしかった。しかもATOKXは起動に時間がかかるのでCannaを勉強し直そうと思っており、Xの再起動がしょっちゅうかかる以上、起動時間は少しでも短くしたい（←これに関しては kinput2 をkillして、
<pre>
kinput2 -canna &amp;
</pre>
　で再起動かけるだけで解決することが判明）。
　以上諸々の理由でKDE2を止めて、昔取った杵柄「FVWM」へ戻ることにしました。<br>
　ところが。以前チューニングした設定ファイルが<b>どこかへ行ってしまい</b>、しかも<a href="linux_fvwm01.html" target=_blank>それをまとめたHP</a>には肝心の設定（の勘所など）を一つも記述してない・・・！！<b>一体自分は何を考えていたのか・・・。</b>仕方ないので、復習もかねて一から作ろうとしたのですが・・・面倒くさい。<br>
　FVWMには「テーマ」という機能があって、ルック＆フィールをいろいろつぎはぎできるようになっています。その中に、最近好みのMac OS X 風のカスタマイズがありました。というわけで、アイコンやらメニューバーの背景やらそこから頂いて、その他設定も、とりあえずできる範囲でテーマから<b>つぎはぎ</b>したのを、FVWMの設定ファイル.fvwm2rcに落として使えるところ・使いところだけパクってしまおう。<br>
　というわけで<b>実に三週間にわたり</b>FVWMのテーマ、設定ファイルと格闘したあげく。どうしても実現できない機能があることが分かり、<b>ぶち切れて一部ソースコードを改造</b>してまで作り上げた、「えせ」Mac OS X 風 .fvwm2rcとアイコン群ができあがりました。んで、これら設定ファイルとアイコン群をまとめて「esox」と名付けました。<br>
　今回は「esox」作成に至るまでの非常におおざっぱな道のりとか、「esox」の導入方法だのを解説したいと思います。相手は何しろ古参のWM,FVWMですので長丁場になると思いますが・・・まあ、面倒くさくなったらとっとと導入部分に入ってしまうかもしれません。とりあえずFVWM試したい、という方はお暇な時間、拝借いたします。<br>
<font size=-1><a href="#contents">目次に戻る</a></font>
<br>
<h2><a name="main">本題</a></h2>
<ol>
	<li><a href="#main_01">非常に長い蘊蓄</a></li>
	<li><a href="#main_02">「esox」スクリーンショット</a></li>
	<li><a href="#main_03">FVWMの特徴（なぜFVWMか）とインストール方法</a></li>
	<li><a href="#main_04">テーマ（FvwmTheme）のインストールと利用方</a></li>
	<li><a href="#main_05">設定の勘所</a></li>
	<li><a href="#main_06">esoxの導入方法</a></li>
	<li><a href="#main_07">リンク</a></li>
</ol>
<p>
<font size=+1><b><a name="main_01">非常に長い蘊蓄</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<p>
　そもそもFVWMとは何か、から話さなくてはならない。FVWMとはLinux/UNIXの世界で言う「ウインドウマネージャ」と呼ばれる類のプログラムである。いや、「類」などではなくそのものだ。「ウインドウマネージャ」とは何かを話す前に、UNIX世界でのウインドウ、ひいてはグラフィック処理について知っている限りでざっと説明する。<br>
<p>
　そもそもUNIX世界にはグラフィック処理など存在しなかった。が、必要だった。というわけでとりあえず「線を引いたり、四角を書いたり、文字を描く」為に必要な最低限度の機能を持ったサーバープログラム「X」（エックス）が作られた。これがLinux/BSDで言うところの XFree86 である（以下、私自身がLinuxユーザーなのでLinux/BSD/UNIXを一くくりにLinuxと言ってしまう）。何でUNIXが入っていないかというと、Solaris等の商用UNIXでは"Free"ではないからだ。それらには、有償のXサーバーが同梱されていた。XFree86とはそれをフリーで実装し直したXサーバーと言ってまあ間違ってないんじゃない？<br>
　しかしこのプログラムは、グラフィックを扱うための最低限度の機能しかマジに提供していない。タイトルバーだの、メニューだのを描画したりマウスクリックを処理するのはあくまでも、プログラマーの役目だった。そしてウインドウという物を作り、複数のウインドウをマウスクリックで切り替える処理も。<br>
　というわけで、タイトルバーを作ったりメニューバーを描画したりするための専用プログラムが生まれた。複数のウインドウを操作するためのプログラム、すなわち「ウインドウマネージャ」である。これによりプログラマーは余計なことに気を遣わずに済み、ユーザーもマルチウインドウでハッピーになった。<br>
<p>
　これがここ１５年間の内、最初の１０年間程度の話。この間に「FVWM」「WindowMaker」「AfterStep」「twm」「qvwm」「mlvwm」「Enlightment」など数多のウインドウマネージャが生まれた。やがてウインドウを単に管理するだけではなく、画面に表示された「デスクトップ」との連携（ドラッグ＆ドロップ）をはじめとし、その他雑多なユーティリティをまとめて同梱した巨大な「デスクトップマネージャ」と呼ばれる二強が生まれた。言わずもがな、「KDE」と「GNOME」である。<br>
　後半５年間、Linux/BSD界における「ウインドマネージャ」の一般的な選択は先の二つ、「KDE」と「GNOME」のどちらをとるのかという選択に帰着していた。が、それは昔ながらのウインドウマネージャ達の終焉と同義では無かったのだ。<br>
<p>
　商用UNIXではソフトウェア的な制限が厳しく、「デスクトップマネージャ」をコンパイル・インストールするのが難しい場合が多々ある。そして「デスクトップマネージャ」は総合・統合環境を提供するだけあり、マシンリソースをかなり食う。そうそう見栄えが良いからとデスクトップマネージャを導入し、サーバーマシンに無理させることはできない。その点、「ウインドウマネージャ」は違う。Xの初期から存在していた老舗のWM群は出発点が「UNIX/Linux/BSD」というマルチプラットフォームであり、「あくまでもウインドウマネージャであり、デスクトップマネージャではない。」という姿勢をかたくなに維持していた。そのため動作自体はずっと軽快で、マシンにも負担をかけずに済む。結果、昔からのUNIX鯖などでしぶとく。しかし確実にWM達は生き残ってきた。<br>
　彼らは確かに現在のLinux界から見れば少数派である。ギガヘルツ＋数百MBのメモリが当然な昨今のPC環境において、個人があえてデスクトップマネージャではなく単なるウインドウマネージャを選択する必要は無い。<br>
　だが、しかし。それでもウインドウマネージャの出番となるシーンは存在する。ノートPCなど明らかにスペック不足なマシンでXを走らせるときだ。そんな時、日頃KDEやらGNOMEに慣れきったLinuxユーザーは初めて「ウインドウマネージャ」にさわり、困惑する。<br>
<p>
　元々ウインドウマネージャが生き延びてこれたのは熱狂的なマニアによる支援と、そして商用UNIX/BSDにおける独特のWMの見栄えに関する伝統が背景にある。Motif,CDEと呼ばれる一連のGUI、そしてWindowMakerが築き上げてきたルック＆フィール。しかしこれらは、「Windows系の操作性」を目指してきた「デスクトップマネージャ」とは異質な世界でもある。操作性、カスタマイズ性、カスタマイズ方法、その他全てが。<br>
　だが諦めないでほしい。彼らは決して近づかれることを拒絶しているわけではない。UNIX/BSD界で言えることだが、垣根は常に人間の方に存在する。我々は少し視点を変えるだけでその垣根を取り除き、新しいおもちゃを手に入れることができる。<br>
　昨今、ウインドウマネージャ、それも比較的古参に入る「FVWM」に挑戦しようとする、今これを読んでいる読者達の事だ。既にBSDのユーザーであったり、Emacs/vi系を手足の如く操作することを夢想し、果敢にも挑戦する探求者であると信じている。そうした連中にとってデスクトップマネージャは必ずしも絶対条件ではない。私も含めてデスクトップマネージャが無いからと言って困る事はない。事実私は困っていない。私やそうした連中にとって必要なユーティリティやソフトはこれぐらいだろう・・・vi, Emacs, XEmacs, MidnightCommander(mc), w3m, Mozilla, xosview, gimp, rxvt等の各種Xターミナル。<br>
　このうち、デスクトップマネージャでなければ動かせない、或いは連携できないソフトは一つとしてない。いずれも単体で動き、ひどく切れ味の鋭いツールばかりだ（故に最初は取っつきにくい）。「コンソールさえあればよい」という境地に至った人間はXターミナルとEmacs, vi さえあればいかなる窮地でも困ることは無いだろう。<br>
　故に私は確信する。そういった境地に挑もうとする探求者であるなら、必ず、ウインドウマネージャを手足の如く動かし全く不自由を感じない環境を構築できる、と。だが何事にも舵取り役は必要だ。他のWMは知らないが、FVWMに関しては日本語ドキュメントのほとんどが「FVWM 1.x」系列を扱っていて最新の「FVWM 2.5.x」系列を扱っているところが見受けられない。WMを勉強するとき参照するのは、大概は本家の英語ドキュメントであるしそれが最良かつ最短である。しかし結構特殊な単語が使われていたりして理解に時間を費やすことがままある。私は、FVWM 2.5.x 系列で提供されているテーマを独自にカスタマイズした「esox」と呼ばれる一連の設定ファイルとアイコン群をもって、それらの理解を少しでもサポートしたいと考えている。<br>
<p>
　「esox」は Mac OS X を参考にした「テーマ」から必要部分を切り出し、不必要な部分を削り、最終的にFVWMのソースコードの一部を勝手に改造することによって相当使い勝手と見栄えを（少なくとも私にとって）向上させたチューニングだ。<br>
　そして実は、結構異端なチューニングでもある。友人知人によく言われるのだが、私のセンスや衝動、欲求感覚は平均的なそれと大きくずれているらしい。後述するが、この「esox」は他の多くのウインドウマネージャ使いのチューニングとはかなり雰囲気がずれている。まあそれは実際の画面を見ていただくとして・・・さあ、そろそろ本題にはいるとしよう。<br>
<p>
<font size=+1><b><a name="main_02">「esox」スクリーンショット</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<p>
　とりあえず先にスクリーンショットをお見せし、読者のモチベーションを高めておきたい。FVWMは何も古いだけではない。<strong>悪魔的なカスタマイズ性</strong>を秘めている。その証拠の一片ともなれば幸いだ。<br>
<br>
　まずは起動画面をお見せする。中央に表示されているのは「FvwmBanner」といわれる機能で、指定秒数だけ画面中央に画像を表示する。画像自体は<a href="http://www.fvwm.org/logo-competition/" target=_blank>FVWMの公式ページで、ロゴマークのコンペが行われていた</a>のでそこから気に入ったのをとってきただけである。<br>
<a href="esox/screenshot01b.jpg" target=_blank><img src="esox/screenshot01.jpg"></a><br>
<br>
　これが通常画面と背景画像である。情けないことだが、背景画像の表示には<a href="http://Blackboxwm.sourceforge.net/" target=_blank>Blackbox</a>のbsetbgを使わせてもらった。背景画像は「テーマ」のMac OS X 風味から背景画像をキャプチャし、適当に加工した。<br>
<a href="esox/screenshot02b.jpg" target=_blank><img src="esox/screenshot02.jpg"></a><br>
<br>
　いわゆる「スタートメニュー」である。KDE2に合わせ、Alt+F1で表示されるように調整してある。興味深いことに、vi式カーソル移動(h:←, j:↓, k:↑, l:→)が利用できる。これによりマウスレスでもアプリケーションの起動やWMの制御に困ることは無い。アイコン群はKDEのアイコンから適当に引き抜いてきた。右サイドに三角マークがあるのは、サブメニューが展開される。ここらあたりはどのWMも、WindowsもKDEもGNOMEも一緒だろう。<br>
<img src="esox/screenshot03.jpg"><br>
<br>
　こちらはウインドウ操作メニュー群。ウインドウがアクティブなとき、Alt+Spaceを叩くと画面中央に表示されるようにしてある。このキーバインドはWindowsに準拠。Move, Resizeともにカーソルキーで扱えるので、ここでも基本的にマウスレスが可能。<br>
<img src="esox/screenshot04.jpg"><br>
<br>
　こちらはFVWMのモジュールを扱うためのサブメニュー。「TaskBar」というのが画面上部のバーのこと。「Animation」というのは「FvwmAnimation」モジュールで、これを利用すると相当クールなアイコン化(Iconify)、アイコンからの復帰(Deiconify)が簡単に利用できる。本来は他にも大量にモジュールがあるし、便利でもあるのだがなぜこれだけしかメニューにないかというと、Consoleがあるからである。これは「FvwmConsole」というモジュールで、ここからあらゆるFVWMコマンドやモジュールの呼び出しが行える。従ってFvwmConsoleさえあれば良い（←どうもこういったセンスが異端呼ばわれしている原因らしい）。つうか、実際問題このサブメニューが必要になるのは誤ってTaskBarを消してしまったとき位。<br>
<img src="esox/screenshot05.jpg"><br>
<br>
　これが通常利用時の画面上部、「TaskBar」。Windowsとさして変わりません。左のロゴマークをクリックすると、先ほどのスタートメニューが表示される。灰色で表示されているボタン（というかアイコン）はアイコン化されたウインドウ。アクティブなウインドウは黒い枠で囲まれる（この次のイメージを参照）。右側は時計。
<img src="esox/screenshot06.jpg"><br>
　「TaskBar」（FvwmTaskBarモジュール）は本来3Dボタンしか描画できない。どうしても「影」の部分や、「盛り上がって光が当たっている」部分を描画してしまう。そしてその描画位置は、どう頑張ってカラー設定を施しても3Dになってしまうような描画位置だった。というわけで、FvwmTaskBarモジュールのソースコードを改造して、<strong>無理矢理</strong>フラットなボタンを描画するように直したのがesoxのウリの一つ。<br>
<br>
　監視モードで通常使用モードな画面。Mozillaがタイトルバーだけになっています。実はこの「タイトルバーだけ」というのが最初は慣れないし、しかもタイトルバーをクリックしたときのデフォルトになっていたりするので嫌がるのですが。慣れてしまえば却ってかっこうよく見える始末。アニメーションもしてくれるので、気持ちよいです。Konquerorのデフォルトの銀白色のカラーと良くマッチしていませんか？XMMSの方も、Skinを調整してMacOSXのAquaに合わせました。<br>
<a href="esox/screenshot07b.jpg" target=_blank><img src="esox/screenshot07.jpg"></a><br>
<br>
　なお、esoxのスタートメニューに登録してあるプログラムですが「Emacs」「VMware」「Acrobat」を除いてTurboLinux workstation 8をフルインストールすれば入ってくるものばかりです。<br>
　「Emacs」はGnuからコンパイルしたPATH設定に合わせてあります。「Acrobat」のインストールはTLXW8のオンラインHTMLマニュアルに載っている通りです。「VMware」は3.2をrpmインストールしたPATHに合わせてあります。<br>
　いずれも、menus設定ファイルにまとめてありますので自由に書き換えることができます。<br>
<br>
<p>
<font size=+1><b><a name="main_03">FVWMの特徴（なぜFVWMか）とインストール方法</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<br>
　FVWMの特徴をお話しする前に、なんでFVWMかをば。<br>
　最初の最初・・・初めてWMにFVWMを使った理由は、「設定が一番簡単そう」だったから、です。よーするに、私は設定が依存しまくったシステムは嫌いなんです。偉そうなことイッテマスが結局<strong>私の頭のキャパを超えてしまう</strong>んです。AfterStepとか、Enlightmentとかそういった派手な設定が可能なタイプは。<br>
　あと魅力的だったのが、FVWMならではの「ページャ」「デスクトップ」移動。そこら辺は<a href="linux_fvwm01.html" target=_blank>前回のFVWMカスタマイズにて紹介してます</a>が、この機能はFVWMだけ（だったと思う）です。こういった機能が私の心のツボを突いてきました。<br>
　実際にこれがどういう機能かというと・・・設定によって、画面を四つ分使える用になります。それだけならKDEでも同じですが、画面と画面の中間点を移動できたりしちゃえます。こんな感じに。<br>
<table>
<tr><td><img src="esox/snapshot_lt.jpg"></td><td><img src="esox/snapshot_rt.jpg"></td></tr>
<tr><td><img src="esox/snapshot_ld.jpg"></td><td><img src="esox/snapshot_rd.jpg"></td></tr>
</table>
<br>
　非常にオリジナリティの高い機能なので、興味を持たれた方はぜひ試してみて下さい。<br>
<br>
　実は他にも<a href="http://blackboxwm.sourceforge.net/" target=_blank>Blackbox</a>も試してみたのです。が、FVWM程にはカスタマイズができそうにはなかったので止めました。背景画像を張り込むbsetbgだけをいただくことになりました。Blackboxはそれなりに使いやすいんですけどね・・・。<br>
<br>
　というわけで、「設定がシンプルだけど強力な拡張性」「ページ間の中途半端な移動」などなどの機能が付いてくるFVWMを使うわけです。他にFVWMの特徴をあげられるとすれば・・・<br>
<ul>
	<li>・「モジュール」(FvwmModule）によりWMに必要な「パーツ」を柔軟に組み合わせられる。</li>
	<li>・XPM形式だけでなく、コンパイル時に指定すればPNG画像も取り扱い可能（ただしどのモジュールでも、というわけには行かないみたい。素直にXPMを利用した方が無難）。</li>
	<li>・「テーマ」(FvwmTheme）によりWMを構成する要素毎のカスタマイズを、好きなものだけ取っ替え引っ替えできるようになる。</li>
	<li>・設定ファイル内で関数が定義でき、もはやある種のスクリプトと化している。</li>
</ul>
<br>
　こんなところです。たったこれだけです。しかし、これ故にです。<br>
　FVWMを悪魔的なモノにしているのが最初の「モジュール」と呼ばれるシロモノです。まあ・・・手っ取り早く、<a href="http://fvwm-themes.sourceforge.net/screenshots/" target=_blank>FVWMのテーマ</a>を見てもらうと分かるのではないか、と。<br>
　WM群にはある種の共通したパーツが存在します。それがタスクバー(TaskBar)であったり、アイコンを格納するアイコンボックス(IconMan, IconBox)であったり、正方形なボタンの内部にアイコンを表示したショートカットボタン(Button)です。FVWMの恐ろしいところはこれら全て（メニューを除く）<strong>外部モジュール化してしまった</strong>ところです。モジュールの実態は実行形式のファイルなのですが、これによって必要なパーツだけを組み合わせ、場合によっては「別のWMとそっくり」なカスタマイズまで施すことが可能です。<br>
　先に挙げた「FVWMのテーマ」を見て頂ければ分かると思いますが・・・<strong>「他のWMにそっくり」なテーマ</strong>がいくつかあるでしょ？あれですよ、あれ。<br>
<br>
　さらにすさまじいのは、FVWMでは「タスクバー上のボタンやその他FVWMが管理する画面領域」の<strong>イベントまでカスタマイズできてしまう</strong>点です。つまりタスクバーのボタン、及びそれがクリック・ダブルクリック・ドラッグされたときの挙動に至るまで全てカスタマイズできてしまう。<br>
<br>
　私の趣味で、ある種のプログラムを「悪魔的」と畏敬の念で呼びます。「悪魔」とは、使用する人間にとって手段と目的を取り違えさせる影響力を持っているという意味です。単体・コア部分は非常に軽い。機能を外部化している。しかも外部化において依存性がなるべく低くなるように設計されている。他のプログラムとの連携が用意。<br>
　故に。そのプログラムの使用法を「使うために勉強しているのか（目的：使うこと。手段：勉強）、勉強するための口実として使っているのか（目的：勉強すること。手段：使うこと）」分からなくなってくる。<br>
　これこそ「悪魔の囁き」。これらの条件を満たしているのはWindows上の一部のエディタ（残念なことに秀○はその中に入っていない）、そしてUNIXで古くから使われているツール群（vi, Emacsをはじめとする多くのコマンドラインツール）。そのWM版が、FVWMである。<br>
<br>
　話が横道にそれすぎましたので戻します。ではそういったすさまじいポテンシャルを秘めたFVWMをどうやってインストールするのか。ということで、まずはオフィシャルサイトからtarボールで落とします。<br>
　あ、それと・・・ここからの話は、TurboLinux workstation 8 を使っている環境下の話です。RedHatLinuxではひょっとしたらパッケージでインストールされてしまっているかもしれません。その場合は面倒くさいのであらかじめパッケージをアンインストールしちゃってください。<br>
<pre>
# whereis fvwm
/usr/bin/fvwm
# rpm -qf /usr/bin/fvwm
fvwm-2.4.6-05
# rpm -e fvwm-2.4.6-05
</pre>
　こんな感じで。もしX関連の依存性が報告されても、rpm -e --nodeps で強制消去して大丈夫だと思います。RHLの場合は（今はどうだか知りませんが）startxに続く一連のスクリプト内でフェールセーフの選択肢に必要とされているのかもしれません。ので、無視してください。<br>
<br>
　FVWMのバージョンは、esoxを使おうと思っているならfvwm-2.5.7を使ってください。というのはFvwmTaskBarモジュールのソースコードの一つをesoxでは書き換えて使っているからです。自分がプログラマーで、esoxに含まれているソースコードを読めば他のバージョンでも書き換えられる自信があれば別バージョンでも大丈夫でしょう。<br>
　良く分からない人はとにかく、fvwm-2.5.7を使ってください。<br>
<br>
<a href="http://www.fvwm.org/" target=_blank>FVWM公式ページ（英語）</a><br>
<br>
　ダウンロードしてきたら、いつもの如く<br>
<pre>
$ ./configure
$ make
$ su -c make install
</pre>
　して下さい。configureオプションはとりあえず何も指定しなくても、問題なく日本語表示とかできます。<br>
<br>
　この後はディストリビューションによって変わってくると思います。TLXW8では<a href="linux_x1102.html" target=_blank>startxの軌跡</a>を参照して頂くのも良いんですが、UpdateKit以降最新版のパッケージアップデートでは$HOME/.xinitrc内で指定できるようになりました。ので、そちらのstartkde辺りをコメントアウトしてしまって/usr/local/bin/fvwmとかにしても大丈夫だと思います。<br>
　実行すると最初何か聞かれてきますが、とりあえずYesかOk辺りにして進んじゃって下さい。おそらく、とてつもなく味気ない画面が広がると思います。<br>
　が、とにかく広がってしまえばこちらのモノです。とっとと終わりにして、FVWMの「テーマ」を使えるように「FVWM Themes」をインストールしてしまいましょう。<br>
<p>
<font size=+1><b><a name="main_04">テーマ（FvwmTheme）のインストールと利用方</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<p>
　「FVWM Themes」の公式HPは<a href="http://fvwm-themes.sourceforge.net/" target=_blank>こちら</a>です。ここの「Read FAQ」とか「Documentation」辺りを読んでインストールして下さい。<br>
　具体的なインストール方法は忘れました。ごめんなさい。<br>
<br>
　利用方法だけ説明します。「テーマ」とは、統一されたルック＆フィールを提供するためのいわば「設定ファイルとアイコン、画像集」の事です。FvwmThemeモジュールを利用することにより、システムにインストールされた「テーマ」を切り替える事ができます。<br>
　FvwmThemeを使って「テーマ」を利用した場合、メニューに「テーマ」を取捨選択するための「ThemeModules」みたいなメニュー項目が表れます。ここから、各「テーマ」で使われているFVWMのパーツに対するカスタマイズをつぎはぎできます。「テーマ」は一枚岩で作られているわけではなく、「ボタンの見栄え」「メニューのグラデーション」「タイトルバーの背景」などそれぞれ分離した形で統合されています。逆に言えば、「メニューのグラデーションはこのテーマからいただいて、タイトルバーのボタンや背景画像はこのテーマからいただいて」といった事が可能です。<br>
<br>
　しかし複雑なシステムは設定の美しさを（ある程度）損ないます。ぶっちゃけた話、メニューがうざい。使わないモジュールだの、テーマメニューが並ぶ。使いもしないツールが登録されている。しかもどこに設定があるのか分からず、修正が面倒くさい。そのままの状態では勉強にさえならない。<br>
　救いはあります。FVWM Themesには、現在使用しているテーマ（の組み合わせ）を通常のfvwmが読み込める「.fvwm2rc」設定ファイル形式に書き出す事のできるツールがあります。<br>
<br>
　というわけで、とりあえず自分の好きな要素をテーマから拾い集めて下さい。私の場合は基本的なルック＆フィールに「OSX」を。タスクバーのカスタマイズの参考にタスクバー部分を「Redmond98」から付け足しました。フォント回りは「Default」です。あとFvwmAutoRaiseやらその辺のウインドウの操作挙動は「Olicha」からいただいたような気が・・・。<br>
　最終的にはそれらを組み合わせるので、今は完全なモノを目指さなくても大丈夫です。とにかく、<strong>使えそうな「要素」だけを拾い集めます。</strong><br>
<br>
　で、拾い集め終わったら「.fvwm2rc」設定ファイルに書き出します。FVWM Themesに含まれている、「fvwm-themes-config」を利用します。<br>
<pre>
$ fvwm-themes-config --expand-rc $HOME/.fvwm/fvwm-themes-rc
</pre>
　といった具合です。以降、この設定ファイルをいろいろといじくって最終的な「.fvwm2rc」設定ファイルを仕上げていきます。<br>
<br>
　とにかく、「テーマは使うのではない、盗むのだ」という感じです。盗むというと語弊があるので、参考にするという具合でしょうか、ハイ。とにかくesoxの最初のひな形はこうして作られました。<br>
<p>
<font size=+1><b><a name="main_05">設定の勘所</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<p>
　何か面倒くさくなってきました。とりあえず作った設定ファイル群を、適当にコメントつけときましたのでそっち眺めてみて下さい。怠け者で本当に申し訳ない。文字コードはEUC-JPです。<br>
<ul>
	<li><a href="esox/fvwm2rc" target=_blank>中枢「.fvwm2rc」ファイル</a></li>
	<li><a href="esox/menus" target=_blank>メニューを収めた「menus」ファイル</a></li>
	<li><a href="esox/bindings" target=_blank>キーボード・マウスのイベントとアクションを定義した「bindings」ファイル</a></li>
</ul>
　以上がこれを書いている時点でのesox「設定」ファイルの全てです。これにFvwmTaskBarで使われている「ButtanArray.c」ソースファイルの改造版と、諸々のメニュー用アイコン、タイトルバー・タイトルバーボタンの画像ファイルがまとめられて「esox」のできあがりです。<br>
<p>
<font size=+1><b><a name="main_06">esoxの導入方法</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<p>
　というわけでいよいよです。が・・・実はesoxではデフォルト背景画像の貼り付けにBlackboxのbsetbgというツールを使っています。<a href="http://blackboxwm.sourceforge.net/" target=_blank>Blackboxの公式HP</a>から最新版でも何でも良いのでダウンロードしてきて、適当にコンパイルしてインストールしちゃって下さい。configureオプションはどうでも良いです。bsetbgが欲しいだけなので。make, make installで普通に /usr/local/bin にbsetbgができるはずです。<br>
　試しにfvwmを起動した状態で、rxvt辺りから「bsetbg 適当なXPM画像」をしてみて下さい。背景画像に読み込まれればオッケー。<br>
<br>
　esoxは<a href="esox/esox_v1.0.tar.gz">ここから入手できます。</a>ダウンロードしてきたら以下の手順で展開して下さい。念のため、以前の.fvwm2rcファイルはバックアップして置いてください。<br>
<pre>
$ cd ~
$ ls
... esox_v1.0.tar.gz ...
$ mv esox_v1.0.tar.gz ~/.fvwm/
$ cd ~/.fvwm/
$ tar zxvf esox_v1.0.tar.gz
...
...
...
$ la
... .fvwm2rc ... esox/ ... esox_v1.0.tar.gz ...
</pre>
　ここまでがesoxの設定ファイルと、各種アイコンの解凍・展開・配置です。<br>
　この後esox用に書き換えたソースコードで置換し、再コンパイルします。<br>
<pre>
$ cd esox/
$ ls
ButtonArray.c  bindings  images/  menus
$ cp ButtonArray.c ~/download/fvwm-2.5.7/modules/FvwmTaskBar/
</pre>
　「download」ディレクトリは要するにfvwm-2.5.7を解凍したディレクトリのことで、これは個人個人によって変わってきます。要は、fvwm-2.5.7のソースツリー中のmodules/FvwmTaskBarディレクトリへ esox のButtonArray.cを上書きコピーすれば良いわけです。<br>
　「上書きしても良いですか？」みたく聞かれてくるので「y」か「yes」で元のButtonArray.cをesoxのものに上書きします。んで、コンパイルし直します。既に一度makeしてあるので、Makefileやら*.oファイルが存在するはず。<br>
<pre>
$ ls
... ButtonArray.o ... Makefile ... FvwmTaskBar* ...
$ make clean
(rm して消してます・・・)
$ make
...
(コンパイル中)
...
$ ls
... FvwmTaskBar* ...
</pre>
　コンパイル時にエラーが出てしまった人は、エラーの内容とfvwmのバージョンを<a href="mailto:fenjin@nifty.com">風晶までメールで知らせて下さい。</a>無保障ですが、なんとか考えてみます。<br>
　fvwm-2.5.7で、本体のコンパイルが正常に終わっていれば、リコンパイルもエラー無しで通るはずです。そんなにクリティカルな部分を改造したわけではありません。<br>
<br>
　コンパイルすると、FvwmTaskBarというそのまんまの名前の実行ファイルができあがります。これが「モジュール」の本体です。要するに、モジュールを画面に描画したりする一種のミニプログラムという訳です。んでこいつを/usr/local/...へコピーします。<br>
<pre>
$ su -c "cp FvwmTaskBar /usr/local/libexec/fvwm/2.5.7/"
</pre>
　「/usr/local」部分はインストール先によって変わります。まあ・・・大概は/usr/local/だと思いますし。とにかく、インストール先のFvwmのモジュールが置かれているディレクトリへコピーし、以前のFvwmTaskBarを新しい方に上書き置換します。<br>
　以上まででエラーがなければ・・・まあ、たぶん大丈夫だと思います。<br>
　あとはfvwm-themesではなく、只のfvwmが起動するように個々人のホームディレクトリの.xinitrc辺りを元に戻し、startxします。<br>
<br>
　最後にesoxの使い方を簡単にまとめます。<br>
<ul>
<li>スタートメニューはタスクバー左のFVWMのロゴを左クリックするか、Alt+F1。</li>
<li>ウインドウを切り替えるには Alt+TABでウインドウリストを表示した後、同じくAlt+TABを押して切り替え先のウインドウを選択します。</li>
<li>ウインドウ操作メニューを表示するには、Alt+Spaceです。他にもタイトルバーを右クリックするか、タイトルバー右の灰色のボタンをクリックしても表示できます。</li>
<li>ウインドウの最小化はタイトルバーの黄色いボタンを左クリックします。最小化された状態から元に戻すには、タスクバー上の灰色になっているボタンを左クリックします。</li>
<li>タイトルバーの緑色のボタンは最大化系の機能です。左、中央、右クリックで最大化を切り替えられます。水平方向、垂直方向などが割り当てられています。</li>
<li>デスクトップの移動はAlt, Shift+Alt, Ctrl, Shift+Ctrlとカーソルキーの組み合わせです。移動量が、順に大きくなります。Altだけだと1ピクセル。Shift+Ctrlが最大で丸ごと一画面移動します。またループしていますので、ウインドウを見失うことは無いはずです。</li>
</ul>
<p>
<font size=+1><b><a name="main_07">リンク</a></b></font><br>
<font size=-1><a href="#main">「本題」に戻る</a></font><br>
<p>
　リンクです。つっても、今回はマジでFVWM公式HPとBlackbox公式HPしかありません。<br>
<ul>
	<li><a href="http://www.fvwm.org" target=_blank>FVWM公式HP</a></li>
	<li><a href="http://fvwm-themes.sourceforge.net/" target=_blank>FVWM Themes公式HP</a></li>
	<li><a href="http://blackboxwm.sourceforge.net/" target=_blank>Blackbox公式HP</a></li>
</ul>
<p>
<font size=-1><a href="#contents">目次に戻る</a></font>
<p>
<h2><a name="postscript">後書き或いは感想</a></h2>
　ああ～～、駆け足でごめんなさい。<br>
　皐月、水無月と更新がさっぱり止まってしまっていたのは、卯月後半から皐月一杯をEmacsLispの勉強で費やし、水無月はこのFVWMとの格闘で費やしていたからです。<br>
　とにかく、esoxに触れて頂いてfvwmの何とも自由で変ちくりんな世界を楽しんで頂ければ幸いです。<br>
<p>
　最後に、esoxを作った時のカスタマイズに関する基本方針をつらつら書いていきたいと思います。<br>
<p>
　まず、余計なモジュールは起動しない。メニューからも削除する。というのはFvwmButtonは確かに便利なんですが、設定が面倒くさい。しかもFvwmTaskBarを使ってMacOSX風の外見にしたのをある意味「ぶちこわし」にしてくれるモジュールなんですよ、これ。他にもFvwmIconManとかIconBoxも削除。これ、アイコンが大きいので「ダサイ」んです。みていられない。そもそも、大体をrxvtとかのターミナルで過ごすような場合、デスクトップにアイコンが置いて無くてもなんら困らないわけです。私がKDEでデスクトップアイコンを使う用途は、せいぜいUSBのMOのマウント位です。<br>
　とにかくMacOSX風にしたんです。思い切って不要なモジュールは隠してしまいました。画面を移動したり、デスクトップやページを切り替えるFvwmPagerも止めてしまいました。元々私は複数デスクトップを使うタイプではないんです。Windowsに慣れていたので、シングルデスクトップでも十分でした。ので、要らないのでFvwmPagerも削除、デスクトップも一枚の中に2x2で区切り、CtrlとAltとShiftの組み合わせで移動できるだけにしてしまいました。<br>
　あと、ウインドウ操作メニューも一つにまとめてしまいました。OSXテーマだと、二、三種類の操作メニューがあってタイトルバーやタイトルバー右のボタンをクリックした場合に応じていろいろ表示するのですが・・・はっきり言って、邪魔。「どこをどのボタンでクリックすればいいのか覚える必要がある」何て、邪魔も良いところです。面倒くさい。それほどヘビーに使う予定もないのですから、不必要なグループ単位での移動だの、Iconifyだのは要りません。<br>
　rxvtやxtermを通したヘルプメニューもテーマをインストールすると付いてきましたが・・・んなもん、Web上に存在するしrxvt一つか二つ開いておけばそれで済みます。ので、やっぱ削除。<br>
<p>
　とにかく、ある機能を実行するための「入り口」をなるべく減らしておきたかった訳です。ターミナル上で動くソフトはメニューにはなるべく登録しない。<br>
　入り口がいっぱいあると、いちいち覚えておかなくてはならないからです。入り口は一つか二つ、そこからツリーを辿っていけば実行できる。その程度で十分です。<br>
　実際にFVWM Themesで紹介されているスクリーンショットと、私のesoxスクリーンショットとの間には溝が存在します。まず私はFvwmButtonを全く使っていません。次にXeyesも無視、XClock系列も無視、FvwmPagerも無視、IconBox, IconManも無視。<br>
　<strong>UNIX界で長く使われてきたWMのインターフェイスやXユーティリティを徹頭徹尾無視してきています。</strong>つまり、esoxのカスタマイズはWindows寄りなのです。元々Windowsユーザーの私にとって、太いウインドウ境界線だのダサイ白黒な時計だのショートカットだか何だか良く分からず、アイコンのデザインもいまいちなFvwmButtonsを使ったWindowMakerのWharfもどきなどは耐えられない。MacOSX風の美しいTaskBar,メニューを壊さないで欲しい。結局、そういうことです。あと・・・配色もぱっとしないのが多いんですよね。<br>
　WindowsやMacの配色は明るくてぱりっとしたのが多いし、私も好きです。ところがUNIX界のWMでは、大体のデフォルトは地味すぎるほど地味だったり、褪せた感じのする配色だったり、メタルでヘビーでブラックな感じが多かったりして。重苦しい。見づらい。カラーリングに民族レベルの差異を感じ取ってしまうのです。<br>
　私は淡い色合いが好きな方なので、どうもWMのテーマは・・・格好良い、とは思うんですが・・・自身としてはやりたくないかな。という感じです。<br>
　その点、MacOSXのGUIは大好きですね。でこぼこ感を抑えて、コントラストを抑えてフラットな感じのあれは野暮ったくも無し、どぎつくも無し。とにかく派手な見た目はなるべく抑えて、シンプルだけどそれ故に他とはずれまくった設定で、基本を踏襲していれば何も困ることがなく、満たされた感じを覚える環境・・・<strong>って、Cetaと同じ境地を目指してるだけかい！？</strong><br>
<p>
　やっぱり、私のセンスはずれにずれまくっているみたいです。あ～あ。<br>
<p>
　というところで、そろそろお仕舞いです。断言します。esoxのカスタマイズは、文句なく「異端」なカスタマイズです。しかしWindowsやMac系のユーザにとっては、比較的違和感なく入っていけるかもしれません。とにかく、これを参考に非力PCでもばりばりFVWMを使って快適な作業環境を構築して頂ければ作者（というかカスタマイズ）冥利に尽きます。それでは今回はこの辺で。<br>
<p>
<font size=-1><a href="#contents">目次に戻る</a></font><br>
<br>
<a href="../../index.html">トップページ</a>＞＞＞<a href="../index.html#computer">「いろいろ」目次</a>
</body>
</html>
